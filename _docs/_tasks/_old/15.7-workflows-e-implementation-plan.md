# Task 15.7: Workflows E - Detailed Implementation Plan

**Status:** Planning  
**Date:** December 2025  
**Variation:** E (Fifth implementation variation)  
**Based On:** Flight C Variation B mockup + 15.6 understanding document

---

## Executive Summary

This document provides a **phase-by-phase implementation plan** for Variation E, with:
- **File impact analysis** for each phase
- **Acceptance criteria mapping** (which files satisfy which criteria)
- **Testing strategy** for each phase
- **File-by-file breakdown** showing how each file relates to acceptance criteria

**Total Phases:** 12  
**Total Files to Create:** ~60+  
**Total Acceptance Criteria:** 81 (across all phases)

---

## Phase 1: Foundation & Navigation

### Goal
Establish folder structure, types, API routes, and navigation entry point. Users can navigate to `/workflows-e` and see a list page.

### File Impact Analysis

| File | Action | Purpose | Relates To AC |
|------|--------|---------|--------------|
| `_tables/workflows-e/.gitkeep` | Create | Ensure folder exists | AC-13.1 (storage) |
| `app/api/workflows-e/services/types.ts` | Create | Type definitions (reuse from workflows/services/types.ts) | All (foundation) |
| `app/api/workflows-e/services/storage.ts` | Create | File I/O for workflow.json and workflow.ts | AC-13.1, AC-13.2 |
| `app/api/workflows-e/create/route.ts` | Create | POST - create new workflow | P1.3 (test flow) |
| `app/api/workflows-e/list/route.ts` | Create | GET - list all workflows | P1.2 (list page) |
| `app/api/workflows-e/[workflowId]/route.ts` | Create | GET/PATCH/DELETE single workflow | AC-13.1 (save/load) |
| `app/(pages)/workflows-e/page.tsx` | Create | List page (grid of workflow cards) | AC-12.4 (view) |
| `components/layout/TopNav.tsx` | Modify | Add "Workflows E" nav item | P1.1 (navigation) |

### Acceptance Criteria Mapping

| AC | Criterion | Files That Satisfy | Test Method |
|----|-----------|-------------------|-------------|
| **P1.1** | "Workflows E" link visible in top nav | `TopNav.tsx` | Visual check in browser |
| **P1.2** | Navigate to /workflows-e shows list page | `workflows-e/page.tsx` | Click nav link ‚Üí page loads |
| **P1.3** | "New Workflow" button creates workflow | `create/route.ts` + `storage.ts` | Click ‚Üí API creates folder |
| **P1.4** | Workflow folders created in `_tables/workflows-e/` | `storage.ts` | Check filesystem after create |
| **AC-13.1** | Workflow saved to `_tables/workflows-e/[id]/workflow.json` | `storage.ts` + `[workflowId]/route.ts` | Save ‚Üí file exists |
| **AC-13.2** | Generated code saved to `workflow.ts` | `storage.ts` (Phase 9 will add generator) | Save ‚Üí file exists (Phase 9) |

### File-by-File Breakdown

#### `app/api/workflows-e/services/types.ts`
**Purpose:** Type definitions for workflow data structures  
**Content:** Re-export or copy from `app/api/workflows/services/types.ts`:
- `WorkflowDefinition`
- `WorkflowStep`
- `DataMapping`
- `RuntimeInputConfig`
- `WorkflowConfig`
- `TableRequirement`
- Factory: `createEmptyWorkflow()`

**Relates To:** All acceptance criteria (foundation types)

#### `app/api/workflows-e/services/storage.ts`
**Purpose:** File I/O operations for workflow persistence  
**Functions:**
- `createWorkflow(name?)` ‚Üí Creates folder, writes `workflow.json`
- `getWorkflow(workflowId)` ‚Üí Reads `workflow.json`
- `updateWorkflow(workflowId, updates)` ‚Üí Updates `workflow.json`
- `deleteWorkflow(workflowId)` ‚Üí Deletes folder
- `listWorkflows()` ‚Üí Scans folders, returns summaries
- `saveGeneratedCode(workflowId, code)` ‚Üí Writes `workflow.ts` (Phase 9)

**Relates To:** AC-13.1, AC-13.2, P1.3, P1.4

**Storage Pattern:**
```
_tables/workflows-e/
  wf-abc123-def456/
    workflow.json    # Editor state
    workflow.ts      # Generated code (Phase 9)
```

#### `app/api/workflows-e/create/route.ts`
**Purpose:** API endpoint to create new workflow  
**Method:** POST  
**Request Body:** `{ name?: string }`  
**Response:** `WorkflowDefinition`  
**Implementation:**
```typescript
import { createWorkflow } from "../services/storage";
import { NextResponse } from "next/server";

export async function POST(request: Request) {
  const { name } = await request.json();
  const workflow = await createWorkflow(name);
  return NextResponse.json(workflow);
}
```

**Relates To:** P1.3 (creates workflow on button click)

#### `app/api/workflows-e/list/route.ts`
**Purpose:** API endpoint to list all workflows  
**Method:** GET  
**Response:** `WorkflowSummary[]`  
**Implementation:**
```typescript
import { listWorkflows } from "../services/storage";
import { NextResponse } from "next/server";

export async function GET() {
  const workflows = await listWorkflows();
  return NextResponse.json(workflows);
}
```

**Relates To:** P1.2 (list page fetches from this endpoint)

#### `app/api/workflows-e/[workflowId]/route.ts`
**Purpose:** API endpoint for single workflow CRUD  
**Methods:** GET, PATCH, DELETE  
**GET:** Returns `WorkflowDefinition`  
**PATCH:** Updates workflow, saves `workflow.json`  
**DELETE:** Deletes workflow folder  

**Relates To:** AC-13.1 (save/load workflow state)

#### `app/(pages)/workflows-e/page.tsx`
**Purpose:** List page showing all workflows  
**Features:**
- Grid of workflow cards
- "New Workflow" button
- Empty state when no workflows
- Card shows: name, description, step count, last modified
- Click card ‚Üí navigate to editor

**Relates To:** P1.2, P1.3, AC-12.4

**Component Structure:**
```typescript
export default function WorkflowsEPage() {
  const [workflows, setWorkflows] = useState<WorkflowSummary[]>([]);
  
  useEffect(() => {
    fetchWorkflows();
  }, []);
  
  async function handleCreateWorkflow() {
    const response = await fetch("/api/workflows-e/create", { method: "POST" });
    const workflow = await response.json();
    router.push(`/workflows-e/editor?id=${workflow.id}`);
  }
  
  return (
    <div>
      <h1>Workflows E</h1>
      <Button onClick={handleCreateWorkflow}>New Workflow</Button>
      <WorkflowGrid workflows={workflows} />
    </div>
  );
}
```

#### `components/layout/TopNav.tsx`
**Modification:** Add "Workflows E" to `NAV_ITEMS` array  
**Change:**
```typescript
const NAV_ITEMS = [
  // ... existing items
  { href: "/workflows-e", label: "Workflows E", icon: GitBranch },
];
```

**Relates To:** P1.1 (navigation entry point)

### Testing Strategy

**Manual Test Flow:**
```
1. Start dev server: npm run dev
2. Navigate to /home
3. Verify "Workflows E" appears in top nav (P1.1)
4. Click "Workflows E" ‚Üí loads /workflows-e (P1.2)
5. Verify list page shows (empty state or existing workflows)
6. Click "New Workflow" button (P1.3)
7. Verify API creates folder in _tables/workflows-e/ (P1.4)
8. Verify redirects to /workflows-e/editor?id=[newId]
```

**Automated Tests (Future):**
- Unit test: `storage.ts` functions (create, get, update, delete, list)
- Integration test: API routes return correct data
- E2E test: Create workflow from UI ‚Üí verify folder exists

**Acceptance Criteria Checklist:**
- [ ] P1.1: Nav link visible
- [ ] P1.2: List page loads
- [ ] P1.3: Create workflow works
- [ ] P1.4: Folder created in storage

---

## Phase 2: Editor Shell & Store

### Goal
Create the editor page with 3-panel layout (AI chat left, workflow center, settings right) and Zustand store foundation. Editor loads and displays basic structure.

### File Impact Analysis

| File | Action | Purpose | Relates To AC |
|------|--------|---------|--------------|
| `app/(pages)/workflows-e/editor/page.tsx` | Create | Main editor page (3-panel layout) | P2.1, P2.2 |
| `app/(pages)/workflows-e/editor/store/index.ts` | Create | Zustand store composition | P2.4 (store init) |
| `app/(pages)/workflows-e/editor/store/types.ts` | Create | Store state types | All (foundation) |
| `app/(pages)/workflows-e/editor/store/slices/workflowSlice.ts` | Create | Workflow identity state | P2.3 (workflow name) |
| `app/(pages)/workflows-e/editor/store/slices/stepsSlice.ts` | Create | Steps state management | P2.4 (empty steps) |
| `app/(pages)/workflows-e/editor/store/slices/mappingsSlice.ts` | Create | Data mappings state | Foundation |
| `app/(pages)/workflows-e/editor/store/slices/inputsSlice.ts` | Create | Runtime inputs state | Foundation |
| `app/(pages)/workflows-e/editor/store/slices/configsSlice.ts` | Create | Workflow configs state | Foundation |
| `app/(pages)/workflows-e/editor/store/slices/connectionsSlice.ts` | Create | Required connections state | Foundation |
| `app/(pages)/workflows-e/editor/store/slices/tablesSlice.ts` | Create | Table requirements state | Foundation |
| `app/(pages)/workflows-e/editor/store/slices/uiSlice.ts` | Create | UI state (view mode, abstraction level, AI panel) | P2.2 (layout) |
| `app/(pages)/workflows-e/editor/store/slices/testingSlice.ts` | Create | Test execution state | Foundation |
| `app/(pages)/workflows-e/editor/components/EditorHeader.tsx` | Create | Top bar with name, toggles, buttons | P2.3 (workflow name) |
| `app/(pages)/workflows-e/editor/components/EditorSidebar.tsx` | Create | Left panel (AI chat, collapsible) | P2.2 (3-panel layout) |
| `app/(pages)/workflows-e/editor/components/EditorMain.tsx` | Create | Center area (placeholder for now) | P2.2 (3-panel layout) |
| `app/(pages)/workflows-e/editor/components/EditorInspector.tsx` | Create | Right panel (tabbed settings, placeholder) | P2.2 (3-panel layout) |
| `app/(pages)/workflows-e/editor/hooks/useWorkflowLoader.ts` | Create | Hook to load workflow from API | P2.1 (editor loads) |

### Acceptance Criteria Mapping

| AC | Criterion | Files That Satisfy | Test Method |
|----|-----------|-------------------|-------------|
| **P2.1** | Editor page loads at /workflows-e/editor | `editor/page.tsx` + `useWorkflowLoader.ts` | Navigate with ?id= ‚Üí page loads |
| **P2.2** | 3-panel layout renders | `EditorSidebar.tsx`, `EditorMain.tsx`, `EditorInspector.tsx` | Visual check: left, center, right visible |
| **P2.3** | Header shows workflow name | `EditorHeader.tsx` + `workflowSlice.ts` | Editable title input visible |
| **P2.4** | Store initializes with empty steps | `store/index.ts` + `stepsSlice.ts` | Check store state in DevTools |

### File-by-File Breakdown

#### `app/(pages)/workflows-e/editor/page.tsx`
**Purpose:** Main editor page component  
**Layout:**
```typescript
<div className="h-screen flex flex-col bg-[#0a0a14]">
  <EditorHeader />
  <div className="flex-1 flex overflow-hidden">
    <EditorSidebar />
    <EditorMain />
    <EditorInspector />
  </div>
</div>
```

**Features:**
- Uses `useWorkflowLoader` to fetch workflow
- Composes store slices via `useWorkflowEditorStore`
- Handles loading/error states
- Suspense boundary for async loading

**Relates To:** P2.1, P2.2

#### `app/(pages)/workflows-e/editor/store/index.ts`
**Purpose:** Zustand store composition  
**Pattern:** Same as existing `workflows/editor/store/index.ts`  
**Composition:**
```typescript
export const useWorkflowEditorStore = create<WorkflowEditorStore>()(
  (...args) => ({
    ...createWorkflowSlice(...args),
    ...createStepsSlice(...args),
    ...createMappingsSlice(...args),
    ...createUISlice(...args),
    ...createInputsSlice(...args),
    ...createConfigsSlice(...args),
    ...createConnectionsSlice(...args),
    ...createTablesSlice(...args),
    ...createTestingSlice(...args),
  })
);
```

**Relates To:** P2.4 (store initialization)

#### `app/(pages)/workflows-e/editor/store/types.ts`
**Purpose:** Store state type definitions  
**Content:** Similar to `workflows/editor/store/types.ts`:
- `WorkflowSlice` interface
- `StepsSlice` interface
- `MappingsSlice` interface
- `UISlice` interface (add: `abstractionLevel: "flow" | "spec" | "code"`, `aiPanelExpanded: boolean`)
- `InputsSlice` interface
- `ConfigsSlice` interface
- `ConnectionsSlice` interface
- `TablesSlice` interface
- `TestingSlice` interface
- `WorkflowEditorStore` (combined type)

**Relates To:** All (type safety foundation)

#### `app/(pages)/workflows-e/editor/store/slices/workflowSlice.ts`
**Purpose:** Workflow identity and metadata state  
**State:**
- `workflow: WorkflowDefinition | null`
- `workflowId: string | null`
- `isDirty: boolean`
- `isLoading: boolean`
- `error: string | null`

**Actions:**
- `loadWorkflow(workflow)`
- `updateWorkflowMetadata({ name, description })`
- `markDirty()` / `markClean()`

**Relates To:** P2.3 (workflow name in header)

#### `app/(pages)/workflows-e/editor/store/slices/stepsSlice.ts`
**Purpose:** Steps state management  
**State:**
- `steps: WorkflowStep[]`

**Actions:**
- `setSteps(steps)`
- `addStep(step)`
- `updateStep(id, updates)`
- `removeStep(id)`
- `reorderSteps(fromIndex, toIndex)`
- `getStepById(id)`

**Relates To:** P2.4 (initializes with empty array)

**Pattern:** Copy from `workflows/editor/store/slices/stepsSlice.ts` and adapt

#### `app/(pages)/workflows-e/editor/store/slices/mappingsSlice.ts`
**Purpose:** Data mappings state  
**State:**
- `mappings: DataMapping[]`

**Actions:**
- `setMappings(mappings)`
- `addMapping(mapping)`
- `updateMapping(id, updates)`
- `removeMapping(id)`
- `getMappingsForStep(stepId)`

**Relates To:** Foundation for Phase 5 (data mapping)

#### `app/(pages)/workflows-e/editor/store/slices/uiSlice.ts`
**Purpose:** UI state (view mode, abstraction level, panel states)  
**State:**
- `selectedStepId: string | null`
- `viewMode: "list" | "canvas"`
- `abstractionLevel: "flow" | "spec" | "code"` ‚Üê **Variation E unique**
- `aiPanelExpanded: boolean` ‚Üê **Variation E unique**
- `activeSettingsTab: "tools" | "inputs" | "config" | "connect" | "test"` ‚Üê **Variation E unique**

**Actions:**
- `setSelectedStep(id)`
- `setViewMode(mode)`
- `setAbstractionLevel(level)` ‚Üê **Variation E unique**
- `toggleAIPanel()` ‚Üê **Variation E unique**
- `setActiveSettingsTab(tab)` ‚Üê **Variation E unique**

**Relates To:** P2.2 (layout state), Phase 11 (abstraction levels)

#### `app/(pages)/workflows-e/editor/components/EditorHeader.tsx`
**Purpose:** Top bar with workflow name, toggles, action buttons  
**Features:**
- Editable workflow name input
- Abstraction level toggle: Flow / Spec / Code (Phase 11)
- View toggle: List / Canvas (Phase 10)
- Test button (Phase 8)
- Save button (Phase 9)
- Publish button (future)

**Layout (from Flight C mockup):**
```typescript
<header className="h-14 bg-[#12121f] border-b border-[#1a1a2e] flex items-center justify-between px-4">
  <div className="flex items-center gap-3">
    <BackButton />
    <WorkflowNameInput />
    <SaveStatusBadge />
  </div>
  <div className="flex items-center gap-3">
    <AbstractionLevelToggle /> {/* Flow/Spec/Code */}
    <ViewToggle /> {/* List/Canvas */}
    <TestButton />
    <SaveButton />
    <PublishButton />
  </div>
</header>
```

**Relates To:** P2.3 (workflow name display/editing)

#### `app/(pages)/workflows-e/editor/components/EditorSidebar.tsx`
**Purpose:** Left panel - AI chat (collapsible)  
**Features:**
- Collapsible panel (320px ‚Üî 64px)
- Chat header with collapse button
- Chat messages area
- Chat input
- Collapsed state: Icon button only

**Layout (from Flight C mockup):**
```typescript
<aside className={`w-80 bg-[#0f0f1a] border-r border-[#1a1a2e] transition-all duration-300 ${expanded ? '' : 'hidden'}`}>
  <div className="p-4 border-b">
    <ChatHeader />
    <CollapseButton />
  </div>
  <div className="flex-1 overflow-y-auto">
    <ChatMessages />
  </div>
  <div className="p-4 border-t">
    <ChatInput />
  </div>
</aside>
```

**Relates To:** P2.2 (left panel in 3-panel layout)

#### `app/(pages)/workflows-e/editor/components/EditorMain.tsx`
**Purpose:** Center area - workflow editor (list or canvas)  
**Phase 2:** Placeholder showing "Workflow area"  
**Phase 3:** Will render `StepTimeline` (list view)  
**Phase 10:** Will render `WorkflowCanvas` (canvas view)

**Relates To:** P2.2 (center panel in 3-panel layout)

#### `app/(pages)/workflows-e/editor/components/EditorInspector.tsx`
**Purpose:** Right panel - tabbed settings  
**Features:**
- Tab bar: Tools, Inputs, Config, Connect, Test
- Tab content area (renders active tab component)
- Each tab is separate component (created in later phases)

**Layout (from Flight C mockup):**
```typescript
<aside className="w-80 bg-[#0f0f1a] border-l border-[#1a1a2e]">
  <div className="flex border-b">
    <TabButton tab="tools" />
    <TabButton tab="inputs" />
    <TabButton tab="config" />
    <TabButton tab="connect" />
    <TabButton tab="test" />
  </div>
  <div className="flex-1 overflow-y-auto">
    {activeTab === "tools" && <ToolPalette />}
    {activeTab === "inputs" && <InputsPanel />}
    {activeTab === "config" && <ConfigPanel />}
    {activeTab === "connect" && <ConnectionsPanel />}
    {activeTab === "test" && <TestPanel />}
  </div>
</aside>
```

**Relates To:** P2.2 (right panel in 3-panel layout)

#### `app/(pages)/workflows-e/editor/hooks/useWorkflowLoader.ts`
**Purpose:** Hook to load workflow from API  
**Implementation:**
```typescript
export function useWorkflowLoader(workflowId: string | null) {
  const { loadWorkflow, setLoading, setError } = useWorkflowEditorStore();
  const [isLoading, setIsLoading] = useState(true);
  const [error, setLocalError] = useState<string | null>(null);
  
  useEffect(() => {
    if (!workflowId) {
      setIsLoading(false);
      return;
    }
    
    async function load() {
      try {
        const response = await fetch(`/api/workflows-e/${workflowId}`);
        if (!response.ok) throw new Error("Failed to load");
        const workflow = await response.json();
        loadWorkflow(workflow);
      } catch (err) {
        setLocalError(err.message);
      } finally {
        setIsLoading(false);
      }
    }
    
    load();
  }, [workflowId, loadWorkflow]);
  
  return { isLoading, error };
}
```

**Relates To:** P2.1 (loads workflow on mount)

### Testing Strategy

**Manual Test Flow:**
```
1. Navigate to /workflows-e/editor?id=[existingId]
2. Verify editor page loads (P2.1)
3. Verify 3-panel layout visible: left (AI chat), center (workflow area), right (settings) (P2.2)
4. Verify header shows workflow name (editable) (P2.3)
5. Open DevTools ‚Üí check Zustand store state
6. Verify steps array is empty [] (P2.4)
7. Verify all slices initialized correctly
```

**Component Tests (Future):**
- Unit test: Store slices (actions update state correctly)
- Unit test: `useWorkflowLoader` hook (fetches and loads workflow)
- Visual test: 3-panel layout renders correctly

**Acceptance Criteria Checklist:**
- [ ] P2.1: Editor page loads
- [ ] P2.2: 3-panel layout renders
- [ ] P2.3: Header shows workflow name
- [ ] P2.4: Store initializes with empty steps

---

## Phase 3: List View Implementation

### Goal
Implement the primary list/timeline view. Users can see steps in a vertical timeline, expand/collapse step details, and reorder steps.

### File Impact Analysis

| File | Action | Purpose | Relates To AC |
|------|--------|---------|--------------|
| `app/(pages)/workflows-e/editor/components/list/StepTimeline.tsx` | Create | Timeline container component | AC-12.2 (list view) |
| `app/(pages)/workflows-e/editor/components/list/StepCard.tsx` | Create | Collapsed step card | AC-2.1, AC-2.2 (I/O display) |
| `app/(pages)/workflows-e/editor/components/list/StepCardExpanded.tsx` | Create | Expanded step details | AC-2.6 (full I/O details) |
| `app/(pages)/workflows-e/editor/components/list/DataFlowIndicator.tsx` | Create | Arrow/connector between steps | AC-2.3 (visual connection) |
| `app/(pages)/workflows-e/editor/components/list/AddStepButton.tsx` | Create | "Add Step" placeholder button | Foundation |
| `app/(pages)/workflows-e/editor/components/EditorMain.tsx` | Modify | Render StepTimeline instead of placeholder | AC-12.2 |

### Acceptance Criteria Mapping

| AC | Criterion | Files That Satisfy | Test Method |
|----|-----------|-------------------|-------------|
| **AC-12.2** | List view displays workflow as sequential steps | `StepTimeline.tsx` + `EditorMain.tsx` | Visual check: steps in vertical list |
| **AC-2.1** | Each node displays input schema | `StepCard.tsx` | Visual check: input fields shown |
| **AC-2.2** | Each node displays output schema | `StepCard.tsx` | Visual check: output fields shown |
| **AC-2.3** | Nodes connect via edges | `DataFlowIndicator.tsx` | Visual check: arrows between steps |
| **AC-2.6** | Node inspector shows full I/O details | `StepCardExpanded.tsx` | Click step ‚Üí see full details |
| **P3.1** | Empty state shows "Add a Step" prompt | `StepTimeline.tsx` (empty state) | Visual check when no steps |
| **P3.2** | Steps render as timeline cards | `StepCard.tsx` | Add mock step ‚Üí card appears |
| **P3.3** | Click step expands it | `StepCard.tsx` + `uiSlice.ts` | Click ‚Üí expands, shows details |
| **P3.4** | Data flow indicator between steps | `DataFlowIndicator.tsx` | Visual check: arrow visible |
| **P3.5** | Steps can be reordered | `StepTimeline.tsx` (drag-drop) + `stepsSlice.ts` | Drag step ‚Üí reorders |

### File-by-File Breakdown

#### `app/(pages)/workflows-e/editor/components/list/StepTimeline.tsx`
**Purpose:** Timeline container that renders all steps in order  
**Features:**
- Sorts steps by `listIndex`
- Renders `StepCard` for each step
- Renders `DataFlowIndicator` between steps
- Renders `AddStepButton` at end
- Empty state when no steps
- Drag-drop reordering (using `@dnd-kit` or similar)

**Implementation:**
```typescript
export function StepTimeline() {
  const { steps, reorderSteps } = useWorkflowEditorStore();
  const sortedSteps = [...steps].sort((a, b) => a.listIndex - b.listIndex);
  
  if (steps.length === 0) {
    return <EmptyState />;
  }
  
  return (
    <div className="max-w-2xl mx-auto p-6">
      {sortedSteps.map((step, index) => (
        <div key={step.id}>
          <StepCard step={step} />
          {index < sortedSteps.length - 1 && <DataFlowIndicator />}
        </div>
      ))}
      <AddStepButton />
    </div>
  );
}
```

**Relates To:** AC-12.2, P3.1, P3.2, P3.5

#### `app/(pages)/workflows-e/editor/components/list/StepCard.tsx`
**Purpose:** Collapsed step card (default view)  
**Features:**
- Step number badge
- Step name
- Step type icon (üî• Composio, üíª Custom, etc.)
- Toolkit badge (if Composio tool)
- I/O summary (e.g., "1 input, 4 outputs")
- Click to expand

**Layout (from Flight C mockup):**
```typescript
<div className="step-card bg-[#12121f] rounded-lg border border-[#1a1a2e] hover:border-indigo-500/50">
  <div className="p-4">
    <div className="flex items-center justify-between mb-2">
      <div className="flex items-center gap-2">
        <span className="text-lg">üî•</span>
        <h3 className="font-semibold text-white">Scrape Job Listing</h3>
      </div>
      <span className="px-2 py-0.5 text-xs bg-orange-500/20 text-orange-400 rounded">Firecrawl</span>
    </div>
    <p className="text-sm text-gray-400">Extract job details from URL</p>
    <div className="mt-3 flex items-center gap-4 text-xs text-gray-500">
      <span>Input: <code className="text-indigo-400">jobUrl</code></span>
      <span>Output: <code className="text-emerald-400">jobData</code></span>
    </div>
  </div>
</div>
```

**Relates To:** AC-2.1, AC-2.2, P3.2, P3.3

#### `app/(pages)/workflows-e/editor/components/list/StepCardExpanded.tsx`
**Purpose:** Expanded step details (shown when step clicked)  
**Features:**
- Full input schema display (all fields with types)
- Full output schema display (all fields with types)
- Data source indicators (which previous step provides each input)
- Edit button (future)

**Relates To:** AC-2.6 (full I/O details)

#### `app/(pages)/workflows-e/editor/components/list/DataFlowIndicator.tsx`
**Purpose:** Visual connector between steps  
**Features:**
- Vertical line/arrow
- Mapping badge (shows field count, e.g., "3 fields mapped")
- Click badge ‚Üí opens data mapping modal (Phase 5)

**Layout (from Flight C mockup):**
```typescript
<div className="relative pl-8 pb-2">
  <div className="absolute left-[11px] top-0 bottom-0 w-0.5 bg-[#2a2a4a]"></div>
  <button className="flex items-center gap-2 px-3 py-1.5 bg-[#1a1a2e] rounded-full text-xs">
    <ArrowIcon />
    3 fields mapped
  </button>
</div>
```

**Relates To:** AC-2.3, P3.4

#### `app/(pages)/workflows-e/editor/components/list/AddStepButton.tsx`
**Purpose:** "Add Step" button at end of timeline  
**Features:**
- Dashed border button
- Click ‚Üí opens tool palette or add step modal (Phase 4)

**Relates To:** P3.1 (empty state), Foundation

### Testing Strategy

**Manual Test Flow:**
```
1. Open editor with empty workflow
2. Verify empty state shows "Add a Step" (P3.1)
3. Add mock step via store (for testing)
4. Verify step card appears in timeline (P3.2)
5. Verify card shows input/output summary (AC-2.1, AC-2.2)
6. Click step ‚Üí expands, shows full I/O details (P3.3, AC-2.6)
7. Add second step
8. Verify data flow indicator appears between steps (P3.4, AC-2.3)
9. Drag step to reorder ‚Üí verify listIndex updates (P3.5)
10. Verify list view displays sequential steps (AC-12.2)
```

**Component Tests:**
- Unit test: `StepTimeline` sorts by `listIndex`
- Unit test: `StepCard` displays step data correctly
- Visual test: Timeline renders with correct spacing

**Acceptance Criteria Checklist:**
- [ ] AC-12.2: List view displays sequential steps
- [ ] AC-2.1: Each node displays input schema
- [ ] AC-2.2: Each node displays output schema
- [ ] AC-2.3: Nodes connect via edges (visual indicator)
- [ ] AC-2.6: Node inspector shows full I/O details
- [ ] P3.1: Empty state shows "Add a Step"
- [ ] P3.2: Steps render as timeline cards
- [ ] P3.3: Click step expands it
- [ ] P3.4: Data flow indicator between steps
- [ ] P3.5: Steps can be reordered

---

## Phase 4: Tool Palette Integration

### Goal
Integrate Composio tool fetching and display. Users can browse tools grouped by toolkit, search/filter, and add tools as steps.

### File Impact Analysis

| File | Action | Purpose | Relates To AC |
|------|--------|---------|--------------|
| `app/(pages)/workflows-e/editor/components/panels/ToolPalette.tsx` | Create | Tool browser (main component) | AC-1.5, AC-1.6 |
| `app/(pages)/workflows-e/editor/components/panels/ToolPaletteGroup.tsx` | Create | Toolkit group (collapsible section) | AC-1.5 (grouping) |
| `app/(pages)/workflows-e/editor/components/panels/ToolPaletteItem.tsx` | Create | Single tool item (clickable) | AC-1.1, AC-1.2, AC-1.3, AC-1.4 |
| `app/(pages)/workflows-e/editor/hooks/useComposioTools.ts` | Create | Fetch tools from Composio API | AC-1.1, AC-1.2 |
| `app/(pages)/workflows-e/editor/components/EditorInspector.tsx` | Modify | Render ToolPalette in Tools tab | AC-1.7 |
| `app/(pages)/workflows-e/editor/store/slices/stepsSlice.ts` | Modify | Add `addStepFromTool()` action | AC-1.7 (add step) |
| `app/(pages)/workflows-e/editor/store/slices/connectionsSlice.ts` | Modify | Auto-detect connection on add step | AC-4.1 (auto-detect) |

### Acceptance Criteria Mapping

| AC | Criterion | Files That Satisfy | Test Method |
|----|-----------|-------------------|-------------|
| **AC-1.1** | Palette displays Composio tools from connected integrations | `useComposioTools.ts` + `ToolPalette.tsx` | Visual check: tools visible |
| **AC-1.2** | Palette displays NO_AUTH tools | `useComposioTools.ts` (filters NO_AUTH) | Visual check: browser_tool visible |
| **AC-1.3** | Each tool shows input schema | `ToolPaletteItem.tsx` | Click tool ‚Üí see input fields |
| **AC-1.4** | Each tool shows output schema | `ToolPaletteItem.tsx` | Click tool ‚Üí see output fields |
| **AC-1.5** | Tools grouped by toolkit | `ToolPaletteGroup.tsx` | Visual check: Gmail, GitHub sections |
| **AC-1.6** | Tools searchable by name | `ToolPalette.tsx` (search input) | Type "send" ‚Üí filter results |
| **AC-1.7** | Drag/click tool creates node | `ToolPaletteItem.tsx` + `stepsSlice.ts` | Click tool ‚Üí step appears |
| **AC-4.1** | Adding tool node auto-detects required connection | `stepsSlice.ts` + `connectionsSlice.ts` | Add Gmail tool ‚Üí "Requires: Gmail" |

### File-by-File Breakdown

#### `app/(pages)/workflows-e/editor/hooks/useComposioTools.ts`
**Purpose:** Fetch available Composio tools  
**Implementation:**
```typescript
export function useComposioTools() {
  const [tools, setTools] = useState<ComposioTool[]>([]);
  const [isLoading, setIsLoading] = useState(true);
  
  useEffect(() => {
    async function fetchTools() {
      // Use existing composio-tools service
      const response = await fetch("/api/tools/list");
      const data = await response.json();
      
      // Group by toolkit
      const grouped = groupByToolkit(data.tools);
      setTools(grouped);
      setIsLoading(false);
    }
    
    fetchTools();
  }, []);
  
  return { tools, isLoading };
}
```

**Relates To:** AC-1.1, AC-1.2

#### `app/(pages)/workflows-e/editor/components/panels/ToolPalette.tsx`
**Purpose:** Main tool browser component  
**Features:**
- Search input (filters tools by name)
- Groups tools by toolkit
- Renders `ToolPaletteGroup` for each toolkit
- Shows NO_AUTH tools in separate group

**Layout:**
```typescript
<div className="p-4">
  <input 
    type="text" 
    placeholder="Search tools..." 
    className="w-full bg-[#1a1a2e] border rounded-lg px-3 py-2"
    onChange={(e) => setSearchQuery(e.target.value)}
  />
  <div className="mt-4 space-y-4">
    {toolkitGroups.map(group => (
      <ToolPaletteGroup key={group.slug} group={group} />
    ))}
  </div>
</div>
```

**Relates To:** AC-1.5, AC-1.6

#### `app/(pages)/workflows-e/editor/components/panels/ToolPaletteGroup.tsx`
**Purpose:** Toolkit group (collapsible section)  
**Features:**
- Toolkit name and icon
- Collapsible (expand/collapse)
- Renders `ToolPaletteItem` for each tool in group
- Shows tool count

**Relates To:** AC-1.5 (visual grouping)

#### `app/(pages)/workflows-e/editor/components/panels/ToolPaletteItem.tsx`
**Purpose:** Single tool item (clickable)  
**Features:**
- Tool name
- Tool description
- Input schema summary (field count)
- Output schema summary (field count)
- Click ‚Üí adds step to workflow
- Hover ‚Üí shows tooltip with full schema

**Implementation:**
```typescript
export function ToolPaletteItem({ tool }: { tool: ComposioTool }) {
  const { addStepFromTool } = useWorkflowEditorStore();
  
  function handleClick() {
    addStepFromTool(tool);
  }
  
  return (
    <button 
      onClick={handleClick}
      className="w-full text-left px-3 py-2 rounded-lg hover:bg-[#1a1a2e]"
    >
      <div className="flex items-center justify-between">
        <span className="text-sm text-white">{tool.name}</span>
        <span className="text-xs text-gray-500">
          {tool.inputSchema.properties?.length || 0} inputs, 
          {tool.outputSchema.properties?.length || 0} outputs
        </span>
      </div>
      <p className="text-xs text-gray-400 mt-1">{tool.description}</p>
    </button>
  );
}
```

**Relates To:** AC-1.1, AC-1.2, AC-1.3, AC-1.4, AC-1.7

#### `app/(pages)/workflows-e/editor/store/slices/stepsSlice.ts`
**Modification:** Add `addStepFromTool()` action  
**New Action:**
```typescript
addStepFromTool: (tool: ComposioTool) => {
  const newStep: WorkflowStep = {
    id: `step-${Date.now()}`,
    type: "composio",
    toolId: tool.slug,
    toolkitSlug: tool.toolkit.slug,
    toolkitName: tool.toolkit.name,
    toolkitLogo: tool.toolkit.logo,
    name: tool.name,
    description: tool.description,
    inputSchema: tool.input_parameters, // JSON Schema
    outputSchema: tool.output_parameters || { type: "object" }, // JSON Schema
    position: { x: 0, y: 0 }, // Default, will be updated
    listIndex: get().steps.length, // Append to end
  };
  
  addStep(newStep);
  
  // Auto-detect connection requirement
  if (tool.toolkit.slug && !tool.no_auth) {
    get().setConnection(tool.toolkit.slug, null); // null = inherit from agent
  }
}
```

**Relates To:** AC-1.7, AC-4.1

### Testing Strategy

**Manual Test Flow:**
```
1. Open editor, click Tools tab
2. Verify tools visible in palette (AC-1.1)
3. Verify NO_AUTH tools (browser_tool) visible (AC-1.2)
4. Verify tools grouped by toolkit (Gmail, GitHub, etc.) (AC-1.5)
5. Type "send" in search ‚Üí verify only matching tools shown (AC-1.6)
6. Click on a tool ‚Üí verify step appears in timeline (AC-1.7)
7. Verify step shows input/output schemas (AC-1.3, AC-1.4)
8. Add Gmail tool ‚Üí verify ConnectionsPanel shows "Requires: Gmail" (AC-4.1)
```

**Component Tests:**
- Unit test: `useComposioTools` fetches and groups tools
- Unit test: `addStepFromTool` creates step with correct schema
- Visual test: Tool palette renders with grouping

**Acceptance Criteria Checklist:**
- [ ] AC-1.1: Palette displays Composio tools
- [ ] AC-1.2: Palette displays NO_AUTH tools
- [ ] AC-1.3: Each tool shows input schema
- [ ] AC-1.4: Each tool shows output schema
- [ ] AC-1.5: Tools grouped by toolkit
- [ ] AC-1.6: Tools searchable by name
- [ ] AC-1.7: Click tool creates node
- [ ] AC-4.1: Auto-detects required connection

---

## Phase 5: Data Mapping UI

### Goal
Enable mapping outputs from previous steps to inputs of current step. Users can create edges, map fields, and see type validation.

### File Impact Analysis

| File | Action | Purpose | Relates To AC |
|------|--------|---------|--------------|
| `app/(pages)/workflows-e/editor/components/modals/DataMappingModal.tsx` | Create | Visual field mapping UI | AC-7.1, AC-7.2, AC-7.3 |
| `app/(pages)/workflows-e/editor/components/list/DataFlowIndicator.tsx` | Modify | Click badge opens mapping modal | AC-2.4 (opens mapping UI) |
| `app/(pages)/workflows-e/editor/store/slices/mappingsSlice.ts` | Modify | Add mapping validation logic | AC-7.6 (type validation) |
| `app/api/workflows-e/services/validator.ts` | Create | Type compatibility checking | AC-3.1, AC-3.2, AC-3.3, AC-3.4 |

### Acceptance Criteria Mapping

| AC | Criterion | Files That Satisfy | Test Method |
|----|-----------|-------------------|-------------|
| **AC-2.4** | Clicking edge opens data mapping UI | `DataFlowIndicator.tsx` + `DataMappingModal.tsx` | Click edge ‚Üí modal opens |
| **AC-7.1** | Data mapping UI shows source output fields | `DataMappingModal.tsx` | Visual check: source fields listed |
| **AC-7.2** | Data mapping UI shows target input fields | `DataMappingModal.tsx` | Visual check: target fields listed |
| **AC-7.3** | User can map output field ‚Üí input field | `DataMappingModal.tsx` + `mappingsSlice.ts` | Select mapping ‚Üí saved |
| **AC-7.4** | Nested field access supported | `DataMappingModal.tsx` (path input) | Type `data.user.email` ‚Üí works |
| **AC-7.5** | Auto-map matching field names | `DataMappingModal.tsx` (auto-map button) | Click ‚Üí matching names mapped |
| **AC-7.6** | Type mismatches shown as warnings | `validator.ts` + `DataMappingModal.tsx` | Map string‚Üínumber ‚Üí warning |
| **AC-3.1** | Type validation runs when creating edge | `validator.ts` | Create edge ‚Üí validation runs |
| **AC-3.2** | Invalid connections show visual indicator | `DataMappingModal.tsx` (red indicator) | Mismatched types ‚Üí red |
| **AC-3.3** | Coercible types show warning but allow | `DataMappingModal.tsx` (yellow indicator) | number‚Üístring ‚Üí yellow |
| **AC-3.4** | Incompatible types block connection | `DataMappingModal.tsx` (error message) | object‚Üíboolean ‚Üí error |

### File-by-File Breakdown

#### `app/api/workflows-e/services/validator.ts`
**Purpose:** Type compatibility checking  
**Functions:**
- `validateTypeCompatibility(sourceType, targetType)` ‚Üí Returns "exact" | "coercible" | "incompatible"
- `validateFieldMapping(sourcePath, targetField, sourceSchema, targetSchema)` ‚Üí Returns validation result
- `validateMapping(mapping)` ‚Üí Validates entire mapping

**Type Compatibility Logic:**
```typescript
function validateTypeCompatibility(
  sourceType: string,
  targetType: string
): "exact" | "coercible" | "incompatible" {
  if (sourceType === targetType) return "exact";
  
  // Coercible: number ‚Üí string, boolean ‚Üí string
  if (targetType === "string" && (sourceType === "number" || sourceType === "boolean")) {
    return "coercible";
  }
  
  // Incompatible: object ‚Üí boolean, array ‚Üí number
  if ((sourceType === "object" && targetType === "boolean") ||
      (sourceType === "array" && targetType === "number")) {
    return "incompatible";
  }
  
  // any accepts anything
  if (targetType === "any") return "exact";
  
  return "incompatible";
}
```

**Relates To:** AC-3.1, AC-3.2, AC-3.3, AC-3.4, AC-7.6

#### `app/(pages)/workflows-e/editor/components/modals/DataMappingModal.tsx`
**Purpose:** Visual field mapping UI  
**Layout (from Flight C mockup):**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Data Mapping                                    [X]         ‚îÇ
‚îÇ  Step 1 ‚Üí Step 2                                             ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  Connect outputs from "Scrape Job" to "Generate Resume"     ‚îÇ
‚îÇ                                                              ‚îÇ
‚îÇ  OUTPUT (available)          INPUT (required)               ‚îÇ
‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ           ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ             ‚îÇ
‚îÇ  title (string)      ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂ jobTitle (string) ‚úì            ‚îÇ
‚îÇ  company (string)    ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂ companyName (string) ‚úì         ‚îÇ
‚îÇ  requirements (str[])‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂ targetSkills (string[]) ‚úì       ‚îÇ
‚îÇ  salary.min (number)         salaryRange (string)            ‚îÇ
‚îÇ                             [Not mapped - optional]          ‚îÇ
‚îÇ                                                              ‚îÇ
‚îÇ  [+ Add transform: salary.min + "-" + salary.max]            ‚îÇ
‚îÇ                                                              ‚îÇ
‚îÇ  [Cancel]  [Save Mapping]                                     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**Features:**
- Two-column layout: Source outputs | Target inputs
- Field selection dropdowns
- Type validation indicators (‚úì green, ‚ö†Ô∏è yellow, ‚úó red)
- Nested path input (e.g., `data.user.email`)
- Auto-map button (matches field names)
- Save button (creates mapping in store)

**Implementation:**
```typescript
export function DataMappingModal({ 
  sourceStepId, 
  targetStepId,
  onClose 
}: DataMappingModalProps) {
  const { getStepById, addMapping, validateMapping } = useWorkflowEditorStore();
  const sourceStep = getStepById(sourceStepId);
  const targetStep = getStepById(targetStepId);
  
  const [fieldMappings, setFieldMappings] = useState<FieldMapping[]>([]);
  
  function handleAutoMap() {
    // Match field names automatically
    const autoMapped = autoMapFields(sourceStep.outputSchema, targetStep.inputSchema);
    setFieldMappings(autoMapped);
  }
  
  function handleSave() {
    const mapping: DataMapping = {
      id: `mapping-${Date.now()}`,
      sourceStepId,
      targetStepId,
      fieldMappings,
    };
    
    // Validate before saving
    const validation = validateMapping(mapping);
    if (validation.valid) {
      addMapping(mapping);
      onClose();
    } else {
      // Show validation errors
    }
  }
  
  return (
    <Modal>
      <div className="flex gap-6">
        <div className="flex-1">
          <h4>Source Outputs</h4>
          <FieldList schema={sourceStep.outputSchema} />
        </div>
        <div className="flex-1">
          <h4>Target Inputs</h4>
          <FieldList schema={targetStep.inputSchema} />
        </div>
      </div>
      <button onClick={handleAutoMap}>Auto-map</button>
      <button onClick={handleSave}>Save Mapping</button>
    </Modal>
  );
}
```

**Relates To:** AC-7.1, AC-7.2, AC-7.3, AC-7.4, AC-7.5, AC-7.6

#### `app/(pages)/workflows-e/editor/components/list/DataFlowIndicator.tsx`
**Modification:** Add click handler to open mapping modal  
**Change:**
```typescript
<button 
  onClick={() => openMappingModal(sourceStepId, targetStepId)}
  className="flex items-center gap-2 px-3 py-1.5 bg-[#1a1a2e] rounded-full"
>
  <ArrowIcon />
  {mappingCount} fields mapped
</button>
```

**Relates To:** AC-2.4 (opens mapping UI on click)

### Testing Strategy

**Manual Test Flow:**
```
1. Add two steps to workflow
2. Click data flow indicator between steps (AC-2.4)
3. Verify mapping modal opens (AC-7.1, AC-7.2)
4. Verify source output fields listed (AC-7.1)
5. Verify target input fields listed (AC-7.2)
6. Map title ‚Üí jobTitle (AC-7.3)
7. Type nested path: data.user.email ‚Üí recipientEmail (AC-7.4)
8. Click "Auto-map" ‚Üí verify matching names mapped (AC-7.5)
9. Try mapping incompatible types ‚Üí verify error shown (AC-3.4, AC-7.6)
10. Try mapping coercible types ‚Üí verify warning shown (AC-3.3)
11. Save mapping ‚Üí verify stored in store
12. Close modal ‚Üí verify mapping badge shows field count
```

**Component Tests:**
- Unit test: `validateTypeCompatibility` returns correct result
- Unit test: Auto-map matches field names correctly
- Visual test: Mapping modal renders with correct layout

**Acceptance Criteria Checklist:**
- [ ] AC-2.4: Clicking edge opens data mapping UI
- [ ] AC-7.1: Data mapping UI shows source fields
- [ ] AC-7.2: Data mapping UI shows target fields
- [ ] AC-7.3: User can map output field ‚Üí input field
- [ ] AC-7.4: Nested field access supported
- [ ] AC-7.5: Auto-map matching field names
- [ ] AC-7.6: Type mismatches shown as warnings
- [ ] AC-3.1: Type validation runs when creating edge
- [ ] AC-3.2: Invalid connections show visual indicator
- [ ] AC-3.3: Coercible types show warning but allow
- [ ] AC-3.4: Incompatible types block connection

---

## Phase 6: Runtime Inputs & Configs

### Goal
Allow users to define runtime inputs and workflow configs. These can be referenced in node parameters via `{{inputs.x}}` and `{{configs.x}}`.

### File Impact Analysis

| File | Action | Purpose | Relates To AC |
|------|--------|---------|--------------|
| `app/(pages)/workflows-e/editor/components/panels/InputsPanel.tsx` | Create | Runtime inputs configuration UI | AC-6.1, AC-6.2 |
| `app/(pages)/workflows-e/editor/components/panels/ConfigPanel.tsx` | Create | Workflow configs configuration UI | AC-5.1, AC-5.5 |
| `app/(pages)/workflows-e/editor/components/modals/DataMappingModal.tsx` | Modify | Show inputs/configs in source dropdown | AC-6.4, AC-5.2 |
| `app/(pages)/workflows-e/editor/store/slices/inputsSlice.ts` | Modify | Already exists, ensure CRUD works | AC-6.1, AC-5.1 |
| `app/(pages)/workflows-e/editor/store/slices/configsSlice.ts` | Modify | Already exists, ensure CRUD works | AC-5.1 |

### Acceptance Criteria Mapping

| AC | Criterion | Files That Satisfy | Test Method |
|----|-----------|-------------------|-------------|
| **AC-6.1** | Author can define runtime inputs | `InputsPanel.tsx` + `inputsSlice.ts` | Add input in panel ‚Üí appears |
| **AC-6.2** | Runtime inputs have schema | `InputsPanel.tsx` (type selector) | Define input as number ‚Üí validation |
| **AC-6.4** | Node parameters can reference inputs | `DataMappingModal.tsx` (dropdown) | `{{inputs.jobUrl}}` available |
| **AC-5.1** | Author can define configs | `ConfigPanel.tsx` + `configsSlice.ts` | Add config in panel ‚Üí appears |
| **AC-5.2** | Node parameters can reference configs | `DataMappingModal.tsx` (dropdown) | `{{configs.targetRepo}}` available |
| **AC-5.5** | Supported config types work | `ConfigPanel.tsx` (type selector) | Create each type ‚Üí works |

### File-by-File Breakdown

#### `app/(pages)/workflows-e/editor/components/panels/InputsPanel.tsx`
**Purpose:** Runtime inputs configuration UI  
**Features:**
- List of existing runtime inputs
- "Add Input" button
- Input form: key, type, label, description, required, default, validation
- Edit/delete existing inputs
- Type selector: string, number, boolean, array, object
- Validation options: format (email, url, date), min/max, pattern

**Layout:**
```typescript
<div className="p-4">
  <p className="text-xs text-gray-500 mb-4">
    Define inputs users provide when running this workflow.
  </p>
  <div className="space-y-3">
    {runtimeInputs.map(input => (
      <InputCard key={input.key} input={input} />
    ))}
    <button onClick={handleAddInput}>+ Add Input</button>
  </div>
</div>
```

**Relates To:** AC-6.1, AC-6.2

#### `app/(pages)/workflows-e/editor/components/panels/ConfigPanel.tsx`
**Purpose:** Workflow configs configuration UI  
**Features:**
- List of existing configs
- "Add Config" button
- Config form: key, type, label, description, required, default, options (for select)
- Type selector: text, number, boolean, select
- Edit/delete existing configs

**Relates To:** AC-5.1, AC-5.5

#### `app/(pages)/workflows-e/editor/components/modals/DataMappingModal.tsx`
**Modification:** Add inputs/configs to source dropdown  
**Change:**
```typescript
// In source field selector, show:
// - Previous step outputs
// - Runtime inputs (with $ prefix: $jobUrl)
// - Workflow configs (with {{configs.}} prefix: {{configs.targetRepo}})
```

**Relates To:** AC-6.4, AC-5.2

### Testing Strategy

**Manual Test Flow:**
```
1. Click Inputs tab
2. Click "Add Input" (AC-6.1)
3. Fill: key="jobUrl", type="string", required=true
4. Verify input appears in list
5. Click Config tab
6. Click "Add Config" (AC-5.1)
7. Fill: key="targetRepo", type="text", required=true
8. Verify config appears in list
9. Open data mapping modal
10. Verify $jobUrl available in source dropdown (AC-6.4)
11. Verify {{configs.targetRepo}} available in source dropdown (AC-5.2)
12. Create select config ‚Üí verify options field works (AC-5.5)
```

**Acceptance Criteria Checklist:**
- [ ] AC-6.1: Author can define runtime inputs
- [ ] AC-6.2: Runtime inputs have schema
- [ ] AC-6.4: Node parameters can reference inputs
- [ ] AC-5.1: Author can define configs
- [ ] AC-5.2: Node parameters can reference configs
- [ ] AC-5.5: Supported config types work

---

## Phase 7: Connections Panel

### Goal
Auto-detect and display required connections. Show connected/not-connected status.

### File Impact Analysis

| File | Action | Purpose | Relates To AC |
|------|--------|---------|--------------|
| `app/(pages)/workflows-e/editor/components/panels/ConnectionsPanel.tsx` | Create | Required connections display | AC-4.2, AC-4.3 |
| `app/(pages)/workflows-e/editor/store/slices/connectionsSlice.ts` | Modify | Add `getConnectionStatus()` action | AC-4.2 (status display) |
| `app/api/workflows-e/[workflowId]/route.ts` | Modify | Validate connections on save | AC-4.3 (validation) |

### Acceptance Criteria Mapping

| AC | Criterion | Files That Satisfy | Test Method |
|----|-----------|-------------------|-------------|
| **AC-4.2** | Required connections displayed in panel | `ConnectionsPanel.tsx` | Visual check: connections listed |
| **AC-4.3** | Validate when assigning to agent | `[workflowId]/route.ts` (future) | Assign ‚Üí validation runs |
| **AC-4.4** | Block execution if connections missing | `executor.ts` (Phase 8) | Execute without Gmail ‚Üí error |

### File-by-File Breakdown

#### `app/(pages)/workflows-e/editor/components/panels/ConnectionsPanel.tsx`
**Purpose:** Required connections display  
**Features:**
- List of required toolkits (auto-detected from steps)
- Status indicator: Connected (green) / Not Connected (yellow)
- "Connect" button for missing connections
- Link to connections page

**Layout:**
```typescript
<div className="p-4">
  <p className="text-xs text-gray-500 mb-4">
    Required connections for this workflow.
  </p>
  <div className="space-y-3">
    {requiredToolkits.map(toolkit => (
      <ConnectionCard 
        key={toolkit.slug}
        toolkit={toolkit}
        status={getConnectionStatus(toolkit.slug)}
      />
    ))}
  </div>
</div>
```

**Relates To:** AC-4.2

### Testing Strategy

**Manual Test Flow:**
```
1. Add Gmail tool step
2. Click Connect tab
3. Verify "Gmail" appears in required connections (AC-4.2)
4. Verify status shows "Not Connected" (yellow)
5. Connect Gmail via connections page
6. Return to editor ‚Üí verify status shows "Connected" (green)
```

**Acceptance Criteria Checklist:**
- [ ] AC-4.2: Required connections displayed in panel
- [ ] AC-4.3: Validate when assigning to agent (future)
- [ ] AC-4.4: Block execution if connections missing (Phase 8)

---

## Phase 8: Test Execution

### Goal
Enable running workflow tests with step-by-step progress. Users can fill runtime inputs, run test, and see real-time execution.

### File Impact Analysis

| File | Action | Purpose | Relates To AC |
|------|--------|---------|--------------|
| `app/(pages)/workflows-e/editor/components/panels/TestPanel.tsx` | Create | Test execution UI (form + results) | AC-8.1, AC-8.2 |
| `app/(pages)/workflows-e/editor/components/modals/TestExecutionModal.tsx` | Create | Full-screen test progress modal | AC-8.4, AC-8.5 |
| `app/api/workflows-e/[workflowId]/test/route.ts` | Create | POST - test execution endpoint | AC-8.1 (runs test) |
| `app/api/workflows-e/services/executor.ts` | Create | Runtime workflow construction + execution | AC-8.4 (step progress) |
| `app/(pages)/workflows-e/editor/hooks/useWorkflowExecution.ts` | Create | Hook to stream test execution | AC-8.4 (real-time updates) |
| `app/(pages)/workflows-e/editor/store/slices/testingSlice.ts` | Modify | Update with step results | AC-8.4, AC-8.5 |

### Acceptance Criteria Mapping

| AC | Criterion | Files That Satisfy | Test Method |
|----|-----------|-------------------|-------------|
| **AC-8.1** | Test button runs workflow with inputs | `TestPanel.tsx` + `test/route.ts` | Fill inputs ‚Üí run ‚Üí executes |
| **AC-8.2** | User can create and save test cases | `TestPanel.tsx` (save button) | Save test ‚Üí appears in list |
| **AC-8.3** | Test cases store inputs + configs | `TestPanel.tsx` (test case structure) | Save ‚Üí reopen ‚Üí values restored |
| **AC-8.4** | Test execution shows step-by-step progress | `TestExecutionModal.tsx` + `executor.ts` | Run ‚Üí see each step execute |
| **AC-8.5** | Test execution shows errors clearly | `TestExecutionModal.tsx` | Step fails ‚Üí error message |
| **AC-8.6** | Saved test case can be re-run | `TestPanel.tsx` (re-run button) | Select test ‚Üí click Run |
| **AC-8.7** | Test history available | `TestPanel.tsx` (history list) | View past runs |

### File-by-File Breakdown

#### `app/api/workflows-e/services/executor.ts`
**Purpose:** Runtime workflow construction and execution  
**Functions:**
- `constructWorkflowFromDefinition(def)` ‚Üí Builds Mastra workflow at runtime
- `executeWorkflow(workflow, inputs, connections)` ‚Üí Executes and streams events
- `createComposioStep(tool, connectionId)` ‚Üí Wraps Composio tool as Mastra step

**Implementation:**
```typescript
export async function constructWorkflowFromDefinition(
  def: WorkflowDefinition
): Promise<Workflow> {
  // Convert JSON Schema to Zod
  const inputSchema = jsonSchemaToZod(def.inputSchema);
  const outputSchema = jsonSchemaToZod(def.outputSchema);
  
  // Create workflow
  let workflow = createWorkflow({
    id: def.id,
    inputSchema,
    outputSchema,
  });
  
  // Add steps
  for (const stepDef of def.steps) {
    const step = await createStepFromDefinition(stepDef);
    workflow = workflow.then(step);
    
    // Add mappings if needed
    const mapping = def.mappings.find(m => m.targetStepId === stepDef.id);
    if (mapping) {
      workflow = workflow.map(generateMapConfig(mapping));
    }
  }
  
  return workflow.commit();
}

export async function executeWorkflow(
  workflow: Workflow,
  inputs: Record<string, unknown>,
  connections: Record<string, string>
): Promise<AsyncIterable<ExecutionEvent>> {
  const run = await workflow.createRunAsync();
  const { stream } = run.stream({ inputData: inputs });
  
  // Stream events as they come
  return stream;
}
```

**Relates To:** AC-8.4 (step-by-step execution)

#### `app/api/workflows-e/[workflowId]/test/route.ts`
**Purpose:** API endpoint for test execution  
**Method:** POST  
**Request Body:** `{ runtimeInputs: Record<string, unknown> }`  
**Response:** Streams execution events (Server-Sent Events)

**Implementation:**
```typescript
export async function POST(
  request: Request,
  { params }: { params: { workflowId: string } }
) {
  const { runtimeInputs } = await request.json();
  
  // Load workflow
  const workflow = await getWorkflow(params.workflowId);
  if (!workflow) return NextResponse.json({ error: "Not found" }, { status: 404 });
  
  // Construct workflow at runtime
  const mastraWorkflow = await constructWorkflowFromDefinition(workflow);
  
  // Execute and stream
  const stream = executeWorkflow(mastraWorkflow, runtimeInputs, workflow.connections);
  
  // Return as SSE stream
  return new Response(
    new ReadableStream({
      async start(controller) {
        for await (const event of stream) {
          controller.enqueue(`data: ${JSON.stringify(event)}\n\n`);
        }
        controller.close();
      },
    }),
    { headers: { "Content-Type": "text/event-stream" } }
  );
}
```

**Relates To:** AC-8.1 (runs test)

#### `app/(pages)/workflows-e/editor/components/modals/TestExecutionModal.tsx`
**Purpose:** Full-screen test progress modal  
**Features:**
- Progress bar
- Step cards with status (running, success, failed)
- Real-time updates as events stream in
- Error display for failed steps
- Stop button (future)

**Layout (from Flight C mockup):**
```typescript
<Modal>
  <div className="p-6">
    <ProgressBar progress={progress} />
    <div className="space-y-3">
      {steps.map(step => (
        <StepCard 
          key={step.id}
          step={step}
          status={stepResults[step.id]?.status}
          output={stepResults[step.id]?.output}
          error={stepResults[step.id]?.error}
        />
      ))}
    </div>
  </div>
</Modal>
```

**Relates To:** AC-8.4, AC-8.5

#### `app/(pages)/workflows-e/editor/hooks/useWorkflowExecution.ts`
**Purpose:** Hook to stream test execution  
**Implementation:**
```typescript
export function useWorkflowExecution() {
  const { setExecutionStatus, setStepResult } = useWorkflowEditorStore();
  
  async function runTest(workflowId: string, inputs: Record<string, unknown>) {
    setExecutionStatus("running");
    
    const response = await fetch(`/api/workflows-e/${workflowId}/test`, {
      method: "POST",
      body: JSON.stringify({ runtimeInputs: inputs }),
    });
    
    const reader = response.body?.getReader();
    const decoder = new TextDecoder();
    
    while (true) {
      const { done, value } = await reader.read();
      if (done) break;
      
      const chunk = decoder.decode(value);
      const events = parseSSE(chunk);
      
      for (const event of events) {
        if (event.type === "step-result") {
          setStepResult({
            stepId: event.id,
            status: event.status,
            output: event.output,
            error: event.error,
          });
        }
      }
    }
    
    setExecutionStatus("success");
  }
  
  return { runTest };
}
```

**Relates To:** AC-8.4 (real-time updates)

### Testing Strategy

**Manual Test Flow:**
```
1. Create workflow with 2 steps
2. Define runtime input: jobUrl (string, required)
3. Click Test tab
4. Fill runtime input: jobUrl = "https://example.com/job"
5. Click "Run Test" (AC-8.1)
6. Verify TestExecutionModal opens
7. Watch step-by-step progress (AC-8.4)
8. Verify Step 1 shows "Running..." then "‚úì Success"
9. Verify Step 2 shows "Running..." then "‚úì Success"
10. Verify "Passed" banner with total time
11. Cause a failure (invalid input) ‚Üí verify error shown (AC-8.5)
12. Save test case ‚Üí verify appears in list (AC-8.2)
13. Re-run saved test ‚Üí verify executes (AC-8.6)
```

**Acceptance Criteria Checklist:**
- [ ] AC-8.1: Test button runs workflow with inputs
- [ ] AC-8.2: User can create and save test cases
- [ ] AC-8.3: Test cases store inputs + configs
- [ ] AC-8.4: Test execution shows step-by-step progress
- [ ] AC-8.5: Test execution shows errors clearly
- [ ] AC-8.6: Saved test case can be re-run
- [ ] AC-8.7: Test history available

---

## Phase 9: Code Generation

### Goal
Generate Mastra TypeScript code from workflow.json. Save workflow.ts on save.

### File Impact Analysis

| File | Action | Purpose | Relates To AC |
|------|--------|---------|--------------|
| `app/api/workflows-e/services/generator.ts` | Create | workflow.json ‚Üí workflow.ts transpiler | AC-13.2, AC-7.3 |
| `app/api/workflows-e/[workflowId]/route.ts` | Modify | Call generator on PATCH | AC-13.2 (generates on save) |
| `app/(pages)/workflows-e/editor/components/EditorHeader.tsx` | Modify | Save button triggers generation | AC-13.2 |

### Acceptance Criteria Mapping

| AC | Criterion | Files That Satisfy | Test Method |
|----|-----------|-------------------|-------------|
| **AC-13.2** | Generated code saved to workflow.ts | `generator.ts` + `storage.ts` | Save ‚Üí file exists |
| **AC-7.3** | Generated code uses Mastra primitives | `generator.ts` | Inspect generated code |

### File-by-File Breakdown

#### `app/api/workflows-e/services/generator.ts`
**Purpose:** Transpile workflow.json to workflow.ts  
**Functions:**
- `generateWorkflowCode(workflow)` ‚Üí Returns TypeScript string
- `jsonSchemaToZod(schema)` ‚Üí Converts JSON Schema to Zod code string
- `generateMapCall(mapping)` ‚Üí Generates `.map()` call
- `generateStepCode(step)` ‚Üí Generates `createStep()` call

**Implementation:**
```typescript
export function generateWorkflowCode(workflow: WorkflowDefinition): string {
  const inputSchemaCode = jsonSchemaToZod(workflow.inputSchema);
  const outputSchemaCode = jsonSchemaToZod(workflow.outputSchema);
  
  let code = `
import { createWorkflow, createStep } from "@mastra/core";
import { z } from "zod";
import { getComposioClient } from "@/app/api/connections/services/composio";

const inputSchema = ${inputSchemaCode};
const outputSchema = ${outputSchemaCode};

// Step Definitions
${workflow.steps.map(step => generateStepCode(step)).join("\n\n")}

// Workflow Composition
export const ${workflow.id}Workflow = createWorkflow({
  id: "${workflow.id}",
  description: "${workflow.description}",
  inputSchema,
  outputSchema,
})
${generateWorkflowChain(workflow)}
.commit();
`;
  
  return code;
}

function generateWorkflowChain(workflow: WorkflowDefinition): string {
  let chain = "";
  
  for (const stepId of workflow.controlFlow.order || []) {
    chain += `\n  .then(${stepId}Step)`;
    
    // Check if mapping needed
    const mapping = workflow.mappings.find(m => m.targetStepId === stepId);
    if (mapping) {
      chain += `\n  ${generateMapCall(mapping)}`;
    }
  }
  
  return chain;
}
```

**Relates To:** AC-13.2, AC-7.3

### Testing Strategy

**Manual Test Flow:**
```
1. Create workflow with 2 steps and mapping
2. Click Save
3. Verify workflow.json saved
4. Verify workflow.ts generated (AC-13.2)
5. Open workflow.ts ‚Üí verify uses createWorkflow, createStep (AC-7.3)
6. Verify TypeScript compiles (no syntax errors)
7. Verify .map() call generated correctly
```

**Automated Tests:**
- Unit test: `jsonSchemaToZod` converts correctly
- Unit test: `generateMapCall` generates correct code
- Unit test: Generated code is valid TypeScript (compile check)

**Acceptance Criteria Checklist:**
- [ ] AC-13.2: Generated code saved to workflow.ts
- [ ] AC-7.3: Generated code uses Mastra primitives

---

## Phase 10: Canvas View

### Goal
Add ReactFlow canvas view. Users can toggle between list and canvas, drag nodes, and see visual data flow.

### File Impact Analysis

| File | Action | Purpose | Relates To AC |
|------|--------|---------|--------------|
| `app/(pages)/workflows-e/editor/components/canvas/WorkflowCanvas.tsx` | Create | ReactFlow wrapper | AC-12.1 (canvas view) |
| `app/(pages)/workflows-e/editor/components/canvas/StepNode.tsx` | Create | Custom node component | AC-2.1, AC-2.2 (I/O display) |
| `app/(pages)/workflows-e/editor/components/canvas/DataEdge.tsx` | Create | Custom edge component | AC-2.3 (visual connection) |
| `app/(pages)/workflows-e/editor/components/EditorMain.tsx` | Modify | Render canvas when viewMode === "canvas" | AC-12.1 |
| `app/(pages)/workflows-e/editor/components/EditorHeader.tsx` | Modify | Add view toggle (List/Canvas) | AC-12.4 (toggle) |
| `app/(pages)/workflows-e/editor/store/slices/uiSlice.ts` | Modify | Add viewMode state | AC-12.3 (state sync) |

### Acceptance Criteria Mapping

| AC | Criterion | Files That Satisfy | Test Method |
|----|-----------|-------------------|-------------|
| **AC-12.1** | Canvas view displays workflow as graph | `WorkflowCanvas.tsx` | Toggle to canvas ‚Üí graph visible |
| **AC-12.3** | Both views read/write same state | `uiSlice.ts` (viewMode) | Edit in one ‚Üí other updates |
| **AC-12.4** | View toggle persists preference | `EditorHeader.tsx` (toggle) | Refresh ‚Üí same view selected |

### File-by-File Breakdown

#### `app/(pages)/workflows-e/editor/components/canvas/WorkflowCanvas.tsx`
**Purpose:** ReactFlow canvas wrapper  
**Features:**
- ReactFlow instance
- Custom node types
- Custom edge types
- Node positioning from `step.position`
- Edge rendering from `mappings`
- Drag-drop node repositioning
- Zoom/pan controls

**Implementation:**
```typescript
import ReactFlow, { Node, Edge } from "reactflow";
import "reactflow/dist/style.css";

export function WorkflowCanvas() {
  const { steps, mappings, updateStep } = useWorkflowEditorStore();
  
  const nodes: Node[] = steps.map(step => ({
    id: step.id,
    type: "stepNode",
    position: step.position,
    data: step,
  }));
  
  const edges: Edge[] = mappings
    .filter(m => m.sourceStepId !== "__input__")
    .map(mapping => ({
      id: mapping.id,
      source: mapping.sourceStepId,
      target: mapping.targetStepId,
      type: "dataEdge",
      data: mapping,
    }));
  
  function onNodesChange(changes) {
    // Update step positions in store
    changes.forEach(change => {
      if (change.type === "position" && change.position) {
        updateStep(change.id, { position: change.position });
      }
    });
  }
  
  return (
    <ReactFlow
      nodes={nodes}
      edges={edges}
      nodeTypes={{ stepNode: StepNode }}
      edgeTypes={{ dataEdge: DataEdge }}
      onNodesChange={onNodesChange}
    />
  );
}
```

**Relates To:** AC-12.1, AC-12.3

### Testing Strategy

**Manual Test Flow:**
```
1. Toggle to canvas view (AC-12.4)
2. Verify nodes render at correct positions (AC-12.1)
3. Verify edges connect nodes (AC-12.1)
4. Drag node to new position
5. Toggle to list view ‚Üí verify order unchanged (AC-12.3)
6. Add step in list view
7. Toggle to canvas ‚Üí verify new node appears (AC-12.3)
```

**Acceptance Criteria Checklist:**
- [ ] AC-12.1: Canvas view displays workflow as graph
- [ ] AC-12.3: Both views read/write same state
- [ ] AC-12.4: View toggle persists preference

---

## Phase 11: Abstraction Levels

### Goal
Implement Flow/Spec/Code views. Users can toggle between visual editor, SOP document, and generated code preview.

### File Impact Analysis

| File | Action | Purpose | Relates To AC |
|------|--------|---------|--------------|
| `app/(pages)/workflows-e/editor/components/views/SpecView.tsx` | Create | Generate SOP document from workflow | Variation E unique |
| `app/(pages)/workflows-e/editor/components/views/CodeView.tsx` | Create | Show generated TypeScript preview | Variation E unique |
| `app/(pages)/workflows-e/editor/components/EditorMain.tsx` | Modify | Render based on abstractionLevel | Variation E unique |
| `app/(pages)/workflows-e/editor/components/EditorHeader.tsx` | Modify | Add abstraction level toggle | Variation E unique |

### File-by-File Breakdown

#### `app/(pages)/workflows-e/editor/components/views/SpecView.tsx`
**Purpose:** Generate Standard Operating Procedure document  
**Features:**
- Markdown/HTML generation from workflow definition
- Human-readable format
- Step-by-step procedure
- Input/output tables

**Relates To:** Variation E unique feature

#### `app/(pages)/workflows-e/editor/components/views/CodeView.tsx`
**Purpose:** Show generated TypeScript code preview  
**Features:**
- Read-only code editor
- Syntax highlighting
- Generated from workflow.json
- Updates when workflow changes

**Relates To:** Variation E unique feature

### Testing Strategy

**Manual Test Flow:**
```
1. Toggle to Spec view
2. Verify SOP document generated
3. Toggle to Code view
4. Verify generated TypeScript shown
5. Toggle to Flow view
6. Verify editor returns
```

---

## Phase 12: Polish & Integration

### Goal
Final polish, error handling, edge cases, keyboard shortcuts.

### File Impact Analysis

| File | Action | Purpose | Relates To AC |
|------|--------|---------|--------------|
| `app/(pages)/workflows-e/editor/components/ErrorBoundary.tsx` | Create | Error boundary component | Error handling |
| `app/(pages)/workflows-e/editor/components/EditorHeader.tsx` | Modify | Add keyboard shortcuts | UX polish |

### Testing Strategy

**Full Acceptance Criteria Test:**
- Run through all 81 acceptance criteria
- Verify no console errors
- Test error scenarios
- Test edge cases (empty workflow, single step, etc.)

---

## Summary: File Count by Phase

| Phase | Files Created | Files Modified | Total |
|-------|--------------|---------------|-------|
| 1 | 8 | 1 | 9 |
| 2 | 15 | 0 | 15 |
| 3 | 5 | 1 | 6 |
| 4 | 4 | 2 | 6 |
| 5 | 2 | 2 | 4 |
| 6 | 2 | 2 | 4 |
| 7 | 1 | 2 | 3 |
| 8 | 5 | 1 | 6 |
| 9 | 1 | 2 | 3 |
| 10 | 3 | 2 | 5 |
| 11 | 2 | 2 | 4 |
| 12 | 1 | 1 | 2 |
| **Total** | **49** | **17** | **66** |

---

## Testing Strategy Summary

### Per-Phase Testing
- **Manual test flows** for each phase
- **Component tests** for complex logic
- **Visual tests** for UI components
- **Integration tests** for API routes

### End-to-End Testing
- Create workflow from scratch
- Add steps, map data, define inputs/configs
- Test workflow execution
- Save and reload
- Verify generated code

### Acceptance Criteria Tracking
- Checklist for each phase
- Track completion status
- Verify against product requirements

---

## Next Steps

1. **Review this plan** with product owner
2. **Start Phase 1** (Foundation & Navigation)
3. **Iterate phase by phase** with testing
4. **Track acceptance criteria** completion

