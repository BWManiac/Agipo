<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Workflow Editor - Flight C: Comprehensive Mockup</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #4F46E5;
            --success: #10B981;
            --warning: #F59E0B;
            --error: #F43F5E;
            --bg: #F8FAFC;
            --card: #FFFFFF;
            --border: #E2E8F0;
            --text: #0F172A;
            --muted: #64748B;
        }
        
        body { 
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; 
        }
        
        .font-mono { font-family: 'JetBrains Mono', monospace; }
        
        .animate-fade-in { animation: fadeIn 0.2s ease-out; }
        @keyframes fadeIn { 
            from { opacity: 0; transform: translateY(5px); } 
            to { opacity: 1; transform: translateY(0); } 
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .animate-pulse-slow { animation: pulse 2s ease-in-out infinite; }
        
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .animate-spin { animation: spin 1s linear infinite; }
        
        /* Custom scrollbar */
        .custom-scroll::-webkit-scrollbar { width: 6px; }
        .custom-scroll::-webkit-scrollbar-track { background: transparent; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #d1d5db; border-radius: 3px; }
        .custom-scroll::-webkit-scrollbar-thumb:hover { background: #9ca3af; }
        
        /* Canvas grid pattern */
        .canvas-grid {
            background-image: radial-gradient(circle, #d1d5db 1px, transparent 1px);
            background-size: 20px 20px;
        }
        
        /* Node connection handles */
        .handle {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: white;
            border: 2px solid #3b82f6;
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            cursor: crosshair;
            transition: all 0.15s ease;
        }
        .handle:hover {
            transform: translateY(-50%) scale(1.2);
            background: #3b82f6;
        }
        .handle-left { left: -6px; }
        .handle-right { right: -6px; }
        .handle-top { top: -6px; left: 50%; transform: translateX(-50%); }
        .handle-bottom { bottom: -6px; top: auto; left: 50%; transform: translateX(-50%); }
        
        /* Edge line */
        .edge-line {
            stroke: #3b82f6;
            stroke-width: 2;
            fill: none;
        }
        .edge-line-success { stroke: #10B981; }
        .edge-line-error { stroke: #F43F5E; }
        .edge-line-parallel { stroke: #8B5CF6; stroke-dasharray: 5,5; }
        
        /* Panel tab active state */
        .panel-tab.active { 
            background: white; 
            border-color: #e5e7eb; 
            border-bottom-color: white; 
            color: #111;
        }
        
        /* Toggle button group */
        .toggle-btn.active {
            background: white;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
        }
        
        /* Step card hover */
        .step-card { transition: all 0.2s ease; }
        .step-card:hover { transform: translateX(4px); }
        
        /* Timeline connector */
        .timeline-line {
            position: absolute;
            left: 31px;
            width: 2px;
            background: linear-gradient(to bottom, #3b82f6, #3b82f6);
        }
        
        /* Modal backdrop */
        .modal-backdrop {
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(2px);
        }
        
        /* Gradient backgrounds */
        .bg-subtle { background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%); }
        
        /* Control flow node shapes */
        .branch-diamond {
            width: 48px;
            height: 48px;
            transform: rotate(45deg);
            background: linear-gradient(135deg, #8B5CF6, #6366F1);
        }
        .branch-diamond-inner {
            transform: rotate(-45deg);
        }
        
        /* State visibility */
        .state-section { display: none; }
        .state-section.active { display: block; }
        
        /* Navigator */
        .state-nav {
            position: fixed;
            top: 16px;
            right: 16px;
            z-index: 1000;
        }
    </style>
</head>
<body class="bg-gray-100">

    <!-- ============================================== -->
    <!-- STATE NAVIGATOR                               -->
    <!-- ============================================== -->
    <div class="state-nav">
        <div class="bg-white rounded-xl shadow-lg border border-gray-200 p-3">
            <label class="block text-xs font-medium text-gray-500 uppercase mb-2">View State</label>
            <select id="stateSelector" onchange="showState(this.value)" class="w-64 text-sm border border-gray-200 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                <optgroup label="Core Editing">
                    <option value="state-empty">1. Empty Workflow</option>
                    <option value="state-list-editing" selected>2. List View - Editing</option>
                    <option value="state-list-flow">3. List View - Flow Mode</option>
                    <option value="state-canvas-editing">4. Canvas View - Editing</option>
                    <option value="state-canvas-flow">5. Canvas View - Flow Mode</option>
                    <option value="state-node-selected">6. Node Selected</option>
                </optgroup>
                <optgroup label="Control Flow">
                    <option value="state-branch">7. Branch (If/Else)</option>
                    <option value="state-parallel">8. Parallel Execution</option>
                    <option value="state-loop">9. Loop (While/Until)</option>
                </optgroup>
                <optgroup label="Panel Tabs">
                    <option value="state-tools-tab">10. Tools Tab</option>
                    <option value="state-inputs-tab">11. Inputs Tab</option>
                    <option value="state-config-tab">12. Config Tab</option>
                    <option value="state-connect-tab">13. Connect Tab</option>
                    <option value="state-test-tab">14. Test Tab</option>
                </optgroup>
                <optgroup label="Modals">
                    <option value="state-mapping-modal">15. Data Mapping Modal</option>
                    <option value="state-add-step">16. Add Step Wizard</option>
                </optgroup>
                <optgroup label="Test Execution">
                    <option value="state-test-running">17. Test Running</option>
                    <option value="state-test-passed">18. Test Passed</option>
                    <option value="state-test-failed">19. Test Failed</option>
                </optgroup>
                <optgroup label="Advanced">
                    <option value="state-code-view">20. Code View</option>
                </optgroup>
            </select>
            <div class="mt-2 text-xs text-gray-400">Flight C ‚Ä¢ Comprehensive Mockup</div>
        </div>
    </div>

    <!-- ============================================== -->
    <!-- STATE 1: EMPTY WORKFLOW                       -->
    <!-- ============================================== -->
    <section id="state-empty" class="state-section">
        <div class="h-screen flex flex-col bg-white">
            <!-- Top Bar -->
            <header class="h-14 border-b border-gray-200 bg-white flex items-center justify-between px-4 shrink-0">
                <div class="flex items-center gap-3">
                    <button class="text-gray-400 hover:text-gray-600 p-1.5 rounded hover:bg-gray-100">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                        </svg>
                    </button>
                    <input type="text" value="Untitled Workflow" class="text-base font-semibold text-gray-900 bg-transparent border-0 focus:outline-none focus:ring-2 focus:ring-blue-500 rounded px-1" />
                    <span class="px-2 py-0.5 bg-gray-100 text-gray-500 text-xs font-medium rounded">New</span>
                </div>
                <div class="flex items-center gap-3">
                    <!-- View Toggle -->
                    <div class="flex items-center bg-gray-100 rounded-lg p-0.5">
                        <button class="toggle-btn active px-3 py-1.5 text-xs font-medium rounded-md">List</button>
                        <button class="toggle-btn px-3 py-1.5 text-xs font-medium text-gray-500 rounded-md">Canvas</button>
                    </div>
                    <!-- Actions -->
                    <button class="px-4 py-1.5 text-sm font-medium text-gray-400 bg-gray-100 rounded-lg cursor-not-allowed">Save</button>
                    <button class="px-4 py-1.5 text-sm font-medium text-gray-400 bg-gray-100 rounded-lg cursor-not-allowed">Publish</button>
                </div>
            </header>
            
            <div class="flex-1 flex overflow-hidden">
                <!-- Left: Chat -->
                <aside class="w-64 border-r border-gray-200 bg-gray-50 flex flex-col shrink-0">
                    <div class="p-3 border-b border-gray-200 bg-white">
                        <div class="flex items-center gap-2">
                            <div class="w-7 h-7 bg-gradient-to-br from-violet-500 to-indigo-600 rounded-lg flex items-center justify-center">
                                <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"></path>
                                </svg>
                            </div>
                            <span class="text-sm font-medium text-gray-900">AI Assistant</span>
                        </div>
                    </div>
                    <div class="flex-1 p-4 flex flex-col items-center justify-center text-center">
                        <div class="w-12 h-12 bg-gradient-to-br from-violet-100 to-indigo-100 rounded-2xl flex items-center justify-center mb-3">
                            <svg class="w-6 h-6 text-indigo-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                            </svg>
                        </div>
                        <h3 class="font-medium text-gray-900 mb-1">Let's build something!</h3>
                        <p class="text-sm text-gray-500">Tell me what you want to automate and I'll help you create a workflow.</p>
                    </div>
                    <div class="p-3 border-t border-gray-200 bg-white">
                        <div class="flex items-center gap-2 bg-gray-50 rounded-lg border border-gray-200 p-2">
                            <input type="text" placeholder="Describe your workflow..." class="flex-1 bg-transparent text-sm focus:outline-none" />
                            <button class="text-gray-400 hover:text-indigo-600">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                </aside>
                
                <!-- Center: Empty State -->
                <main class="flex-1 bg-subtle flex items-center justify-center">
                    <div class="text-center max-w-md mx-auto px-8">
                        <div class="w-20 h-20 bg-white rounded-2xl shadow-sm border border-gray-200 flex items-center justify-center mx-auto mb-6">
                            <svg class="w-10 h-10 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"></path>
                            </svg>
                        </div>
                        <h2 class="text-xl font-semibold text-gray-900 mb-2">Start building your workflow</h2>
                        <p class="text-gray-500 mb-6">Add your first step from the tools palette, or describe what you want to build and let AI help you.</p>
                        <button class="inline-flex items-center gap-2 px-5 py-2.5 bg-indigo-600 text-white font-medium rounded-xl hover:bg-indigo-700 transition-colors">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                            </svg>
                            Add First Step
                        </button>
                    </div>
                </main>
                
                <!-- Right: Panels -->
                <aside class="w-80 border-l border-gray-200 bg-white flex flex-col shrink-0">
                    <div class="flex border-b border-gray-200 bg-gray-50 px-1 pt-1 gap-0.5">
                        <button class="panel-tab active px-3 py-2 text-xs font-medium rounded-t-lg border border-transparent -mb-px">Tools</button>
                        <button class="panel-tab px-3 py-2 text-xs font-medium text-gray-500 rounded-t-lg border border-transparent -mb-px">Inputs</button>
                        <button class="panel-tab px-3 py-2 text-xs font-medium text-gray-500 rounded-t-lg border border-transparent -mb-px">Config</button>
                        <button class="panel-tab px-3 py-2 text-xs font-medium text-gray-500 rounded-t-lg border border-transparent -mb-px">Connect</button>
                        <button class="panel-tab px-3 py-2 text-xs font-medium text-gray-500 rounded-t-lg border border-transparent -mb-px">Test</button>
                    </div>
                    <div class="flex-1 overflow-y-auto custom-scroll p-4">
                        <div class="mb-4">
                            <div class="relative">
                                <svg class="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                                </svg>
                                <input type="text" placeholder="Search tools..." class="w-full pl-10 pr-4 py-2 text-sm border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500" />
                            </div>
                        </div>
                        <p class="text-sm text-gray-500 text-center py-8">Select tools from your connected integrations to start building.</p>
                    </div>
                </aside>
            </div>
        </div>
    </section>

    <!-- ============================================== -->
    <!-- STATE 2: LIST VIEW - EDITING                  -->
    <!-- ============================================== -->
    <section id="state-list-editing" class="state-section active">
        <div class="h-screen flex flex-col bg-white">
            <!-- Top Bar -->
            <header class="h-14 border-b border-gray-200 bg-white flex items-center justify-between px-4 shrink-0">
                <div class="flex items-center gap-3">
                    <button class="text-gray-400 hover:text-gray-600 p-1.5 rounded hover:bg-gray-100">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                        </svg>
                    </button>
                    <input type="text" value="Job Application Workflow" class="text-base font-semibold text-gray-900 bg-transparent border-0 focus:outline-none focus:ring-2 focus:ring-blue-500 rounded px-1" />
                    <span class="px-2 py-0.5 bg-yellow-100 text-yellow-700 text-xs font-medium rounded">Draft</span>
                </div>
                <div class="flex items-center gap-3">
                    <!-- Abstraction Toggle -->
                    <div class="flex items-center bg-gray-100 rounded-lg p-0.5">
                        <button class="toggle-btn px-3 py-1.5 text-xs font-medium text-gray-500 rounded-md">Flow</button>
                        <button class="toggle-btn active px-3 py-1.5 text-xs font-medium rounded-md">Spec</button>
                        <button class="toggle-btn px-3 py-1.5 text-xs font-medium text-gray-500 rounded-md">Code</button>
                    </div>
                    <div class="w-px h-6 bg-gray-200"></div>
                    <!-- View Toggle -->
                    <div class="flex items-center bg-gray-100 rounded-lg p-0.5">
                        <button class="toggle-btn active px-3 py-1.5 text-xs font-medium rounded-md">List</button>
                        <button class="toggle-btn px-3 py-1.5 text-xs font-medium text-gray-500 rounded-md">Canvas</button>
                    </div>
                    <div class="w-px h-6 bg-gray-200"></div>
                    <!-- Actions -->
                    <button class="inline-flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        Test
                    </button>
                    <button class="px-4 py-1.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50">Save</button>
                    <button class="px-4 py-1.5 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700">Publish</button>
                </div>
            </header>
            
            <div class="flex-1 flex overflow-hidden">
                <!-- Left: Chat -->
                <aside class="w-64 border-r border-gray-200 bg-gray-50 flex flex-col shrink-0">
                    <div class="p-3 border-b border-gray-200 bg-white">
                        <div class="flex items-center gap-2">
                            <div class="w-7 h-7 bg-gradient-to-br from-violet-500 to-indigo-600 rounded-lg flex items-center justify-center">
                                <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"></path>
                                </svg>
                            </div>
                            <span class="text-sm font-medium text-gray-900">AI Assistant</span>
                        </div>
                    </div>
                    <div class="flex-1 p-3 custom-scroll overflow-y-auto">
                        <div class="space-y-3">
                            <div class="bg-white rounded-lg p-3 border border-gray-200 text-sm text-gray-700">
                                <p>Great workflow! You have 3 steps configured. Would you like me to help you test it?</p>
                            </div>
                            <div class="bg-indigo-50 rounded-lg p-3 border border-indigo-100 text-sm text-indigo-900 ml-4">
                                <p>Yes, run a test with a sample job URL</p>
                            </div>
                            <div class="bg-white rounded-lg p-3 border border-gray-200 text-sm text-gray-700">
                                <p>Running test now... Click the Test tab to see live progress.</p>
                            </div>
                        </div>
                    </div>
                    <div class="p-3 border-t border-gray-200 bg-white">
                        <div class="flex items-center gap-2 bg-gray-50 rounded-lg border border-gray-200 p-2">
                            <input type="text" placeholder="Ask for help..." class="flex-1 bg-transparent text-sm focus:outline-none" />
                            <button class="text-gray-400 hover:text-indigo-600">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                </aside>
                
                <!-- Center: List View -->
                <main class="flex-1 overflow-y-auto custom-scroll bg-subtle">
                    <div class="max-w-2xl mx-auto py-8 px-6">
                        <!-- Workflow Info -->
                        <div class="bg-white rounded-2xl border border-gray-200 shadow-sm p-5 mb-6">
                            <div class="flex items-start justify-between mb-4">
                                <div>
                                    <h2 class="text-lg font-semibold text-gray-900">Workflow Overview</h2>
                                    <p class="text-sm text-gray-500 mt-1">Scrapes a job listing and generates a tailored resume</p>
                                </div>
                                <button class="text-sm text-indigo-600 hover:text-indigo-700 font-medium">Edit</button>
                            </div>
                            <div class="flex flex-wrap items-center gap-3 pt-3 border-t border-gray-100">
                                <div class="flex items-center gap-2">
                                    <span class="text-xs text-gray-500 uppercase font-medium">Inputs:</span>
                                    <span class="px-2 py-0.5 bg-violet-100 text-violet-700 text-xs font-medium rounded">jobUrl</span>
                                    <span class="px-2 py-0.5 bg-violet-100 text-violet-700 text-xs font-medium rounded">baseResume</span>
                                </div>
                                <div class="flex items-center gap-2">
                                    <span class="text-xs text-gray-500 uppercase font-medium">Requires:</span>
                                    <span class="flex items-center gap-1 px-2 py-0.5 bg-emerald-100 text-emerald-700 text-xs font-medium rounded">
                                        <span class="w-1.5 h-1.5 bg-emerald-500 rounded-full"></span>
                                        Firecrawl
                                    </span>
                                    <span class="flex items-center gap-1 px-2 py-0.5 bg-emerald-100 text-emerald-700 text-xs font-medium rounded">
                                        <span class="w-1.5 h-1.5 bg-emerald-500 rounded-full"></span>
                                        OpenAI
                                    </span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Timeline -->
                        <div class="relative">
                            <!-- Timeline line -->
                            <div class="absolute left-8 top-12 bottom-20 w-0.5 bg-gradient-to-b from-indigo-400 to-indigo-200"></div>
                            
                            <!-- Step 1 -->
                            <div class="step-card relative flex gap-4 mb-4 cursor-pointer group">
                                <div class="w-16 flex-shrink-0 flex flex-col items-center">
                                    <div class="w-11 h-11 bg-gradient-to-br from-orange-400 to-red-500 rounded-xl flex items-center justify-center text-white text-lg shadow-sm z-10 group-hover:scale-105 transition-transform">
                                        üîç
                                    </div>
                                    <div class="text-xs text-gray-400 mt-1.5 font-medium">Step 1</div>
                                </div>
                                <div class="flex-1 bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden group-hover:border-indigo-300 group-hover:shadow-md transition-all">
                                    <div class="p-4">
                                        <div class="flex items-center justify-between mb-3">
                                            <div>
                                                <h3 class="font-semibold text-gray-900">Scrape Job Listing</h3>
                                                <p class="text-sm text-gray-500">firecrawl ‚Ä¢ FIRECRAWL_SCRAPE</p>
                                            </div>
                                            <div class="flex items-center gap-2">
                                                <span class="flex items-center gap-1 text-xs text-emerald-600 bg-emerald-50 px-2 py-0.5 rounded-full">
                                                    <span class="w-1.5 h-1.5 bg-emerald-500 rounded-full"></span>
                                                    Ready
                                                </span>
                                                <svg class="w-4 h-4 text-gray-400 group-hover:text-indigo-500 transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                                </svg>
                                            </div>
                                        </div>
                                        <!-- I/O Schema -->
                                        <div class="grid grid-cols-2 gap-3 text-xs">
                                            <div class="bg-gray-50 rounded-lg p-2.5">
                                                <div class="text-gray-400 uppercase text-[10px] font-semibold mb-1.5">Input</div>
                                                <div class="flex items-center gap-1.5 text-gray-600">
                                                    <span class="text-violet-500 font-mono">$</span>
                                                    <span>url</span>
                                                    <span class="text-gray-400 ml-auto font-mono">string</span>
                                                </div>
                                            </div>
                                            <div class="bg-gray-50 rounded-lg p-2.5">
                                                <div class="text-gray-400 uppercase text-[10px] font-semibold mb-1.5">Output</div>
                                                <div class="space-y-0.5">
                                                    <div class="flex items-center gap-1.5 text-gray-600">
                                                        <span>title</span>
                                                        <span class="text-gray-400 ml-auto font-mono">string</span>
                                                    </div>
                                                    <div class="flex items-center gap-1.5 text-gray-600">
                                                        <span>company</span>
                                                        <span class="text-gray-400 ml-auto font-mono">string</span>
                                                    </div>
                                                    <div class="flex items-center gap-1.5 text-gray-600">
                                                        <span>requirements</span>
                                                        <span class="text-gray-400 ml-auto font-mono">string[]</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Data Flow Indicator -->
                            <div class="relative flex gap-4 mb-4 ml-16 pl-4">
                                <button class="flex items-center gap-2 text-xs text-gray-400 hover:text-indigo-600 transition-colors">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3"></path>
                                    </svg>
                                    <span class="font-medium">3 fields mapped</span>
                                    <span class="text-gray-300">|</span>
                                    <span>title ‚Üí jobTitle, company ‚Üí companyName, requirements ‚Üí targetSkills</span>
                                </button>
                            </div>
                            
                            <!-- Step 2 -->
                            <div class="step-card relative flex gap-4 mb-4 cursor-pointer group">
                                <div class="w-16 flex-shrink-0 flex flex-col items-center">
                                    <div class="w-11 h-11 bg-gradient-to-br from-emerald-400 to-teal-500 rounded-xl flex items-center justify-center text-white text-lg shadow-sm z-10 group-hover:scale-105 transition-transform">
                                        üìù
                                    </div>
                                    <div class="text-xs text-gray-400 mt-1.5 font-medium">Step 2</div>
                                </div>
                                <div class="flex-1 bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden group-hover:border-indigo-300 group-hover:shadow-md transition-all">
                                    <div class="p-4">
                                        <div class="flex items-center justify-between mb-3">
                                            <div>
                                                <h3 class="font-semibold text-gray-900">Generate Tailored Resume</h3>
                                                <p class="text-sm text-gray-500">openai ‚Ä¢ GPT-4o</p>
                                            </div>
                                            <div class="flex items-center gap-2">
                                                <span class="flex items-center gap-1 text-xs text-emerald-600 bg-emerald-50 px-2 py-0.5 rounded-full">
                                                    <span class="w-1.5 h-1.5 bg-emerald-500 rounded-full"></span>
                                                    Ready
                                                </span>
                                                <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                                </svg>
                                            </div>
                                        </div>
                                        <div class="grid grid-cols-2 gap-3 text-xs">
                                            <div class="bg-gray-50 rounded-lg p-2.5">
                                                <div class="text-gray-400 uppercase text-[10px] font-semibold mb-1.5">Input</div>
                                                <div class="space-y-0.5">
                                                    <div class="flex items-center gap-1.5 text-gray-600">
                                                        <span class="text-indigo-500">‚Üê</span>
                                                        <span>jobTitle</span>
                                                        <span class="text-gray-400 ml-auto font-mono">string</span>
                                                    </div>
                                                    <div class="flex items-center gap-1.5 text-gray-600">
                                                        <span class="text-indigo-500">‚Üê</span>
                                                        <span>companyName</span>
                                                        <span class="text-gray-400 ml-auto font-mono">string</span>
                                                    </div>
                                                    <div class="flex items-center gap-1.5 text-gray-600">
                                                        <span class="text-indigo-500">‚Üê</span>
                                                        <span>targetSkills</span>
                                                        <span class="text-gray-400 ml-auto font-mono">string[]</span>
                                                    </div>
                                                    <div class="flex items-center gap-1.5 text-gray-600">
                                                        <span class="text-violet-500 font-mono">$</span>
                                                        <span>baseResume</span>
                                                        <span class="text-gray-400 ml-auto font-mono">string</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="bg-gray-50 rounded-lg p-2.5">
                                                <div class="text-gray-400 uppercase text-[10px] font-semibold mb-1.5">Output</div>
                                                <div class="flex items-center gap-1.5 text-gray-600">
                                                    <span>tailoredResume</span>
                                                    <span class="text-gray-400 ml-auto font-mono">string</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Data Flow Indicator -->
                            <div class="relative flex gap-4 mb-4 ml-16 pl-4">
                                <button class="flex items-center gap-2 text-xs text-gray-400 hover:text-indigo-600 transition-colors">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3"></path>
                                    </svg>
                                    <span class="font-medium">1 field mapped</span>
                                    <span class="text-gray-300">|</span>
                                    <span>tailoredResume ‚Üí body</span>
                                </button>
                            </div>
                            
                            <!-- Step 3 -->
                            <div class="step-card relative flex gap-4 mb-4 cursor-pointer group">
                                <div class="w-16 flex-shrink-0 flex flex-col items-center">
                                    <div class="w-11 h-11 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-xl flex items-center justify-center text-white text-lg shadow-sm z-10 group-hover:scale-105 transition-transform">
                                        ‚úâÔ∏è
                                    </div>
                                    <div class="text-xs text-gray-400 mt-1.5 font-medium">Step 3</div>
                                </div>
                                <div class="flex-1 bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden group-hover:border-indigo-300 group-hover:shadow-md transition-all">
                                    <div class="p-4">
                                        <div class="flex items-center justify-between mb-3">
                                            <div>
                                                <h3 class="font-semibold text-gray-900">Send Email</h3>
                                                <p class="text-sm text-gray-500">gmail ‚Ä¢ GMAIL_SEND_EMAIL</p>
                                            </div>
                                            <div class="flex items-center gap-2">
                                                <span class="flex items-center gap-1 text-xs text-amber-600 bg-amber-50 px-2 py-0.5 rounded-full">
                                                    <span class="w-1.5 h-1.5 bg-amber-500 rounded-full"></span>
                                                    Needs config
                                                </span>
                                                <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                                </svg>
                                            </div>
                                        </div>
                                        <div class="grid grid-cols-2 gap-3 text-xs">
                                            <div class="bg-gray-50 rounded-lg p-2.5">
                                                <div class="text-gray-400 uppercase text-[10px] font-semibold mb-1.5">Input</div>
                                                <div class="space-y-0.5">
                                                    <div class="flex items-center gap-1.5 text-gray-600">
                                                        <span class="text-amber-500 font-mono">‚öô</span>
                                                        <span>to</span>
                                                        <span class="text-gray-400 ml-auto font-mono">string</span>
                                                    </div>
                                                    <div class="flex items-center gap-1.5 text-gray-600">
                                                        <span class="text-amber-500 font-mono">‚öô</span>
                                                        <span>subject</span>
                                                        <span class="text-gray-400 ml-auto font-mono">string</span>
                                                    </div>
                                                    <div class="flex items-center gap-1.5 text-gray-600">
                                                        <span class="text-indigo-500">‚Üê</span>
                                                        <span>body</span>
                                                        <span class="text-gray-400 ml-auto font-mono">string</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="bg-gray-50 rounded-lg p-2.5">
                                                <div class="text-gray-400 uppercase text-[10px] font-semibold mb-1.5">Output</div>
                                                <div class="text-gray-400 italic">(terminal node)</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Add Step Button -->
                            <div class="relative flex gap-4">
                                <div class="w-16 flex-shrink-0 flex flex-col items-center">
                                    <button class="w-11 h-11 bg-gray-100 rounded-xl flex items-center justify-center text-gray-400 border-2 border-dashed border-gray-300 z-10 hover:border-indigo-400 hover:text-indigo-500 hover:bg-indigo-50 transition-all cursor-pointer">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                                        </svg>
                                    </button>
                                </div>
                                <div class="flex-1 p-4">
                                    <p class="text-sm text-gray-400">Click to add another step</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </main>
                
                <!-- Right: Panels -->
                <aside class="w-80 border-l border-gray-200 bg-white flex flex-col shrink-0">
                    <div class="flex border-b border-gray-200 bg-gray-50 px-1 pt-1 gap-0.5">
                        <button class="panel-tab active px-3 py-2 text-xs font-medium rounded-t-lg border border-transparent -mb-px">Tools</button>
                        <button class="panel-tab px-3 py-2 text-xs font-medium text-gray-500 rounded-t-lg border border-transparent -mb-px">Inputs</button>
                        <button class="panel-tab px-3 py-2 text-xs font-medium text-gray-500 rounded-t-lg border border-transparent -mb-px">Config</button>
                        <button class="panel-tab px-3 py-2 text-xs font-medium text-gray-500 rounded-t-lg border border-transparent -mb-px">Connect</button>
                        <button class="panel-tab px-3 py-2 text-xs font-medium text-gray-500 rounded-t-lg border border-transparent -mb-px">Test</button>
                    </div>
                    <div class="flex-1 overflow-y-auto custom-scroll p-3">
                        <!-- Search -->
                        <div class="mb-3">
                            <div class="relative">
                                <svg class="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                                </svg>
                                <input type="text" placeholder="Search tools..." class="w-full pl-10 pr-4 py-2 text-sm border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500" />
                            </div>
                        </div>
                        <!-- Tool Groups -->
                        <div class="space-y-4">
                            <!-- Firecrawl -->
                            <div>
                                <div class="flex items-center gap-2 mb-2">
                                    <span>üî•</span>
                                    <span class="text-xs font-semibold text-gray-700 uppercase tracking-wider">Firecrawl</span>
                                    <span class="text-xs text-gray-400">(3)</span>
                                </div>
                                <div class="space-y-1">
                                    <button class="w-full flex items-center gap-2 p-2 text-sm text-left bg-indigo-50 border border-indigo-200 rounded-lg">
                                        <span>üîç</span><span class="font-medium text-indigo-700">Scrape Page</span>
                                    </button>
                                    <button class="w-full flex items-center gap-2 p-2 text-sm text-left hover:bg-gray-50 rounded-lg">
                                        <span>üó∫Ô∏è</span><span>Crawl Site</span>
                                    </button>
                                    <button class="w-full flex items-center gap-2 p-2 text-sm text-left hover:bg-gray-50 rounded-lg">
                                        <span>üìä</span><span>Extract Data</span>
                                    </button>
                                </div>
                            </div>
                            <!-- OpenAI -->
                            <div>
                                <div class="flex items-center gap-2 mb-2">
                                    <span>ü§ñ</span>
                                    <span class="text-xs font-semibold text-gray-700 uppercase tracking-wider">OpenAI</span>
                                    <span class="text-xs text-gray-400">(4)</span>
                                </div>
                                <div class="space-y-1">
                                    <button class="w-full flex items-center gap-2 p-2 text-sm text-left hover:bg-gray-50 rounded-lg">
                                        <span>üí¨</span><span>Chat Completion</span>
                                    </button>
                                    <button class="w-full flex items-center gap-2 p-2 text-sm text-left hover:bg-gray-50 rounded-lg">
                                        <span>üìù</span><span>Generate Text</span>
                                    </button>
                                </div>
                            </div>
                            <!-- Gmail -->
                            <div>
                                <div class="flex items-center gap-2 mb-2">
                                    <span>üìß</span>
                                    <span class="text-xs font-semibold text-gray-700 uppercase tracking-wider">Gmail</span>
                                    <span class="text-xs text-gray-400">(3)</span>
                                </div>
                                <div class="space-y-1">
                                    <button class="w-full flex items-center gap-2 p-2 text-sm text-left hover:bg-gray-50 rounded-lg">
                                        <span>üì§</span><span>Send Email</span>
                                    </button>
                                    <button class="w-full flex items-center gap-2 p-2 text-sm text-left hover:bg-gray-50 rounded-lg">
                                        <span>üì•</span><span>Read Email</span>
                                    </button>
                                </div>
                            </div>
                            <!-- Control Flow -->
                            <div>
                                <div class="flex items-center gap-2 mb-2">
                                    <span>‚ö°</span>
                                    <span class="text-xs font-semibold text-gray-700 uppercase tracking-wider">Control Flow</span>
                                </div>
                                <div class="space-y-1">
                                    <button class="w-full flex items-center gap-2 p-2 text-sm text-left hover:bg-gray-50 rounded-lg">
                                        <span>üîÄ</span><span>Branch (If/Else)</span>
                                    </button>
                                    <button class="w-full flex items-center gap-2 p-2 text-sm text-left hover:bg-gray-50 rounded-lg">
                                        <span>‚è∏Ô∏è</span><span>Parallel</span>
                                    </button>
                                    <button class="w-full flex items-center gap-2 p-2 text-sm text-left hover:bg-gray-50 rounded-lg">
                                        <span>üîÅ</span><span>Loop</span>
                                    </button>
                                </div>
                            </div>
                            <!-- Custom Code -->
                            <div>
                                <div class="flex items-center gap-2 mb-2">
                                    <span>üíª</span>
                                    <span class="text-xs font-semibold text-gray-700 uppercase tracking-wider">Custom</span>
                                </div>
                                <div class="space-y-1">
                                    <button class="w-full flex items-center gap-2 p-2 text-sm text-left hover:bg-gray-50 rounded-lg">
                                        <span>üìú</span><span>Code Block</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </aside>
            </div>
        </div>
    </section>

    <!-- ============================================== -->
    <!-- STATE 3: LIST VIEW - FLOW MODE                -->
    <!-- ============================================== -->
    <section id="state-list-flow" class="state-section">
        <div class="h-screen flex flex-col bg-white">
            <!-- Top Bar -->
            <header class="h-14 border-b border-gray-200 bg-white flex items-center justify-between px-4 shrink-0">
                <div class="flex items-center gap-3">
                    <button class="text-gray-400 hover:text-gray-600 p-1.5 rounded hover:bg-gray-100">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                        </svg>
                    </button>
                    <span class="text-base font-semibold text-gray-900">Job Application Workflow</span>
                    <span class="px-2 py-0.5 bg-yellow-100 text-yellow-700 text-xs font-medium rounded">Draft</span>
                </div>
                <div class="flex items-center gap-3">
                    <div class="flex items-center bg-gray-100 rounded-lg p-0.5">
                        <button class="toggle-btn active px-3 py-1.5 text-xs font-medium rounded-md">Flow</button>
                        <button class="toggle-btn px-3 py-1.5 text-xs font-medium text-gray-500 rounded-md">Spec</button>
                        <button class="toggle-btn px-3 py-1.5 text-xs font-medium text-gray-500 rounded-md">Code</button>
                    </div>
                    <div class="w-px h-6 bg-gray-200"></div>
                    <div class="flex items-center bg-gray-100 rounded-lg p-0.5">
                        <button class="toggle-btn active px-3 py-1.5 text-xs font-medium rounded-md">List</button>
                        <button class="toggle-btn px-3 py-1.5 text-xs font-medium text-gray-500 rounded-md">Canvas</button>
                    </div>
                    <div class="w-px h-6 bg-gray-200"></div>
                    <button class="px-4 py-1.5 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700">Test</button>
                </div>
            </header>
            
            <div class="flex-1 flex overflow-hidden">
                <!-- Center: Simplified Flow View -->
                <main class="flex-1 overflow-y-auto custom-scroll bg-subtle flex items-center justify-center">
                    <div class="max-w-lg mx-auto py-12 px-6">
                        <h2 class="text-center text-xl font-bold text-gray-900 mb-8">Job Application Workflow</h2>
                        
                        <!-- Simplified Flow -->
                        <div class="space-y-4">
                            <!-- Step 1 -->
                            <div class="flex items-center gap-4">
                                <div class="w-14 h-14 bg-gradient-to-br from-orange-400 to-red-500 rounded-2xl flex items-center justify-center text-white text-2xl shadow-lg">
                                    üîç
                                </div>
                                <div>
                                    <h3 class="font-semibold text-gray-900 text-lg">Scrape Job Listing</h3>
                                    <p class="text-gray-500">Get job details from URL</p>
                                </div>
                            </div>
                            
                            <!-- Arrow -->
                            <div class="flex justify-center">
                                <svg class="w-6 h-12 text-indigo-300" fill="none" stroke="currentColor" viewBox="0 0 24 48">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v36m0 0l-6-6m6 6l6-6"></path>
                                </svg>
                            </div>
                            
                            <!-- Step 2 -->
                            <div class="flex items-center gap-4">
                                <div class="w-14 h-14 bg-gradient-to-br from-emerald-400 to-teal-500 rounded-2xl flex items-center justify-center text-white text-2xl shadow-lg">
                                    üìù
                                </div>
                                <div>
                                    <h3 class="font-semibold text-gray-900 text-lg">Generate Resume</h3>
                                    <p class="text-gray-500">Tailor resume for the job</p>
                                </div>
                            </div>
                            
                            <!-- Arrow -->
                            <div class="flex justify-center">
                                <svg class="w-6 h-12 text-indigo-300" fill="none" stroke="currentColor" viewBox="0 0 24 48">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v36m0 0l-6-6m6 6l6-6"></path>
                                </svg>
                            </div>
                            
                            <!-- Step 3 -->
                            <div class="flex items-center gap-4">
                                <div class="w-14 h-14 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-2xl flex items-center justify-center text-white text-2xl shadow-lg">
                                    ‚úâÔ∏è
                                </div>
                                <div>
                                    <h3 class="font-semibold text-gray-900 text-lg">Send Email</h3>
                                    <p class="text-gray-500">Email the tailored resume</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-8 text-center">
                            <p class="text-sm text-gray-400">Flow Mode - Click "Spec" for details</p>
                        </div>
                    </div>
                </main>
            </div>
        </div>
    </section>

    <!-- ============================================== -->
    <!-- STATE 4: CANVAS VIEW - EDITING                -->
    <!-- ============================================== -->
    <section id="state-canvas-editing" class="state-section">
        <div class="h-screen flex flex-col bg-white">
            <!-- Top Bar -->
            <header class="h-14 border-b border-gray-200 bg-white flex items-center justify-between px-4 shrink-0">
                <div class="flex items-center gap-3">
                    <button class="text-gray-400 hover:text-gray-600 p-1.5 rounded hover:bg-gray-100">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                        </svg>
                    </button>
                    <span class="text-base font-semibold text-gray-900">Job Application Workflow</span>
                    <span class="px-2 py-0.5 bg-yellow-100 text-yellow-700 text-xs font-medium rounded">Draft</span>
                </div>
                <div class="flex items-center gap-3">
                    <div class="flex items-center bg-gray-100 rounded-lg p-0.5">
                        <button class="toggle-btn px-3 py-1.5 text-xs font-medium text-gray-500 rounded-md">Flow</button>
                        <button class="toggle-btn active px-3 py-1.5 text-xs font-medium rounded-md">Spec</button>
                        <button class="toggle-btn px-3 py-1.5 text-xs font-medium text-gray-500 rounded-md">Code</button>
                    </div>
                    <div class="w-px h-6 bg-gray-200"></div>
                    <div class="flex items-center bg-gray-100 rounded-lg p-0.5">
                        <button class="toggle-btn px-3 py-1.5 text-xs font-medium text-gray-500 rounded-md">List</button>
                        <button class="toggle-btn active px-3 py-1.5 text-xs font-medium rounded-md">Canvas</button>
                    </div>
                    <div class="w-px h-6 bg-gray-200"></div>
                    <button class="inline-flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50">Test</button>
                    <button class="px-4 py-1.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50">Save</button>
                    <button class="px-4 py-1.5 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700">Publish</button>
                </div>
            </header>
            
            <div class="flex-1 flex overflow-hidden">
                <!-- Left: Chat (collapsed indicator) -->
                <button class="w-12 border-r border-gray-200 bg-gray-50 flex flex-col items-center pt-4 hover:bg-gray-100 transition-colors">
                    <div class="w-8 h-8 bg-gradient-to-br from-violet-500 to-indigo-600 rounded-lg flex items-center justify-center">
                        <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"></path>
                        </svg>
                    </div>
                    <svg class="w-4 h-4 text-gray-400 mt-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                    </svg>
                </button>
                
                <!-- Center: Canvas -->
                <main class="flex-1 canvas-grid relative overflow-hidden">
                    <!-- SVG Edges -->
                    <svg class="absolute inset-0 w-full h-full pointer-events-none" style="z-index: 0;">
                        <!-- Edge 1: Scrape ‚Üí Generate -->
                        <path d="M 316 180 C 380 180, 400 180, 464 180" class="edge-line" />
                        <g transform="translate(390, 170)">
                            <rect x="-22" y="-8" width="44" height="16" rx="4" fill="white" stroke="#3b82f6" stroke-width="1" />
                            <text x="0" y="4" text-anchor="middle" font-size="10" fill="#3b82f6">3 fields</text>
                        </g>
                        
                        <!-- Edge 2: Generate ‚Üí Send -->
                        <path d="M 716 180 C 780 180, 800 180, 864 180" class="edge-line" />
                        <g transform="translate(790, 170)">
                            <rect x="-20" y="-8" width="40" height="16" rx="4" fill="white" stroke="#3b82f6" stroke-width="1" />
                            <text x="0" y="4" text-anchor="middle" font-size="10" fill="#3b82f6">1 field</text>
                        </g>
                    </svg>
                    
                    <!-- Node 1: Scrape -->
                    <div class="absolute bg-white rounded-xl border border-gray-200 shadow-sm w-56" style="left: 60px; top: 100px; z-index: 1;">
                        <div class="handle handle-right"></div>
                        <div class="p-3 border-b bg-gradient-to-r from-orange-50 to-red-50 rounded-t-xl">
                            <div class="flex items-center gap-2">
                                <span class="text-lg">üîç</span>
                                <div class="flex-1 min-w-0">
                                    <div class="font-medium text-sm truncate">Scrape Job Listing</div>
                                    <div class="text-xs text-gray-500">firecrawl</div>
                                </div>
                            </div>
                        </div>
                        <div class="p-3 text-xs space-y-2">
                            <div>
                                <div class="text-gray-400 uppercase text-[10px] font-medium mb-1">Input</div>
                                <div class="flex items-center gap-1 text-gray-600">
                                    <span class="text-violet-500">$</span>
                                    <span>url</span>
                                    <span class="text-gray-400 ml-auto">string</span>
                                </div>
                            </div>
                            <div class="border-t border-gray-100 pt-2">
                                <div class="text-gray-400 uppercase text-[10px] font-medium mb-1">Output</div>
                                <div class="space-y-0.5">
                                    <div class="flex items-center gap-1 text-gray-600">
                                        <span>title</span>
                                        <span class="text-gray-400 ml-auto">string</span>
                                    </div>
                                    <div class="flex items-center gap-1 text-gray-600">
                                        <span>company</span>
                                        <span class="text-gray-400 ml-auto">string</span>
                                    </div>
                                    <div class="flex items-center gap-1 text-gray-600">
                                        <span>requirements</span>
                                        <span class="text-gray-400 ml-auto">string[]</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="p-2 border-t bg-gray-50 rounded-b-xl">
                            <div class="flex items-center gap-1.5 text-xs text-emerald-600">
                                <span class="w-1.5 h-1.5 bg-emerald-500 rounded-full"></span>
                                Ready
                            </div>
                        </div>
                    </div>
                    
                    <!-- Node 2: Generate -->
                    <div class="absolute bg-white rounded-xl border border-gray-200 shadow-sm w-56" style="left: 460px; top: 100px; z-index: 1;">
                        <div class="handle handle-left"></div>
                        <div class="handle handle-right"></div>
                        <div class="p-3 border-b bg-gradient-to-r from-emerald-50 to-teal-50 rounded-t-xl">
                            <div class="flex items-center gap-2">
                                <span class="text-lg">üìù</span>
                                <div class="flex-1 min-w-0">
                                    <div class="font-medium text-sm truncate">Generate Resume</div>
                                    <div class="text-xs text-gray-500">openai</div>
                                </div>
                            </div>
                        </div>
                        <div class="p-3 text-xs space-y-2">
                            <div>
                                <div class="text-gray-400 uppercase text-[10px] font-medium mb-1">Input</div>
                                <div class="space-y-0.5">
                                    <div class="flex items-center gap-1 text-gray-600">
                                        <span class="text-indigo-500">‚Üê</span>
                                        <span>jobTitle</span>
                                        <span class="text-gray-400 ml-auto">string</span>
                                    </div>
                                    <div class="flex items-center gap-1 text-gray-600">
                                        <span class="text-indigo-500">‚Üê</span>
                                        <span>companyName</span>
                                        <span class="text-gray-400 ml-auto">string</span>
                                    </div>
                                    <div class="flex items-center gap-1 text-gray-600">
                                        <span class="text-indigo-500">‚Üê</span>
                                        <span>targetSkills</span>
                                        <span class="text-gray-400 ml-auto">string[]</span>
                                    </div>
                                    <div class="flex items-center gap-1 text-gray-600">
                                        <span class="text-violet-500">$</span>
                                        <span>baseResume</span>
                                        <span class="text-gray-400 ml-auto">string</span>
                                    </div>
                                </div>
                            </div>
                            <div class="border-t border-gray-100 pt-2">
                                <div class="text-gray-400 uppercase text-[10px] font-medium mb-1">Output</div>
                                <div class="flex items-center gap-1 text-gray-600">
                                    <span>tailoredResume</span>
                                    <span class="text-gray-400 ml-auto">string</span>
                                </div>
                            </div>
                        </div>
                        <div class="p-2 border-t bg-gray-50 rounded-b-xl">
                            <div class="flex items-center gap-1.5 text-xs text-emerald-600">
                                <span class="w-1.5 h-1.5 bg-emerald-500 rounded-full"></span>
                                Ready
                            </div>
                        </div>
                    </div>
                    
                    <!-- Node 3: Send Email -->
                    <div class="absolute bg-white rounded-xl border border-gray-200 shadow-sm w-56" style="left: 860px; top: 100px; z-index: 1;">
                        <div class="handle handle-left"></div>
                        <div class="p-3 border-b bg-gradient-to-r from-blue-50 to-indigo-50 rounded-t-xl">
                            <div class="flex items-center gap-2">
                                <span class="text-lg">‚úâÔ∏è</span>
                                <div class="flex-1 min-w-0">
                                    <div class="font-medium text-sm truncate">Send Email</div>
                                    <div class="text-xs text-gray-500">gmail</div>
                                </div>
                            </div>
                        </div>
                        <div class="p-3 text-xs space-y-2">
                            <div>
                                <div class="text-gray-400 uppercase text-[10px] font-medium mb-1">Input</div>
                                <div class="space-y-0.5">
                                    <div class="flex items-center gap-1 text-gray-600">
                                        <span class="text-amber-500">‚öô</span>
                                        <span>to</span>
                                        <span class="text-gray-400 ml-auto">string</span>
                                    </div>
                                    <div class="flex items-center gap-1 text-gray-600">
                                        <span class="text-amber-500">‚öô</span>
                                        <span>subject</span>
                                        <span class="text-gray-400 ml-auto">string</span>
                                    </div>
                                    <div class="flex items-center gap-1 text-gray-600">
                                        <span class="text-indigo-500">‚Üê</span>
                                        <span>body</span>
                                        <span class="text-gray-400 ml-auto">string</span>
                                    </div>
                                </div>
                            </div>
                            <div class="border-t border-gray-100 pt-2">
                                <div class="text-gray-400 uppercase text-[10px] font-medium mb-1">Output</div>
                                <div class="text-gray-400 italic">(terminal)</div>
                            </div>
                        </div>
                        <div class="p-2 border-t bg-gray-50 rounded-b-xl">
                            <div class="flex items-center gap-1.5 text-xs text-amber-600">
                                <span class="w-1.5 h-1.5 bg-amber-500 rounded-full"></span>
                                Needs config
                            </div>
                        </div>
                    </div>
                    
                    <!-- Canvas Controls -->
                    <div class="absolute bottom-4 left-4 flex items-center gap-2">
                        <div class="bg-white rounded-lg border border-gray-200 shadow-sm flex items-center">
                            <button class="p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-50 rounded-l-lg">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H4"></path>
                                </svg>
                            </button>
                            <span class="px-3 text-xs text-gray-600 border-x border-gray-200">100%</span>
                            <button class="p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-50 rounded-r-lg">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                                </svg>
                            </button>
                        </div>
                        <button class="p-2 bg-white rounded-lg border border-gray-200 shadow-sm text-gray-500 hover:text-gray-700 hover:bg-gray-50">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"></path>
                            </svg>
                        </button>
                    </div>
                </main>
                
                <!-- Right: Panels -->
                <aside class="w-80 border-l border-gray-200 bg-white flex flex-col shrink-0">
                    <div class="flex border-b border-gray-200 bg-gray-50 px-1 pt-1 gap-0.5">
                        <button class="panel-tab active px-3 py-2 text-xs font-medium rounded-t-lg border border-transparent -mb-px">Tools</button>
                        <button class="panel-tab px-3 py-2 text-xs font-medium text-gray-500 rounded-t-lg border border-transparent -mb-px">Inputs</button>
                        <button class="panel-tab px-3 py-2 text-xs font-medium text-gray-500 rounded-t-lg border border-transparent -mb-px">Config</button>
                        <button class="panel-tab px-3 py-2 text-xs font-medium text-gray-500 rounded-t-lg border border-transparent -mb-px">Connect</button>
                        <button class="panel-tab px-3 py-2 text-xs font-medium text-gray-500 rounded-t-lg border border-transparent -mb-px">Test</button>
                    </div>
                    <div class="flex-1 overflow-y-auto custom-scroll p-3">
                        <p class="text-sm text-gray-500 text-center py-4">Drag tools onto the canvas to add steps.</p>
                    </div>
                </aside>
            </div>
        </div>
    </section>

    <!-- ============================================== -->
    <!-- STATE 5: CANVAS VIEW - FLOW MODE              -->
    <!-- ============================================== -->
    <section id="state-canvas-flow" class="state-section">
        <div class="h-screen flex flex-col bg-white">
            <header class="h-14 border-b border-gray-200 bg-white flex items-center justify-between px-4 shrink-0">
                <div class="flex items-center gap-3">
                    <button class="text-gray-400 hover:text-gray-600 p-1.5 rounded hover:bg-gray-100">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                        </svg>
                    </button>
                    <span class="text-base font-semibold text-gray-900">Job Application Workflow</span>
                    <span class="px-2 py-0.5 bg-emerald-100 text-emerald-700 text-xs font-medium rounded">Published</span>
                </div>
                <div class="flex items-center gap-3">
                    <div class="flex items-center bg-gray-100 rounded-lg p-0.5">
                        <button class="toggle-btn active px-3 py-1.5 text-xs font-medium rounded-md">Flow</button>
                        <button class="toggle-btn px-3 py-1.5 text-xs font-medium text-gray-500 rounded-md">Spec</button>
                        <button class="toggle-btn px-3 py-1.5 text-xs font-medium text-gray-500 rounded-md">Code</button>
                    </div>
                    <div class="w-px h-6 bg-gray-200"></div>
                    <div class="flex items-center bg-gray-100 rounded-lg p-0.5">
                        <button class="toggle-btn px-3 py-1.5 text-xs font-medium text-gray-500 rounded-md">List</button>
                        <button class="toggle-btn active px-3 py-1.5 text-xs font-medium rounded-md">Canvas</button>
                    </div>
                </div>
            </header>
            
            <div class="flex-1 flex overflow-hidden">
                <main class="flex-1 canvas-grid relative overflow-hidden">
                    <!-- Simplified SVG Edges -->
                    <svg class="absolute inset-0 w-full h-full pointer-events-none" style="z-index: 0;">
                        <path d="M 200 200 L 400 200" class="edge-line" stroke-width="3" />
                        <path d="M 520 200 L 720 200" class="edge-line" stroke-width="3" />
                    </svg>
                    
                    <!-- Simplified Node 1 -->
                    <div class="absolute bg-white rounded-2xl border-2 border-gray-200 shadow-lg p-6 text-center" style="left: 80px; top: 150px; z-index: 1;">
                        <div class="w-16 h-16 bg-gradient-to-br from-orange-400 to-red-500 rounded-2xl flex items-center justify-center text-white text-3xl shadow-md mx-auto mb-3">
                            üîç
                        </div>
                        <h3 class="font-semibold text-gray-900">Scrape Job</h3>
                    </div>
                    
                    <!-- Simplified Node 2 -->
                    <div class="absolute bg-white rounded-2xl border-2 border-gray-200 shadow-lg p-6 text-center" style="left: 400px; top: 150px; z-index: 1;">
                        <div class="w-16 h-16 bg-gradient-to-br from-emerald-400 to-teal-500 rounded-2xl flex items-center justify-center text-white text-3xl shadow-md mx-auto mb-3">
                            üìù
                        </div>
                        <h3 class="font-semibold text-gray-900">Generate Resume</h3>
                    </div>
                    
                    <!-- Simplified Node 3 -->
                    <div class="absolute bg-white rounded-2xl border-2 border-gray-200 shadow-lg p-6 text-center" style="left: 720px; top: 150px; z-index: 1;">
                        <div class="w-16 h-16 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-2xl flex items-center justify-center text-white text-3xl shadow-md mx-auto mb-3">
                            ‚úâÔ∏è
                        </div>
                        <h3 class="font-semibold text-gray-900">Send Email</h3>
                    </div>
                    
                    <div class="absolute bottom-4 left-4 text-sm text-gray-400">
                        Flow Mode - Simplified view
                    </div>
                </main>
            </div>
        </div>
    </section>

    <!-- ============================================== -->
    <!-- STATE 6: NODE SELECTED                        -->
    <!-- ============================================== -->
    <section id="state-node-selected" class="state-section">
        <div class="h-screen flex flex-col bg-white">
            <header class="h-14 border-b border-gray-200 bg-white flex items-center justify-between px-4 shrink-0">
                <div class="flex items-center gap-3">
                    <button class="text-gray-400 hover:text-gray-600 p-1.5 rounded hover:bg-gray-100">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                        </svg>
                    </button>
                    <span class="text-base font-semibold text-gray-900">Job Application Workflow</span>
                </div>
                <div class="flex items-center gap-3">
                    <div class="flex items-center bg-gray-100 rounded-lg p-0.5">
                        <button class="toggle-btn px-3 py-1.5 text-xs font-medium text-gray-500 rounded-md">List</button>
                        <button class="toggle-btn active px-3 py-1.5 text-xs font-medium rounded-md">Canvas</button>
                    </div>
                    <button class="px-4 py-1.5 text-sm font-medium text-white bg-indigo-600 rounded-lg">Save</button>
                </div>
            </header>
            
            <div class="flex-1 flex overflow-hidden">
                <!-- Canvas -->
                <main class="flex-1 canvas-grid relative overflow-hidden">
                    <svg class="absolute inset-0 w-full h-full pointer-events-none" style="z-index: 0;">
                        <path d="M 316 180 C 380 180, 400 180, 464 180" class="edge-line" />
                    </svg>
                    
                    <!-- Node 1: Not selected -->
                    <div class="absolute bg-white rounded-xl border border-gray-200 shadow-sm w-56" style="left: 60px; top: 100px; z-index: 1;">
                        <div class="handle handle-right"></div>
                        <div class="p-3 border-b bg-gradient-to-r from-orange-50 to-red-50 rounded-t-xl">
                            <div class="flex items-center gap-2">
                                <span class="text-lg">üîç</span>
                                <div class="font-medium text-sm">Scrape Job Listing</div>
                            </div>
                        </div>
                        <div class="p-2 border-t bg-gray-50 rounded-b-xl">
                            <div class="flex items-center gap-1.5 text-xs text-emerald-600">
                                <span class="w-1.5 h-1.5 bg-emerald-500 rounded-full"></span>
                                Ready
                            </div>
                        </div>
                    </div>
                    
                    <!-- Node 2: SELECTED -->
                    <div class="absolute bg-white rounded-xl border-2 border-indigo-500 shadow-lg w-56 ring-4 ring-indigo-100" style="left: 460px; top: 100px; z-index: 2;">
                        <div class="handle handle-left" style="border-color: #6366f1;"></div>
                        <div class="handle handle-right" style="border-color: #6366f1;"></div>
                        <div class="p-3 border-b bg-indigo-50 rounded-t-xl">
                            <div class="flex items-center gap-2">
                                <span class="text-lg">üìù</span>
                                <div class="flex-1">
                                    <div class="font-medium text-sm">Generate Resume</div>
                                    <div class="text-xs text-indigo-600">Selected</div>
                                </div>
                            </div>
                        </div>
                        <div class="p-2 border-t bg-gray-50 rounded-b-xl">
                            <div class="flex items-center gap-1.5 text-xs text-emerald-600">
                                <span class="w-1.5 h-1.5 bg-emerald-500 rounded-full"></span>
                                Ready
                            </div>
                        </div>
                    </div>
                </main>
                
                <!-- Right: Node Inspector -->
                <aside class="w-96 border-l border-gray-200 bg-white flex flex-col shrink-0">
                    <div class="p-4 border-b border-gray-200 bg-indigo-50">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-3">
                                <span class="text-2xl">üìù</span>
                                <div>
                                    <h3 class="font-semibold text-gray-900">Generate Resume</h3>
                                    <p class="text-sm text-gray-500">openai ‚Ä¢ GPT-4o</p>
                                </div>
                            </div>
                            <button class="text-gray-400 hover:text-gray-600">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <div class="flex-1 overflow-y-auto custom-scroll p-4 space-y-4">
                        <!-- Input Schema -->
                        <div>
                            <h4 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2">Input Schema</h4>
                            <div class="bg-gray-50 rounded-lg p-3 space-y-2">
                                <div class="flex items-center justify-between text-sm">
                                    <div class="flex items-center gap-2">
                                        <span class="text-indigo-500">‚Üê</span>
                                        <span class="font-medium">jobTitle</span>
                                    </div>
                                    <span class="text-gray-400 font-mono text-xs">string</span>
                                </div>
                                <div class="text-xs text-gray-500 pl-5">From: Step 1 ‚Üí title</div>
                                
                                <div class="flex items-center justify-between text-sm pt-2 border-t border-gray-200">
                                    <div class="flex items-center gap-2">
                                        <span class="text-indigo-500">‚Üê</span>
                                        <span class="font-medium">companyName</span>
                                    </div>
                                    <span class="text-gray-400 font-mono text-xs">string</span>
                                </div>
                                <div class="text-xs text-gray-500 pl-5">From: Step 1 ‚Üí company</div>
                                
                                <div class="flex items-center justify-between text-sm pt-2 border-t border-gray-200">
                                    <div class="flex items-center gap-2">
                                        <span class="text-indigo-500">‚Üê</span>
                                        <span class="font-medium">targetSkills</span>
                                    </div>
                                    <span class="text-gray-400 font-mono text-xs">string[]</span>
                                </div>
                                <div class="text-xs text-gray-500 pl-5">From: Step 1 ‚Üí requirements</div>
                                
                                <div class="flex items-center justify-between text-sm pt-2 border-t border-gray-200">
                                    <div class="flex items-center gap-2">
                                        <span class="text-violet-500">$</span>
                                        <span class="font-medium">baseResume</span>
                                    </div>
                                    <span class="text-gray-400 font-mono text-xs">string</span>
                                </div>
                                <div class="text-xs text-gray-500 pl-5">Runtime Input</div>
                            </div>
                        </div>
                        
                        <!-- Output Schema -->
                        <div>
                            <h4 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2">Output Schema</h4>
                            <div class="bg-gray-50 rounded-lg p-3">
                                <div class="flex items-center justify-between text-sm">
                                    <span class="font-medium">tailoredResume</span>
                                    <span class="text-gray-400 font-mono text-xs">string</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Actions -->
                        <div class="pt-4 border-t border-gray-200 space-y-2">
                            <button class="w-full p-2 text-sm font-medium text-indigo-600 bg-indigo-50 rounded-lg hover:bg-indigo-100 transition-colors">
                                Edit Input Mapping
                            </button>
                            <button class="w-full p-2 text-sm font-medium text-gray-600 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors">
                                Test This Step
                            </button>
                            <button class="w-full p-2 text-sm font-medium text-red-600 bg-red-50 rounded-lg hover:bg-red-100 transition-colors">
                                Remove Step
                            </button>
                        </div>
                    </div>
                </aside>
            </div>
        </div>
    </section>

    <!-- ============================================== -->
    <!-- STATE 7: BRANCH (IF/ELSE)                     -->
    <!-- ============================================== -->
    <section id="state-branch" class="state-section">
        <div class="h-screen flex flex-col bg-white">
            <header class="h-14 border-b border-gray-200 bg-white flex items-center justify-between px-4 shrink-0">
                <div class="flex items-center gap-3">
                    <button class="text-gray-400 hover:text-gray-600 p-1.5 rounded hover:bg-gray-100">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                        </svg>
                    </button>
                    <span class="text-base font-semibold text-gray-900">Conditional Workflow</span>
                    <span class="px-2 py-0.5 bg-violet-100 text-violet-700 text-xs font-medium rounded">Branch</span>
                </div>
                <div class="flex items-center gap-3">
                    <div class="flex items-center bg-gray-100 rounded-lg p-0.5">
                        <button class="toggle-btn px-3 py-1.5 text-xs font-medium text-gray-500 rounded-md">List</button>
                        <button class="toggle-btn active px-3 py-1.5 text-xs font-medium rounded-md">Canvas</button>
                    </div>
                </div>
            </header>
            
            <div class="flex-1 flex overflow-hidden">
                <main class="flex-1 canvas-grid relative overflow-hidden">
                    <!-- SVG Edges for branching -->
                    <svg class="absolute inset-0 w-full h-full pointer-events-none" style="z-index: 0;">
                        <!-- Input to Branch -->
                        <path d="M 200 220 L 340 220" class="edge-line" />
                        <!-- Branch to True path -->
                        <path d="M 420 190 C 480 190, 480 120, 540 120" stroke="#10B981" stroke-width="2" fill="none" />
                        <!-- Branch to False path -->
                        <path d="M 420 250 C 480 250, 480 320, 540 320" stroke="#F43F5E" stroke-width="2" fill="none" />
                        <!-- True to Merge -->
                        <path d="M 760 120 C 820 120, 820 220, 880 220" class="edge-line" />
                        <!-- False to Merge -->
                        <path d="M 760 320 C 820 320, 820 220, 880 220" class="edge-line" />
                        <!-- Merge to Output -->
                        <path d="M 960 220 L 1040 220" class="edge-line" />
                    </svg>
                    
                    <!-- Input Node -->
                    <div class="absolute bg-white rounded-xl border border-gray-200 shadow-sm px-4 py-3" style="left: 60px; top: 195px; z-index: 1;">
                        <div class="handle handle-right"></div>
                        <div class="flex items-center gap-2">
                            <span class="text-lg">üì•</span>
                            <span class="font-medium text-sm">Get Input</span>
                        </div>
                    </div>
                    
                    <!-- Branch Node (Diamond) -->
                    <div class="absolute" style="left: 340px; top: 195px; z-index: 1;">
                        <div class="relative">
                            <div class="handle handle-left" style="left: -24px; top: 24px;"></div>
                            <div class="branch-diamond rounded-lg flex items-center justify-center shadow-lg">
                                <div class="branch-diamond-inner text-white text-lg">üîÄ</div>
                            </div>
                            <div class="absolute -right-2 top-0 w-3 h-3 bg-emerald-500 rounded-full border-2 border-white" title="True"></div>
                            <div class="absolute -right-2 bottom-0 w-3 h-3 bg-rose-500 rounded-full border-2 border-white" title="False"></div>
                        </div>
                        <div class="text-center mt-2">
                            <div class="text-xs font-medium text-gray-700">Branch</div>
                            <div class="text-[10px] text-gray-400">priority === "high"</div>
                        </div>
                    </div>
                    
                    <!-- True Branch Node -->
                    <div class="absolute bg-white rounded-xl border-2 border-emerald-400 shadow-sm px-4 py-3" style="left: 540px; top: 95px; z-index: 1;">
                        <div class="handle handle-left" style="border-color: #10B981;"></div>
                        <div class="handle handle-right"></div>
                        <div class="flex items-center gap-2">
                            <span class="text-lg">‚ö°</span>
                            <div>
                                <div class="font-medium text-sm">Urgent Handler</div>
                                <div class="text-xs text-emerald-600">if true</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- False Branch Node -->
                    <div class="absolute bg-white rounded-xl border-2 border-rose-400 shadow-sm px-4 py-3" style="left: 540px; top: 295px; z-index: 1;">
                        <div class="handle handle-left" style="border-color: #F43F5E;"></div>
                        <div class="handle handle-right"></div>
                        <div class="flex items-center gap-2">
                            <span class="text-lg">üìã</span>
                            <div>
                                <div class="font-medium text-sm">Normal Handler</div>
                                <div class="text-xs text-rose-600">if false</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Merge Node -->
                    <div class="absolute" style="left: 880px; top: 195px; z-index: 1;">
                        <div class="relative">
                            <div class="w-12 h-12 bg-gray-100 rounded-full border-2 border-gray-300 flex items-center justify-center">
                                <svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h8M8 12h8m-8 5h8"></path>
                                </svg>
                            </div>
                            <div class="handle handle-right" style="right: -6px;"></div>
                        </div>
                        <div class="text-center mt-1 text-xs text-gray-500">Merge</div>
                    </div>
                    
                    <!-- Output Node -->
                    <div class="absolute bg-white rounded-xl border border-gray-200 shadow-sm px-4 py-3" style="left: 1040px; top: 195px; z-index: 1;">
                        <div class="handle handle-left"></div>
                        <div class="flex items-center gap-2">
                            <span class="text-lg">üì§</span>
                            <span class="font-medium text-sm">Send Result</span>
                        </div>
                    </div>
                    
                    <!-- Legend -->
                    <div class="absolute bottom-4 left-4 bg-white rounded-lg border border-gray-200 shadow-sm p-3">
                        <div class="text-xs font-medium text-gray-700 mb-2">Branch Control Flow</div>
                        <div class="space-y-1">
                            <div class="flex items-center gap-2 text-xs">
                                <div class="w-3 h-3 bg-emerald-500 rounded-full"></div>
                                <span class="text-gray-600">True path</span>
                            </div>
                            <div class="flex items-center gap-2 text-xs">
                                <div class="w-3 h-3 bg-rose-500 rounded-full"></div>
                                <span class="text-gray-600">False path</span>
                            </div>
                        </div>
                    </div>
                </main>
                
                <!-- Branch Inspector -->
                <aside class="w-80 border-l border-gray-200 bg-white p-4">
                    <h3 class="font-semibold text-gray-900 mb-4">Branch Configuration</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-xs font-medium text-gray-500 uppercase mb-2">Condition</label>
                            <textarea class="w-full p-3 text-sm border border-gray-200 rounded-lg font-mono bg-gray-50" rows="3">async ({ inputData }) => {
  return inputData.priority === "high";
}</textarea>
                        </div>
                        <div class="p-3 bg-violet-50 rounded-lg text-xs text-violet-700">
                            <strong>Tip:</strong> First matching condition wins. Add a default branch that returns <code>true</code> as the last option.
                        </div>
                    </div>
                </aside>
            </div>
        </div>
    </section>

    <!-- ============================================== -->
    <!-- STATE 8: PARALLEL EXECUTION                   -->
    <!-- ============================================== -->
    <section id="state-parallel" class="state-section">
        <div class="h-screen flex flex-col bg-white">
            <header class="h-14 border-b border-gray-200 bg-white flex items-center justify-between px-4 shrink-0">
                <div class="flex items-center gap-3">
                    <button class="text-gray-400 hover:text-gray-600 p-1.5 rounded hover:bg-gray-100">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                        </svg>
                    </button>
                    <span class="text-base font-semibold text-gray-900">Parallel Workflow</span>
                    <span class="px-2 py-0.5 bg-purple-100 text-purple-700 text-xs font-medium rounded">Parallel</span>
                </div>
                <div class="flex items-center gap-3">
                    <div class="flex items-center bg-gray-100 rounded-lg p-0.5">
                        <button class="toggle-btn px-3 py-1.5 text-xs font-medium text-gray-500 rounded-md">List</button>
                        <button class="toggle-btn active px-3 py-1.5 text-xs font-medium rounded-md">Canvas</button>
                    </div>
                </div>
            </header>
            
            <div class="flex-1 flex overflow-hidden">
                <main class="flex-1 canvas-grid relative overflow-hidden">
                    <!-- SVG Edges for parallel -->
                    <svg class="absolute inset-0 w-full h-full pointer-events-none" style="z-index: 0;">
                        <!-- Input to Split -->
                        <path d="M 200 220 L 300 220" class="edge-line" />
                        <!-- Split to branches -->
                        <path d="M 370 200 C 420 200, 420 100, 480 100" class="edge-line-parallel" />
                        <path d="M 370 220 L 480 220" class="edge-line-parallel" />
                        <path d="M 370 240 C 420 240, 420 340, 480 340" class="edge-line-parallel" />
                        <!-- Branches to Join -->
                        <path d="M 700 100 C 760 100, 760 200, 820 200" class="edge-line-parallel" />
                        <path d="M 700 220 L 820 220" class="edge-line-parallel" />
                        <path d="M 700 340 C 760 340, 760 240, 820 240" class="edge-line-parallel" />
                        <!-- Join to Output -->
                        <path d="M 890 220 L 980 220" class="edge-line" />
                    </svg>
                    
                    <!-- Input Node -->
                    <div class="absolute bg-white rounded-xl border border-gray-200 shadow-sm px-4 py-3" style="left: 60px; top: 195px; z-index: 1;">
                        <div class="handle handle-right"></div>
                        <div class="flex items-center gap-2">
                            <span class="text-lg">üì•</span>
                            <span class="font-medium text-sm">Get User Data</span>
                        </div>
                    </div>
                    
                    <!-- Split Node -->
                    <div class="absolute" style="left: 300px; top: 195px; z-index: 1;">
                        <div class="relative">
                            <div class="w-16 h-12 bg-gradient-to-r from-purple-500 to-indigo-500 rounded-lg flex items-center justify-center shadow-lg">
                                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"></path>
                                </svg>
                            </div>
                            <div class="handle handle-left" style="left: -6px;"></div>
                        </div>
                        <div class="text-center mt-1 text-xs text-gray-500">Split</div>
                    </div>
                    
                    <!-- Parallel Branch 1 -->
                    <div class="absolute bg-white rounded-xl border-2 border-purple-300 border-dashed shadow-sm px-4 py-3" style="left: 480px; top: 75px; z-index: 1;">
                        <div class="handle handle-left" style="border-color: #a855f7;"></div>
                        <div class="handle handle-right" style="border-color: #a855f7;"></div>
                        <div class="flex items-center gap-2">
                            <span class="text-lg">üîó</span>
                            <div>
                                <div class="font-medium text-sm">Fetch LinkedIn</div>
                                <div class="text-xs text-purple-500">parallel #1</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Parallel Branch 2 -->
                    <div class="absolute bg-white rounded-xl border-2 border-purple-300 border-dashed shadow-sm px-4 py-3" style="left: 480px; top: 195px; z-index: 1;">
                        <div class="handle handle-left" style="border-color: #a855f7;"></div>
                        <div class="handle handle-right" style="border-color: #a855f7;"></div>
                        <div class="flex items-center gap-2">
                            <span class="text-lg">üêô</span>
                            <div>
                                <div class="font-medium text-sm">Fetch GitHub</div>
                                <div class="text-xs text-purple-500">parallel #2</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Parallel Branch 3 -->
                    <div class="absolute bg-white rounded-xl border-2 border-purple-300 border-dashed shadow-sm px-4 py-3" style="left: 480px; top: 315px; z-index: 1;">
                        <div class="handle handle-left" style="border-color: #a855f7;"></div>
                        <div class="handle handle-right" style="border-color: #a855f7;"></div>
                        <div class="flex items-center gap-2">
                            <span class="text-lg">üåê</span>
                            <div>
                                <div class="font-medium text-sm">Fetch Portfolio</div>
                                <div class="text-xs text-purple-500">parallel #3</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Join Node -->
                    <div class="absolute" style="left: 820px; top: 195px; z-index: 1;">
                        <div class="relative">
                            <div class="w-16 h-12 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-lg flex items-center justify-center shadow-lg">
                                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
                                </svg>
                            </div>
                            <div class="handle handle-right" style="right: -6px;"></div>
                        </div>
                        <div class="text-center mt-1 text-xs text-gray-500">Join</div>
                    </div>
                    
                    <!-- Output Node -->
                    <div class="absolute bg-white rounded-xl border border-gray-200 shadow-sm px-4 py-3" style="left: 980px; top: 195px; z-index: 1;">
                        <div class="handle handle-left"></div>
                        <div class="flex items-center gap-2">
                            <span class="text-lg">üìä</span>
                            <span class="font-medium text-sm">Merge Profiles</span>
                        </div>
                    </div>
                    
                    <!-- Legend -->
                    <div class="absolute bottom-4 left-4 bg-white rounded-lg border border-gray-200 shadow-sm p-3">
                        <div class="text-xs font-medium text-gray-700 mb-2">Parallel Execution</div>
                        <div class="flex items-center gap-2 text-xs">
                            <div class="w-6 h-0.5 bg-purple-500" style="border-top: 2px dashed #a855f7;"></div>
                            <span class="text-gray-600">Runs concurrently</span>
                        </div>
                        <p class="text-xs text-gray-500 mt-2">All branches run at the same time.<br/>Output is merged at Join.</p>
                    </div>
                </main>
                
                <!-- Parallel Inspector -->
                <aside class="w-80 border-l border-gray-200 bg-white p-4">
                    <h3 class="font-semibold text-gray-900 mb-4">Parallel Configuration</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-xs font-medium text-gray-500 uppercase mb-2">Branches</label>
                            <div class="space-y-2">
                                <div class="p-2 bg-gray-50 rounded-lg text-sm flex items-center gap-2">
                                    <span>üîó</span>
                                    <span>fetchLinkedInStep</span>
                                </div>
                                <div class="p-2 bg-gray-50 rounded-lg text-sm flex items-center gap-2">
                                    <span>üêô</span>
                                    <span>fetchGithubStep</span>
                                </div>
                                <div class="p-2 bg-gray-50 rounded-lg text-sm flex items-center gap-2">
                                    <span>üåê</span>
                                    <span>fetchPortfolioStep</span>
                                </div>
                            </div>
                        </div>
                        <div class="p-3 bg-purple-50 rounded-lg text-xs text-purple-700">
                            <strong>Output shape:</strong><br/>
                            <code class="bg-purple-100 px-1 rounded">{"fetchLinkedIn": {...}, "fetchGithub": {...}, "fetchPortfolio": {...}}</code>
                        </div>
                    </div>
                </aside>
            </div>
        </div>
    </section>

    <!-- ============================================== -->
    <!-- STATE 9: LOOP (WHILE/UNTIL)                   -->
    <!-- ============================================== -->
    <section id="state-loop" class="state-section">
        <div class="h-screen flex flex-col bg-white">
            <header class="h-14 border-b border-gray-200 bg-white flex items-center justify-between px-4 shrink-0">
                <div class="flex items-center gap-3">
                    <button class="text-gray-400 hover:text-gray-600 p-1.5 rounded hover:bg-gray-100">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                        </svg>
                    </button>
                    <span class="text-base font-semibold text-gray-900">Loop Workflow</span>
                    <span class="px-2 py-0.5 bg-cyan-100 text-cyan-700 text-xs font-medium rounded">Loop</span>
                </div>
                <div class="flex items-center gap-3">
                    <div class="flex items-center bg-gray-100 rounded-lg p-0.5">
                        <button class="toggle-btn px-3 py-1.5 text-xs font-medium text-gray-500 rounded-md">List</button>
                        <button class="toggle-btn active px-3 py-1.5 text-xs font-medium rounded-md">Canvas</button>
                    </div>
                </div>
            </header>
            
            <div class="flex-1 flex overflow-hidden">
                <main class="flex-1 canvas-grid relative overflow-hidden">
                    <!-- SVG Edges for loop -->
                    <svg class="absolute inset-0 w-full h-full pointer-events-none" style="z-index: 0;">
                        <!-- Input to Loop -->
                        <path d="M 200 220 L 340 220" class="edge-line" />
                        <!-- Loop body -->
                        <path d="M 500 220 L 640 220" class="edge-line" />
                        <!-- To condition check -->
                        <path d="M 860 220 L 940 220" class="edge-line" />
                        <!-- Loop back (curved) -->
                        <path d="M 940 250 C 940 350, 420 350, 420 250" stroke="#06B6D4" stroke-width="2" fill="none" stroke-dasharray="5,5" marker-end="url(#arrowhead)" />
                        <!-- Exit loop -->
                        <path d="M 1010 220 L 1100 220" class="edge-line" />
                    </svg>
                    
                    <!-- Arrow marker definition -->
                    <svg class="absolute" width="0" height="0">
                        <defs>
                            <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                <polygon points="0 0, 10 3.5, 0 7" fill="#06B6D4" />
                            </marker>
                        </defs>
                    </svg>
                    
                    <!-- Input Node -->
                    <div class="absolute bg-white rounded-xl border border-gray-200 shadow-sm px-4 py-3" style="left: 60px; top: 195px; z-index: 1;">
                        <div class="handle handle-right"></div>
                        <div class="flex items-center gap-2">
                            <span class="text-lg">üì•</span>
                            <span class="font-medium text-sm">Initial Data</span>
                        </div>
                    </div>
                    
                    <!-- Loop Start Marker -->
                    <div class="absolute" style="left: 340px; top: 195px; z-index: 1;">
                        <div class="w-14 h-14 bg-gradient-to-br from-cyan-400 to-blue-500 rounded-full flex items-center justify-center shadow-lg">
                            <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                            </svg>
                        </div>
                        <div class="text-center mt-1 text-xs text-gray-500 font-medium">Loop Start</div>
                    </div>
                    
                    <!-- Loop Body Node -->
                    <div class="absolute bg-white rounded-xl border-2 border-cyan-400 shadow-sm px-4 py-3" style="left: 500px; top: 195px; z-index: 1;">
                        <div class="handle handle-left" style="border-color: #06B6D4;"></div>
                        <div class="handle handle-right" style="border-color: #06B6D4;"></div>
                        <div class="flex items-center gap-2">
                            <span class="text-lg">üîÑ</span>
                            <div>
                                <div class="font-medium text-sm">Process Item</div>
                                <div class="text-xs text-cyan-600">loop body</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Condition Check -->
                    <div class="absolute" style="left: 860px; top: 170px; z-index: 1;">
                        <div class="relative">
                            <div class="branch-diamond rounded-lg flex items-center justify-center shadow-lg" style="background: linear-gradient(135deg, #06B6D4, #0891B2);">
                                <div class="branch-diamond-inner text-white text-sm font-bold">?</div>
                            </div>
                        </div>
                        <div class="text-center mt-2 text-xs">
                            <div class="font-medium text-gray-700">Check</div>
                            <div class="text-gray-400">status !== "done"</div>
                        </div>
                    </div>
                    
                    <!-- Continue label -->
                    <div class="absolute text-xs text-cyan-600 font-medium" style="left: 680px; top: 330px;">
                        ‚Ü© Continue while true
                    </div>
                    
                    <!-- Exit label -->
                    <div class="absolute text-xs text-emerald-600 font-medium" style="left: 1020px; top: 200px;">
                        Exit ‚Üí
                    </div>
                    
                    <!-- Output Node -->
                    <div class="absolute bg-white rounded-xl border border-gray-200 shadow-sm px-4 py-3" style="left: 1100px; top: 195px; z-index: 1;">
                        <div class="handle handle-left"></div>
                        <div class="flex items-center gap-2">
                            <span class="text-lg">‚úÖ</span>
                            <span class="font-medium text-sm">Complete</span>
                        </div>
                    </div>
                    
                    <!-- Legend -->
                    <div class="absolute bottom-4 left-4 bg-white rounded-lg border border-gray-200 shadow-sm p-3">
                        <div class="text-xs font-medium text-gray-700 mb-2">Loop Control Flow</div>
                        <div class="space-y-1 text-xs">
                            <div class="flex items-center gap-2">
                                <div class="w-4 h-0.5 bg-cyan-500" style="border-top: 2px dashed #06B6D4;"></div>
                                <span class="text-gray-600">Loop back path</span>
                            </div>
                            <p class="text-gray-500 mt-1">Repeats until condition is false</p>
                        </div>
                    </div>
                </main>
                
                <!-- Loop Inspector -->
                <aside class="w-80 border-l border-gray-200 bg-white p-4">
                    <h3 class="font-semibold text-gray-900 mb-4">Loop Configuration</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-xs font-medium text-gray-500 uppercase mb-2">Loop Type</label>
                            <select class="w-full p-2 text-sm border border-gray-200 rounded-lg">
                                <option selected>Do While (check after)</option>
                                <option>Do Until (check after)</option>
                                <option>For Each (iterate array)</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-xs font-medium text-gray-500 uppercase mb-2">Condition</label>
                            <textarea class="w-full p-3 text-sm border border-gray-200 rounded-lg font-mono bg-gray-50" rows="3">async ({ inputData, iterationCount }) => {
  return inputData.status !== "done" 
    && iterationCount < 10;
}</textarea>
                        </div>
                        <div class="p-3 bg-cyan-50 rounded-lg text-xs text-cyan-700">
                            <strong>Tip:</strong> Always include a max iteration check to prevent infinite loops.
                        </div>
                    </div>
                </aside>
            </div>
        </div>
    </section>

    <!-- ============================================== -->
    <!-- STATE 10: TOOLS TAB                           -->
    <!-- ============================================== -->
    <section id="state-tools-tab" class="state-section">
        <div class="h-screen flex flex-col bg-white">
            <header class="h-14 border-b border-gray-200 bg-white flex items-center justify-between px-4 shrink-0">
                <div class="flex items-center gap-3">
                    <button class="text-gray-400 hover:text-gray-600 p-1.5 rounded hover:bg-gray-100">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                        </svg>
                    </button>
                    <span class="text-base font-semibold text-gray-900">Job Application Workflow</span>
                </div>
                <div class="flex items-center gap-2">
                    <button class="px-4 py-1.5 text-sm font-medium text-white bg-indigo-600 rounded-lg">Save</button>
                </div>
            </header>
            
            <div class="flex-1 flex overflow-hidden">
                <main class="flex-1 bg-subtle flex items-center justify-center">
                    <div class="text-center text-gray-400">
                        <p>Main editor area</p>
                        <p class="text-sm">(See Tools Tab on right ‚Üí)</p>
                    </div>
                </main>
                
                <aside class="w-96 border-l border-gray-200 bg-white flex flex-col shrink-0">
                    <div class="flex border-b border-gray-200 bg-gray-50 px-1 pt-1 gap-0.5">
                        <button class="panel-tab active px-4 py-2.5 text-sm font-medium rounded-t-lg border border-gray-200 -mb-px bg-white" style="border-bottom-color: white;">Tools</button>
                        <button class="panel-tab px-4 py-2.5 text-sm font-medium text-gray-500 rounded-t-lg">Inputs</button>
                        <button class="panel-tab px-4 py-2.5 text-sm font-medium text-gray-500 rounded-t-lg">Config</button>
                        <button class="panel-tab px-4 py-2.5 text-sm font-medium text-gray-500 rounded-t-lg">Connect</button>
                        <button class="panel-tab px-4 py-2.5 text-sm font-medium text-gray-500 rounded-t-lg">Test</button>
                    </div>
                    
                    <div class="flex-1 overflow-y-auto custom-scroll">
                        <!-- Search -->
                        <div class="p-4 border-b border-gray-100">
                            <div class="relative">
                                <svg class="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                                </svg>
                                <input type="text" value="gmail" placeholder="Search tools..." class="w-full pl-10 pr-4 py-2.5 text-sm border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500" />
                            </div>
                        </div>
                        
                        <!-- Filtered Results -->
                        <div class="p-4">
                            <div class="text-xs text-gray-400 uppercase font-medium mb-3">Search results for "gmail"</div>
                            
                            <!-- Gmail Group -->
                            <div class="mb-6">
                                <div class="flex items-center gap-2 mb-3">
                                    <div class="w-8 h-8 bg-red-100 rounded-lg flex items-center justify-center">
                                        <span>üìß</span>
                                    </div>
                                    <div>
                                        <span class="font-semibold text-gray-900">Gmail</span>
                                        <span class="text-xs text-gray-400 ml-1">(6 tools)</span>
                                    </div>
                                </div>
                                <div class="space-y-2 ml-10">
                                    <button class="w-full flex items-center gap-3 p-3 text-sm text-left bg-white border border-gray-200 rounded-xl hover:border-indigo-300 hover:shadow-sm transition-all">
                                        <span class="text-lg">üì§</span>
                                        <div class="flex-1">
                                            <div class="font-medium text-gray-900">Send Email</div>
                                            <div class="text-xs text-gray-500">GMAIL_SEND_EMAIL</div>
                                        </div>
                                        <span class="text-xs text-gray-400">Drag ‚Üí</span>
                                    </button>
                                    <button class="w-full flex items-center gap-3 p-3 text-sm text-left bg-white border border-gray-200 rounded-xl hover:border-indigo-300 hover:shadow-sm transition-all">
                                        <span class="text-lg">üì•</span>
                                        <div class="flex-1">
                                            <div class="font-medium text-gray-900">Read Email</div>
                                            <div class="text-xs text-gray-500">GMAIL_READ_EMAIL</div>
                                        </div>
                                        <span class="text-xs text-gray-400">Drag ‚Üí</span>
                                    </button>
                                    <button class="w-full flex items-center gap-3 p-3 text-sm text-left bg-white border border-gray-200 rounded-xl hover:border-indigo-300 hover:shadow-sm transition-all">
                                        <span class="text-lg">üîç</span>
                                        <div class="flex-1">
                                            <div class="font-medium text-gray-900">Search Emails</div>
                                            <div class="text-xs text-gray-500">GMAIL_SEARCH</div>
                                        </div>
                                        <span class="text-xs text-gray-400">Drag ‚Üí</span>
                                    </button>
                                    <button class="w-full flex items-center gap-3 p-3 text-sm text-left bg-white border border-gray-200 rounded-xl hover:border-indigo-300 hover:shadow-sm transition-all">
                                        <span class="text-lg">üè∑Ô∏è</span>
                                        <div class="flex-1">
                                            <div class="font-medium text-gray-900">Add Label</div>
                                            <div class="text-xs text-gray-500">GMAIL_ADD_LABEL</div>
                                        </div>
                                        <span class="text-xs text-gray-400">Drag ‚Üí</span>
                                    </button>
                                    <button class="text-sm text-gray-500 hover:text-indigo-600 ml-2">
                                        + 2 more tools...
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </aside>
            </div>
        </div>
    </section>

    <!-- ============================================== -->
    <!-- STATE 11: INPUTS TAB                          -->
    <!-- ============================================== -->
    <section id="state-inputs-tab" class="state-section">
        <div class="h-screen flex flex-col bg-white">
            <header class="h-14 border-b border-gray-200 bg-white flex items-center justify-between px-4 shrink-0">
                <div class="flex items-center gap-3">
                    <button class="text-gray-400 hover:text-gray-600 p-1.5 rounded hover:bg-gray-100">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                        </svg>
                    </button>
                    <span class="text-base font-semibold text-gray-900">Job Application Workflow</span>
                </div>
            </header>
            
            <div class="flex-1 flex overflow-hidden">
                <main class="flex-1 bg-subtle flex items-center justify-center">
                    <div class="text-center text-gray-400">
                        <p>Main editor area</p>
                        <p class="text-sm">(See Inputs Tab on right ‚Üí)</p>
                    </div>
                </main>
                
                <aside class="w-96 border-l border-gray-200 bg-white flex flex-col shrink-0">
                    <div class="flex border-b border-gray-200 bg-gray-50 px-1 pt-1 gap-0.5">
                        <button class="panel-tab px-4 py-2.5 text-sm font-medium text-gray-500 rounded-t-lg">Tools</button>
                        <button class="panel-tab active px-4 py-2.5 text-sm font-medium rounded-t-lg border border-gray-200 -mb-px bg-white" style="border-bottom-color: white;">Inputs</button>
                        <button class="panel-tab px-4 py-2.5 text-sm font-medium text-gray-500 rounded-t-lg">Config</button>
                        <button class="panel-tab px-4 py-2.5 text-sm font-medium text-gray-500 rounded-t-lg">Connect</button>
                        <button class="panel-tab px-4 py-2.5 text-sm font-medium text-gray-500 rounded-t-lg">Test</button>
                    </div>
                    
                    <div class="flex-1 overflow-y-auto custom-scroll p-4 space-y-4">
                        <div class="p-3 bg-violet-50 border border-violet-100 rounded-xl text-sm text-violet-700">
                            <strong>Runtime Inputs</strong> are values the agent provides each time the workflow runs.
                        </div>
                        
                        <!-- Input 1 -->
                        <div class="bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden">
                            <div class="p-4 border-b border-gray-100 flex items-center justify-between">
                                <div class="flex items-center gap-2">
                                    <span class="text-violet-500 font-mono font-bold text-lg">$</span>
                                    <span class="font-semibold text-gray-900">jobUrl</span>
                                    <span class="text-xs text-red-500">*</span>
                                </div>
                                <button class="text-gray-400 hover:text-red-500">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                    </svg>
                                </button>
                            </div>
                            <div class="p-4 space-y-3">
                                <div class="grid grid-cols-2 gap-3">
                                    <div>
                                        <label class="block text-xs font-medium text-gray-500 mb-1">Type</label>
                                        <select class="w-full p-2 text-sm border border-gray-200 rounded-lg">
                                            <option selected>string</option>
                                            <option>number</option>
                                            <option>boolean</option>
                                            <option>array</option>
                                            <option>object</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-xs font-medium text-gray-500 mb-1">Required</label>
                                        <select class="w-full p-2 text-sm border border-gray-200 rounded-lg">
                                            <option selected>Yes</option>
                                            <option>No</option>
                                        </select>
                                    </div>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">Description</label>
                                    <input type="text" value="URL of the job listing to scrape" class="w-full p-2 text-sm border border-gray-200 rounded-lg" />
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">Default Value (optional)</label>
                                    <input type="text" placeholder="e.g., https://example.com/job/123" class="w-full p-2 text-sm border border-gray-200 rounded-lg" />
                                </div>
                            </div>
                            <div class="px-4 py-2 bg-gray-50 text-xs text-gray-500">
                                Used in: Step 1 (Scrape Job Listing)
                            </div>
                        </div>
                        
                        <!-- Input 2 -->
                        <div class="bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden">
                            <div class="p-4 border-b border-gray-100 flex items-center justify-between">
                                <div class="flex items-center gap-2">
                                    <span class="text-violet-500 font-mono font-bold text-lg">$</span>
                                    <span class="font-semibold text-gray-900">baseResume</span>
                                    <span class="text-xs text-red-500">*</span>
                                </div>
                                <button class="text-gray-400 hover:text-red-500">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                    </svg>
                                </button>
                            </div>
                            <div class="p-4 space-y-3">
                                <div class="grid grid-cols-2 gap-3">
                                    <div>
                                        <label class="block text-xs font-medium text-gray-500 mb-1">Type</label>
                                        <select class="w-full p-2 text-sm border border-gray-200 rounded-lg">
                                            <option selected>string</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-xs font-medium text-gray-500 mb-1">Required</label>
                                        <select class="w-full p-2 text-sm border border-gray-200 rounded-lg">
                                            <option selected>Yes</option>
                                        </select>
                                    </div>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">Description</label>
                                    <input type="text" value="User's base resume content to tailor" class="w-full p-2 text-sm border border-gray-200 rounded-lg" />
                                </div>
                            </div>
                            <div class="px-4 py-2 bg-gray-50 text-xs text-gray-500">
                                Used in: Step 2 (Generate Resume)
                            </div>
                        </div>
                        
                        <!-- Add Button -->
                        <button class="w-full p-4 border-2 border-dashed border-gray-200 rounded-xl text-sm text-gray-500 hover:border-violet-300 hover:text-violet-600 hover:bg-violet-50 transition-all flex items-center justify-center gap-2">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                            </svg>
                            Add Runtime Input
                        </button>
                    </div>
                </aside>
            </div>
        </div>
    </section>

    <!-- ============================================== -->
    <!-- STATE 12: CONFIG TAB                          -->
    <!-- ============================================== -->
    <section id="state-config-tab" class="state-section">
        <div class="h-screen flex flex-col bg-white">
            <header class="h-14 border-b border-gray-200 bg-white flex items-center justify-between px-4 shrink-0">
                <div class="flex items-center gap-3">
                    <button class="text-gray-400 hover:text-gray-600 p-1.5 rounded hover:bg-gray-100">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                        </svg>
                    </button>
                    <span class="text-base font-semibold text-gray-900">Job Application Workflow</span>
                </div>
            </header>
            
            <div class="flex-1 flex overflow-hidden">
                <main class="flex-1 bg-subtle flex items-center justify-center">
                    <div class="text-center text-gray-400">
                        <p>Main editor area</p>
                        <p class="text-sm">(See Config Tab on right ‚Üí)</p>
                    </div>
                </main>
                
                <aside class="w-96 border-l border-gray-200 bg-white flex flex-col shrink-0">
                    <div class="flex border-b border-gray-200 bg-gray-50 px-1 pt-1 gap-0.5">
                        <button class="panel-tab px-4 py-2.5 text-sm font-medium text-gray-500 rounded-t-lg">Tools</button>
                        <button class="panel-tab px-4 py-2.5 text-sm font-medium text-gray-500 rounded-t-lg">Inputs</button>
                        <button class="panel-tab active px-4 py-2.5 text-sm font-medium rounded-t-lg border border-gray-200 -mb-px bg-white" style="border-bottom-color: white;">Config</button>
                        <button class="panel-tab px-4 py-2.5 text-sm font-medium text-gray-500 rounded-t-lg">Connect</button>
                        <button class="panel-tab px-4 py-2.5 text-sm font-medium text-gray-500 rounded-t-lg">Test</button>
                    </div>
                    
                    <div class="flex-1 overflow-y-auto custom-scroll p-4 space-y-4">
                        <div class="p-3 bg-amber-50 border border-amber-100 rounded-xl text-sm text-amber-700">
                            <strong>Configs</strong> are set once when the workflow is assigned to an agent. They persist across executions.
                        </div>
                        
                        <!-- Config 1 -->
                        <div class="bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden">
                            <div class="p-4 border-b border-gray-100 flex items-center justify-between">
                                <div class="flex items-center gap-2">
                                    <span class="text-amber-500 text-lg">‚öô</span>
                                    <span class="font-semibold text-gray-900">recipientEmail</span>
                                </div>
                                <button class="text-gray-400 hover:text-red-500">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                    </svg>
                                </button>
                            </div>
                            <div class="p-4 space-y-3">
                                <div class="grid grid-cols-2 gap-3">
                                    <div>
                                        <label class="block text-xs font-medium text-gray-500 mb-1">Type</label>
                                        <select class="w-full p-2 text-sm border border-gray-200 rounded-lg">
                                            <option selected>string</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-xs font-medium text-gray-500 mb-1">Required</label>
                                        <select class="w-full p-2 text-sm border border-gray-200 rounded-lg">
                                            <option selected>Yes</option>
                                        </select>
                                    </div>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">Label</label>
                                    <input type="text" value="Recipient Email Address" class="w-full p-2 text-sm border border-gray-200 rounded-lg" />
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">Default Value</label>
                                    <input type="text" value="hr@company.com" class="w-full p-2 text-sm border border-gray-200 rounded-lg" />
                                </div>
                            </div>
                        </div>
                        
                        <!-- Config 2: Select type -->
                        <div class="bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden">
                            <div class="p-4 border-b border-gray-100 flex items-center justify-between">
                                <div class="flex items-center gap-2">
                                    <span class="text-amber-500 text-lg">‚öô</span>
                                    <span class="font-semibold text-gray-900">outputFormat</span>
                                </div>
                                <button class="text-gray-400 hover:text-red-500">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                    </svg>
                                </button>
                            </div>
                            <div class="p-4 space-y-3">
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">Type</label>
                                    <select class="w-full p-2 text-sm border border-gray-200 rounded-lg">
                                        <option>string</option>
                                        <option>number</option>
                                        <option selected>select</option>
                                        <option>boolean</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">Options (comma separated)</label>
                                    <input type="text" value="pdf, docx, markdown" class="w-full p-2 text-sm border border-gray-200 rounded-lg" />
                                </div>
                                <div>
                                    <label class="block text-xs font-medium text-gray-500 mb-1">Default</label>
                                    <select class="w-full p-2 text-sm border border-gray-200 rounded-lg">
                                        <option selected>pdf</option>
                                        <option>docx</option>
                                        <option>markdown</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Add Button -->
                        <button class="w-full p-4 border-2 border-dashed border-gray-200 rounded-xl text-sm text-gray-500 hover:border-amber-300 hover:text-amber-600 hover:bg-amber-50 transition-all flex items-center justify-center gap-2">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                            </svg>
                            Add Config Option
                        </button>
                    </div>
                </aside>
            </div>
        </div>
    </section>

    <!-- ============================================== -->
    <!-- STATE 13: CONNECT TAB                         -->
    <!-- ============================================== -->
    <section id="state-connect-tab" class="state-section">
        <div class="h-screen flex flex-col bg-white">
            <header class="h-14 border-b border-gray-200 bg-white flex items-center justify-between px-4 shrink-0">
                <div class="flex items-center gap-3">
                    <button class="text-gray-400 hover:text-gray-600 p-1.5 rounded hover:bg-gray-100">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                        </svg>
                    </button>
                    <span class="text-base font-semibold text-gray-900">Job Application Workflow</span>
                </div>
            </header>
            
            <div class="flex-1 flex overflow-hidden">
                <main class="flex-1 bg-subtle flex items-center justify-center">
                    <div class="text-center text-gray-400">
                        <p>Main editor area</p>
                        <p class="text-sm">(See Connect Tab on right ‚Üí)</p>
                    </div>
                </main>
                
                <aside class="w-96 border-l border-gray-200 bg-white flex flex-col shrink-0">
                    <div class="flex border-b border-gray-200 bg-gray-50 px-1 pt-1 gap-0.5">
                        <button class="panel-tab px-4 py-2.5 text-sm font-medium text-gray-500 rounded-t-lg">Tools</button>
                        <button class="panel-tab px-4 py-2.5 text-sm font-medium text-gray-500 rounded-t-lg">Inputs</button>
                        <button class="panel-tab px-4 py-2.5 text-sm font-medium text-gray-500 rounded-t-lg">Config</button>
                        <button class="panel-tab active px-4 py-2.5 text-sm font-medium rounded-t-lg border border-gray-200 -mb-px bg-white" style="border-bottom-color: white;">Connect</button>
                        <button class="panel-tab px-4 py-2.5 text-sm font-medium text-gray-500 rounded-t-lg">Test</button>
                    </div>
                    
                    <div class="flex-1 overflow-y-auto custom-scroll p-4 space-y-4">
                        <div class="p-3 bg-blue-50 border border-blue-100 rounded-xl text-sm text-blue-700">
                            <strong>Required Connections</strong> are auto-detected from the tools you use. Users must connect these before running.
                        </div>
                        
                        <!-- Connected: Firecrawl -->
                        <div class="bg-white rounded-xl border border-emerald-200 shadow-sm overflow-hidden">
                            <div class="p-4 flex items-center gap-4">
                                <div class="w-12 h-12 bg-orange-100 rounded-xl flex items-center justify-center text-2xl">
                                    üî•
                                </div>
                                <div class="flex-1">
                                    <div class="font-semibold text-gray-900">Firecrawl</div>
                                    <div class="flex items-center gap-1 text-sm text-emerald-600">
                                        <span class="w-2 h-2 bg-emerald-500 rounded-full"></span>
                                        Connected
                                    </div>
                                </div>
                                <button class="text-sm text-gray-500 hover:text-gray-700">Manage</button>
                            </div>
                            <div class="px-4 py-2 bg-gray-50 border-t border-gray-100 text-xs text-gray-500">
                                Used by: Scrape Job Listing
                            </div>
                        </div>
                        
                        <!-- Connected: OpenAI -->
                        <div class="bg-white rounded-xl border border-emerald-200 shadow-sm overflow-hidden">
                            <div class="p-4 flex items-center gap-4">
                                <div class="w-12 h-12 bg-gray-100 rounded-xl flex items-center justify-center text-2xl">
                                    ü§ñ
                                </div>
                                <div class="flex-1">
                                    <div class="font-semibold text-gray-900">OpenAI</div>
                                    <div class="flex items-center gap-1 text-sm text-emerald-600">
                                        <span class="w-2 h-2 bg-emerald-500 rounded-full"></span>
                                        Connected
                                    </div>
                                </div>
                                <button class="text-sm text-gray-500 hover:text-gray-700">Manage</button>
                            </div>
                            <div class="px-4 py-2 bg-gray-50 border-t border-gray-100 text-xs text-gray-500">
                                Used by: Generate Resume
                            </div>
                        </div>
                        
                        <!-- NOT Connected: Gmail -->
                        <div class="bg-white rounded-xl border-2 border-amber-300 shadow-sm overflow-hidden">
                            <div class="p-4 flex items-center gap-4">
                                <div class="w-12 h-12 bg-red-100 rounded-xl flex items-center justify-center text-2xl">
                                    üìß
                                </div>
                                <div class="flex-1">
                                    <div class="font-semibold text-gray-900">Gmail</div>
                                    <div class="flex items-center gap-1 text-sm text-amber-600">
                                        <span class="w-2 h-2 bg-amber-500 rounded-full"></span>
                                        Not Connected
                                    </div>
                                </div>
                                <button class="px-3 py-1.5 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700">
                                    Connect
                                </button>
                            </div>
                            <div class="px-4 py-2 bg-amber-50 border-t border-amber-200 text-xs text-amber-700">
                                ‚ö†Ô∏è Required for: Send Email
                            </div>
                        </div>
                        
                        <!-- Info -->
                        <div class="p-4 bg-gray-50 rounded-xl text-sm text-gray-600">
                            <div class="font-medium mb-1">When shared</div>
                            <p class="text-xs text-gray-500">Users who hire this workflow will need to connect their own accounts for these integrations.</p>
                        </div>
                    </div>
                </aside>
            </div>
        </div>
    </section>

    <!-- ============================================== -->
    <!-- STATE 14: TEST TAB                            -->
    <!-- ============================================== -->
    <section id="state-test-tab" class="state-section">
        <div class="h-screen flex flex-col bg-white">
            <header class="h-14 border-b border-gray-200 bg-white flex items-center justify-between px-4 shrink-0">
                <div class="flex items-center gap-3">
                    <button class="text-gray-400 hover:text-gray-600 p-1.5 rounded hover:bg-gray-100">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                        </svg>
                    </button>
                    <span class="text-base font-semibold text-gray-900">Job Application Workflow</span>
                </div>
            </header>
            
            <div class="flex-1 flex overflow-hidden">
                <main class="flex-1 bg-subtle flex items-center justify-center">
                    <div class="text-center text-gray-400">
                        <p>Main editor area</p>
                        <p class="text-sm">(See Test Tab on right ‚Üí)</p>
                    </div>
                </main>
                
                <aside class="w-96 border-l border-gray-200 bg-white flex flex-col shrink-0">
                    <div class="flex border-b border-gray-200 bg-gray-50 px-1 pt-1 gap-0.5">
                        <button class="panel-tab px-4 py-2.5 text-sm font-medium text-gray-500 rounded-t-lg">Tools</button>
                        <button class="panel-tab px-4 py-2.5 text-sm font-medium text-gray-500 rounded-t-lg">Inputs</button>
                        <button class="panel-tab px-4 py-2.5 text-sm font-medium text-gray-500 rounded-t-lg">Config</button>
                        <button class="panel-tab px-4 py-2.5 text-sm font-medium text-gray-500 rounded-t-lg">Connect</button>
                        <button class="panel-tab active px-4 py-2.5 text-sm font-medium rounded-t-lg border border-gray-200 -mb-px bg-white" style="border-bottom-color: white;">Test</button>
                    </div>
                    
                    <div class="flex-1 overflow-y-auto custom-scroll p-4 space-y-4">
                        <!-- Saved Tests -->
                        <div>
                            <div class="flex items-center justify-between mb-3">
                                <h3 class="font-semibold text-gray-900">Saved Test Cases</h3>
                                <button class="text-sm text-indigo-600 hover:text-indigo-700">+ New</button>
                            </div>
                            <div class="space-y-2">
                                <button class="w-full p-3 bg-indigo-50 border border-indigo-200 rounded-xl flex items-center justify-between hover:bg-indigo-100 transition-colors">
                                    <div class="flex items-center gap-3">
                                        <div class="w-8 h-8 bg-indigo-100 rounded-lg flex items-center justify-center text-indigo-600 font-bold text-sm">1</div>
                                        <div class="text-left">
                                            <div class="font-medium text-gray-900">Basic job flow</div>
                                            <div class="text-xs text-gray-500">Last run: 2 min ago</div>
                                        </div>
                                    </div>
                                    <span class="px-2 py-1 text-xs font-medium text-emerald-700 bg-emerald-100 rounded">Passed</span>
                                </button>
                                <button class="w-full p-3 bg-white border border-gray-200 rounded-xl flex items-center justify-between hover:bg-gray-50 transition-colors">
                                    <div class="flex items-center gap-3">
                                        <div class="w-8 h-8 bg-gray-100 rounded-lg flex items-center justify-center text-gray-500 font-bold text-sm">2</div>
                                        <div class="text-left">
                                            <div class="font-medium text-gray-900">Edge case: missing fields</div>
                                            <div class="text-xs text-gray-500">Never run</div>
                                        </div>
                                    </div>
                                    <span class="px-2 py-1 text-xs font-medium text-gray-500 bg-gray-100 rounded">Pending</span>
                                </button>
                                <button class="w-full p-3 bg-white border border-gray-200 rounded-xl flex items-center justify-between hover:bg-gray-50 transition-colors">
                                    <div class="flex items-center gap-3">
                                        <div class="w-8 h-8 bg-gray-100 rounded-lg flex items-center justify-center text-gray-500 font-bold text-sm">3</div>
                                        <div class="text-left">
                                            <div class="font-medium text-gray-900">Long resume content</div>
                                            <div class="text-xs text-gray-500">Last run: 1 hour ago</div>
                                        </div>
                                    </div>
                                    <span class="px-2 py-1 text-xs font-medium text-rose-700 bg-rose-100 rounded">Failed</span>
                                </button>
                            </div>
                        </div>
                        
                        <!-- Last Run Results -->
                        <div class="border-t border-gray-200 pt-4">
                            <h3 class="font-semibold text-gray-900 mb-3">Last Run: Basic job flow</h3>
                            <div class="space-y-2">
                                <div class="flex items-center gap-3 p-2 bg-emerald-50 rounded-lg">
                                    <div class="w-6 h-6 bg-emerald-500 rounded-full flex items-center justify-center">
                                        <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                        </svg>
                                    </div>
                                    <div class="flex-1">
                                        <div class="text-sm font-medium text-gray-900">Scrape Job Listing</div>
                                    </div>
                                    <span class="text-xs text-gray-500">0.8s</span>
                                </div>
                                <div class="flex items-center gap-3 p-2 bg-emerald-50 rounded-lg">
                                    <div class="w-6 h-6 bg-emerald-500 rounded-full flex items-center justify-center">
                                        <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                        </svg>
                                    </div>
                                    <div class="flex-1">
                                        <div class="text-sm font-medium text-gray-900">Generate Resume</div>
                                    </div>
                                    <span class="text-xs text-gray-500">2.1s</span>
                                </div>
                                <div class="flex items-center gap-3 p-2 bg-emerald-50 rounded-lg">
                                    <div class="w-6 h-6 bg-emerald-500 rounded-full flex items-center justify-center">
                                        <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                        </svg>
                                    </div>
                                    <div class="flex-1">
                                        <div class="text-sm font-medium text-gray-900">Send Email</div>
                                    </div>
                                    <span class="text-xs text-gray-500">0.4s</span>
                                </div>
                            </div>
                            <div class="mt-3 p-3 bg-emerald-100 rounded-xl text-sm text-emerald-700 flex items-center gap-2">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                                <span class="font-medium">All steps passed</span>
                                <span class="text-emerald-600 ml-auto">3.3s total</span>
                            </div>
                        </div>
                    </div>
                </aside>
            </div>
        </div>
    </section>

    <!-- ============================================== -->
    <!-- STATE 15: DATA MAPPING MODAL                  -->
    <!-- ============================================== -->
    <section id="state-mapping-modal" class="state-section">
        <div class="h-screen flex flex-col bg-white relative">
            <header class="h-14 border-b border-gray-200 bg-white flex items-center justify-between px-4 shrink-0">
                <div class="flex items-center gap-3">
                    <span class="text-base font-semibold text-gray-900">Job Application Workflow</span>
                </div>
            </header>
            
            <div class="flex-1 bg-subtle opacity-50 pointer-events-none">
                <!-- Background content (dimmed) -->
            </div>
            
            <!-- Modal Overlay -->
            <div class="modal-backdrop absolute inset-0 flex items-center justify-center z-50">
                <div class="bg-white rounded-2xl shadow-2xl w-[800px] max-h-[80vh] overflow-hidden animate-fade-in">
                    <!-- Modal Header -->
                    <div class="p-5 border-b border-gray-200 flex items-center justify-between">
                        <div class="flex items-center gap-4">
                            <div class="flex items-center gap-2">
                                <span class="text-xl">üîç</span>
                                <span class="font-medium">Scrape Job</span>
                            </div>
                            <svg class="w-5 h-5 text-indigo-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
                            </svg>
                            <div class="flex items-center gap-2">
                                <span class="text-xl">üìù</span>
                                <span class="font-medium">Generate Resume</span>
                            </div>
                        </div>
                        <button class="text-gray-400 hover:text-gray-600 p-1.5 rounded-lg hover:bg-gray-100">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                    
                    <!-- Modal Body -->
                    <div class="p-5 overflow-y-auto max-h-[60vh]">
                        <p class="text-sm text-gray-500 mb-4">Define how data flows from Step 1 to Step 2. Map output fields to input fields.</p>
                        
                        <div class="grid grid-cols-2 gap-8">
                            <!-- Source Side -->
                            <div>
                                <h4 class="text-xs font-semibold text-gray-500 uppercase mb-3">Source: Scrape Job (outputs)</h4>
                                <div class="space-y-2">
                                    <div class="p-3 bg-indigo-50 border-2 border-indigo-300 rounded-lg flex items-center justify-between cursor-move">
                                        <div class="flex items-center gap-2">
                                            <span class="text-indigo-500">‚Ä¢</span>
                                            <span class="font-medium text-sm">title</span>
                                        </div>
                                        <span class="text-xs text-gray-400 font-mono">string</span>
                                    </div>
                                    <div class="p-3 bg-indigo-50 border-2 border-indigo-300 rounded-lg flex items-center justify-between cursor-move">
                                        <div class="flex items-center gap-2">
                                            <span class="text-indigo-500">‚Ä¢</span>
                                            <span class="font-medium text-sm">company</span>
                                        </div>
                                        <span class="text-xs text-gray-400 font-mono">string</span>
                                    </div>
                                    <div class="p-3 bg-indigo-50 border-2 border-indigo-300 rounded-lg flex items-center justify-between cursor-move">
                                        <div class="flex items-center gap-2">
                                            <span class="text-indigo-500">‚Ä¢</span>
                                            <span class="font-medium text-sm">requirements</span>
                                        </div>
                                        <span class="text-xs text-gray-400 font-mono">string[]</span>
                                    </div>
                                    <div class="p-3 bg-gray-50 border border-gray-200 rounded-lg flex items-center justify-between text-gray-400">
                                        <div class="flex items-center gap-2">
                                            <span>‚Ä¢</span>
                                            <span class="font-medium text-sm">description</span>
                                        </div>
                                        <span class="text-xs font-mono">string</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Target Side -->
                            <div>
                                <h4 class="text-xs font-semibold text-gray-500 uppercase mb-3">Target: Generate Resume (inputs)</h4>
                                <div class="space-y-2">
                                    <div class="p-3 bg-emerald-50 border-2 border-emerald-300 rounded-lg">
                                        <div class="flex items-center justify-between mb-2">
                                            <span class="font-medium text-sm">jobTitle</span>
                                            <span class="text-xs text-gray-400 font-mono">string</span>
                                        </div>
                                        <div class="flex items-center gap-2 text-xs text-emerald-700">
                                            <span>‚Üê</span>
                                            <span class="font-medium">title</span>
                                            <span class="text-emerald-400">(from Step 1)</span>
                                        </div>
                                    </div>
                                    <div class="p-3 bg-emerald-50 border-2 border-emerald-300 rounded-lg">
                                        <div class="flex items-center justify-between mb-2">
                                            <span class="font-medium text-sm">companyName</span>
                                            <span class="text-xs text-gray-400 font-mono">string</span>
                                        </div>
                                        <div class="flex items-center gap-2 text-xs text-emerald-700">
                                            <span>‚Üê</span>
                                            <span class="font-medium">company</span>
                                            <span class="text-emerald-400">(from Step 1)</span>
                                        </div>
                                    </div>
                                    <div class="p-3 bg-emerald-50 border-2 border-emerald-300 rounded-lg">
                                        <div class="flex items-center justify-between mb-2">
                                            <span class="font-medium text-sm">targetSkills</span>
                                            <span class="text-xs text-gray-400 font-mono">string[]</span>
                                        </div>
                                        <div class="flex items-center gap-2 text-xs text-emerald-700">
                                            <span>‚Üê</span>
                                            <span class="font-medium">requirements</span>
                                            <span class="text-emerald-400">(from Step 1)</span>
                                        </div>
                                    </div>
                                    <div class="p-3 bg-violet-50 border-2 border-violet-300 rounded-lg">
                                        <div class="flex items-center justify-between mb-2">
                                            <span class="font-medium text-sm">baseResume</span>
                                            <span class="text-xs text-gray-400 font-mono">string</span>
                                        </div>
                                        <div class="flex items-center gap-2 text-xs text-violet-700">
                                            <span class="font-bold">$</span>
                                            <span class="font-medium">Runtime Input</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Generated Code Preview -->
                        <div class="mt-6 p-4 bg-gray-900 rounded-xl">
                            <div class="flex items-center justify-between mb-2">
                                <span class="text-xs text-gray-400 font-medium">Generated .map() function</span>
                                <button class="text-xs text-gray-400 hover:text-white">Copy</button>
                            </div>
                            <pre class="text-sm font-mono text-emerald-400 overflow-x-auto"><code>.map({
  jobTitle: { step: scrapeJobStep, path: "title" },
  companyName: { step: scrapeJobStep, path: "company" },
  targetSkills: { step: scrapeJobStep, path: "requirements" },
  baseResume: { step: "trigger", path: "baseResume" }
})</code></pre>
                        </div>
                    </div>
                    
                    <!-- Modal Footer -->
                    <div class="p-5 border-t border-gray-200 flex items-center justify-between bg-gray-50">
                        <div class="text-sm text-gray-500">
                            <span class="font-medium text-indigo-600">3</span> fields mapped, <span class="text-gray-400">1 unmapped</span>
                        </div>
                        <div class="flex items-center gap-3">
                            <button class="px-4 py-2 text-sm font-medium text-gray-600 hover:text-gray-800">Cancel</button>
                            <button class="px-6 py-2 text-sm font-medium text-white bg-indigo-600 rounded-xl hover:bg-indigo-700">Save Mapping</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- ============================================== -->
    <!-- STATE 16: ADD STEP WIZARD                     -->
    <!-- ============================================== -->
    <section id="state-add-step" class="state-section">
        <div class="h-screen flex flex-col bg-white relative">
            <header class="h-14 border-b border-gray-200 bg-white flex items-center justify-between px-4 shrink-0">
                <span class="text-base font-semibold text-gray-900">Job Application Workflow</span>
            </header>
            
            <div class="flex-1 bg-subtle opacity-50 pointer-events-none"></div>
            
            <!-- Wizard Overlay -->
            <div class="modal-backdrop absolute inset-0 flex items-center justify-center z-50">
                <div class="bg-white rounded-2xl shadow-2xl w-[700px] overflow-hidden animate-fade-in">
                    <!-- Wizard Header -->
                    <div class="p-5 border-b border-gray-200">
                        <h2 class="text-xl font-semibold text-gray-900">Add New Step</h2>
                        <p class="text-sm text-gray-500 mt-1">Insert after Step 2: Generate Resume</p>
                    </div>
                    
                    <!-- Step Type Selection -->
                    <div class="p-5">
                        <h3 class="text-sm font-semibold text-gray-700 mb-4">What kind of step?</h3>
                        <div class="grid grid-cols-2 gap-4">
                            <!-- Tool Step -->
                            <button class="p-5 bg-indigo-50 border-2 border-indigo-300 rounded-xl text-left hover:bg-indigo-100 transition-colors">
                                <div class="w-12 h-12 bg-indigo-100 rounded-xl flex items-center justify-center text-2xl mb-3">
                                    üîß
                                </div>
                                <h4 class="font-semibold text-gray-900">Composio Tool</h4>
                                <p class="text-sm text-gray-500 mt-1">Use a pre-built integration like Gmail, Slack, or GitHub</p>
                            </button>
                            
                            <!-- Custom Code -->
                            <button class="p-5 bg-white border border-gray-200 rounded-xl text-left hover:bg-gray-50 transition-colors">
                                <div class="w-12 h-12 bg-gray-100 rounded-xl flex items-center justify-center text-2xl mb-3">
                                    üíª
                                </div>
                                <h4 class="font-semibold text-gray-900">Custom Code</h4>
                                <p class="text-sm text-gray-500 mt-1">Write TypeScript to transform data or call custom APIs</p>
                            </button>
                            
                            <!-- Branch -->
                            <button class="p-5 bg-white border border-gray-200 rounded-xl text-left hover:bg-gray-50 transition-colors">
                                <div class="w-12 h-12 bg-violet-100 rounded-xl flex items-center justify-center text-2xl mb-3">
                                    üîÄ
                                </div>
                                <h4 class="font-semibold text-gray-900">Branch (If/Else)</h4>
                                <p class="text-sm text-gray-500 mt-1">Take different paths based on a condition</p>
                            </button>
                            
                            <!-- Parallel -->
                            <button class="p-5 bg-white border border-gray-200 rounded-xl text-left hover:bg-gray-50 transition-colors">
                                <div class="w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center text-2xl mb-3">
                                    ‚è∏Ô∏è
                                </div>
                                <h4 class="font-semibold text-gray-900">Parallel Steps</h4>
                                <p class="text-sm text-gray-500 mt-1">Run multiple steps at the same time</p>
                            </button>
                            
                            <!-- Loop -->
                            <button class="p-5 bg-white border border-gray-200 rounded-xl text-left hover:bg-gray-50 transition-colors">
                                <div class="w-12 h-12 bg-cyan-100 rounded-xl flex items-center justify-center text-2xl mb-3">
                                    üîÅ
                                </div>
                                <h4 class="font-semibold text-gray-900">Loop</h4>
                                <p class="text-sm text-gray-500 mt-1">Repeat steps while a condition is true</p>
                            </button>
                            
                            <!-- Import -->
                            <button class="p-5 bg-white border border-gray-200 rounded-xl text-left hover:bg-gray-50 transition-colors">
                                <div class="w-12 h-12 bg-emerald-100 rounded-xl flex items-center justify-center text-2xl mb-3">
                                    üì¶
                                </div>
                                <h4 class="font-semibold text-gray-900">Import Step</h4>
                                <p class="text-sm text-gray-500 mt-1">Reuse a step from another workflow</p>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Footer -->
                    <div class="p-5 border-t border-gray-200 bg-gray-50">
                        <div class="flex items-center justify-end gap-3">
                            <button class="px-4 py-2 text-sm font-medium text-gray-600 hover:text-gray-800">Cancel</button>
                            <button class="px-6 py-2 text-sm font-medium text-white bg-indigo-600 rounded-xl hover:bg-indigo-700 opacity-50 cursor-not-allowed">Next</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- ============================================== -->
    <!-- STATE 17: TEST RUNNING                        -->
    <!-- ============================================== -->
    <section id="state-test-running" class="state-section">
        <div class="h-screen flex flex-col bg-white">
            <header class="h-14 border-b border-gray-200 bg-white flex items-center justify-between px-4 shrink-0">
                <div class="flex items-center gap-3">
                    <button class="text-gray-400 hover:text-gray-600 p-1.5 rounded hover:bg-gray-100">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                        </svg>
                    </button>
                    <span class="text-base font-semibold text-gray-900">Job Application Workflow</span>
                    <span class="px-2 py-0.5 bg-indigo-100 text-indigo-700 text-xs font-medium rounded animate-pulse-slow">Testing...</span>
                </div>
                <button class="px-4 py-1.5 text-sm font-medium text-rose-600 bg-rose-50 border border-rose-200 rounded-lg hover:bg-rose-100">
                    Stop Test
                </button>
            </header>
            
            <div class="flex-1 flex overflow-hidden">
                <!-- Left: Chat (showing test progress) -->
                <aside class="w-64 border-r border-gray-200 bg-gray-50 flex flex-col shrink-0">
                    <div class="p-3 border-b border-gray-200 bg-white">
                        <div class="flex items-center gap-2">
                            <div class="w-7 h-7 bg-gradient-to-br from-violet-500 to-indigo-600 rounded-lg flex items-center justify-center">
                                <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"></path>
                                </svg>
                            </div>
                            <span class="text-sm font-medium text-gray-900">Test Progress</span>
                        </div>
                    </div>
                    <div class="flex-1 p-3 custom-scroll overflow-y-auto">
                        <div class="space-y-3">
                            <div class="bg-white rounded-lg p-3 border border-gray-200">
                                <div class="text-sm text-gray-700">Starting test with inputs:</div>
                                <pre class="text-xs text-gray-500 mt-2 bg-gray-50 p-2 rounded">jobUrl: "https://..."
baseResume: "John Doe..."</pre>
                            </div>
                            <div class="bg-emerald-50 rounded-lg p-3 border border-emerald-200">
                                <div class="text-sm text-emerald-700 flex items-center gap-2">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                    </svg>
                                    Step 1 complete (0.8s)
                                </div>
                                <div class="text-xs text-emerald-600 mt-1">Scraped: "Senior Engineer at Acme"</div>
                            </div>
                            <div class="bg-indigo-50 rounded-lg p-3 border border-indigo-200">
                                <div class="text-sm text-indigo-700 flex items-center gap-2">
                                    <svg class="w-4 h-4 animate-spin" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                                    </svg>
                                    Running Step 2...
                                </div>
                            </div>
                        </div>
                    </div>
                </aside>
                
                <!-- Center: Timeline with progress -->
                <main class="flex-1 overflow-y-auto custom-scroll bg-subtle">
                    <div class="max-w-2xl mx-auto py-8 px-6">
                        <div class="relative">
                            <!-- Progress line -->
                            <div class="absolute left-8 top-12 bottom-20 w-0.5">
                                <div class="h-1/3 bg-emerald-400"></div>
                                <div class="h-1/3 bg-indigo-400 animate-pulse"></div>
                                <div class="h-1/3 bg-gray-200"></div>
                            </div>
                            
                            <!-- Step 1: Complete -->
                            <div class="relative flex gap-4 mb-4">
                                <div class="w-16 flex-shrink-0 flex flex-col items-center">
                                    <div class="w-11 h-11 bg-emerald-500 rounded-xl flex items-center justify-center text-white text-lg shadow-sm z-10">
                                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                        </svg>
                                    </div>
                                    <div class="text-xs text-emerald-600 mt-1.5 font-medium">0.8s</div>
                                </div>
                                <div class="flex-1 bg-emerald-50 rounded-xl border border-emerald-200 shadow-sm overflow-hidden">
                                    <div class="p-4">
                                        <div class="flex items-center justify-between">
                                            <div>
                                                <h3 class="font-semibold text-gray-900">Scrape Job Listing</h3>
                                                <p class="text-sm text-emerald-600">Completed successfully</p>
                                            </div>
                                            <button class="text-xs text-gray-500 hover:text-gray-700">View output ‚Üí</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Step 2: Running -->
                            <div class="relative flex gap-4 mb-4">
                                <div class="w-16 flex-shrink-0 flex flex-col items-center">
                                    <div class="w-11 h-11 bg-indigo-500 rounded-xl flex items-center justify-center text-white text-lg shadow-sm z-10 animate-pulse-slow">
                                        <svg class="w-6 h-6 animate-spin" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                                        </svg>
                                    </div>
                                    <div class="text-xs text-indigo-600 mt-1.5 font-medium">Running</div>
                                </div>
                                <div class="flex-1 bg-indigo-50 rounded-xl border-2 border-indigo-300 shadow-md overflow-hidden ring-4 ring-indigo-100">
                                    <div class="p-4">
                                        <div class="flex items-center justify-between">
                                            <div>
                                                <h3 class="font-semibold text-gray-900">Generate Tailored Resume</h3>
                                                <p class="text-sm text-indigo-600">Processing with GPT-4...</p>
                                            </div>
                                            <div class="text-sm text-indigo-500 font-mono">1.2s</div>
                                        </div>
                                        <!-- Progress bar -->
                                        <div class="mt-3 h-1.5 bg-indigo-100 rounded-full overflow-hidden">
                                            <div class="h-full bg-indigo-500 rounded-full w-2/3 animate-pulse"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Step 3: Pending -->
                            <div class="relative flex gap-4 mb-4 opacity-50">
                                <div class="w-16 flex-shrink-0 flex flex-col items-center">
                                    <div class="w-11 h-11 bg-gray-200 rounded-xl flex items-center justify-center text-gray-400 text-lg shadow-sm z-10">
                                        ‚úâÔ∏è
                                    </div>
                                    <div class="text-xs text-gray-400 mt-1.5 font-medium">Pending</div>
                                </div>
                                <div class="flex-1 bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden">
                                    <div class="p-4">
                                        <h3 class="font-semibold text-gray-500">Send Email</h3>
                                        <p class="text-sm text-gray-400">Waiting...</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </main>
                
                <!-- Right: Live Output -->
                <aside class="w-80 border-l border-gray-200 bg-gray-900 flex flex-col shrink-0">
                    <div class="p-3 border-b border-gray-700">
                        <h3 class="text-sm font-medium text-white">Live Output</h3>
                    </div>
                    <div class="flex-1 overflow-y-auto custom-scroll p-3 font-mono text-xs">
                        <div class="space-y-2 text-gray-300">
                            <div class="text-gray-500">[00:00.000] Starting workflow...</div>
                            <div class="text-emerald-400">[00:00.012] ‚Üí Scrape Job Listing</div>
                            <div class="text-gray-400">[00:00.015] Fetching https://careers.acme.com/...</div>
                            <div class="text-gray-400">[00:00.832] Extracted: title, company, requirements</div>
                            <div class="text-emerald-400">[00:00.834] ‚úì Step 1 complete</div>
                            <div class="text-indigo-400">[00:00.836] ‚Üí Generate Resume</div>
                            <div class="text-gray-400">[00:00.840] Sending to OpenAI GPT-4...</div>
                            <div class="text-gray-400">[00:01.200] Generating content...</div>
                            <div class="text-indigo-400 animate-pulse">[00:02.100] Still processing...</div>
                        </div>
                    </div>
                </aside>
            </div>
        </div>
    </section>

    <!-- ============================================== -->
    <!-- STATE 18: TEST PASSED                         -->
    <!-- ============================================== -->
    <section id="state-test-passed" class="state-section">
        <div class="h-screen flex flex-col bg-white">
            <header class="h-14 border-b border-gray-200 bg-white flex items-center justify-between px-4 shrink-0">
                <div class="flex items-center gap-3">
                    <button class="text-gray-400 hover:text-gray-600 p-1.5 rounded hover:bg-gray-100">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                        </svg>
                    </button>
                    <span class="text-base font-semibold text-gray-900">Job Application Workflow</span>
                    <span class="px-3 py-1 bg-emerald-100 text-emerald-700 text-sm font-medium rounded-full flex items-center gap-1.5">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                        </svg>
                        Test Passed
                    </span>
                </div>
                <div class="flex items-center gap-3">
                    <button class="px-4 py-1.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50">Run Again</button>
                    <button class="px-4 py-1.5 text-sm font-medium text-white bg-emerald-600 rounded-lg hover:bg-emerald-700">Publish Workflow</button>
                </div>
            </header>
            
            <div class="flex-1 flex overflow-hidden">
                <!-- Center: Success Summary -->
                <main class="flex-1 overflow-y-auto custom-scroll bg-subtle">
                    <div class="max-w-2xl mx-auto py-8 px-6">
                        <!-- Success Banner -->
                        <div class="bg-gradient-to-r from-emerald-500 to-teal-500 rounded-2xl p-6 text-white mb-6 shadow-lg">
                            <div class="flex items-center gap-4">
                                <div class="w-16 h-16 bg-white/20 rounded-2xl flex items-center justify-center">
                                    <svg class="w-10 h-10" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                    </svg>
                                </div>
                                <div>
                                    <h2 class="text-2xl font-bold">All Steps Passed!</h2>
                                    <p class="text-emerald-100">Completed in 3.3 seconds ‚Ä¢ 3 steps executed</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Step Results -->
                        <div class="space-y-3">
                            <div class="bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden">
                                <div class="p-4 flex items-center gap-4">
                                    <div class="w-10 h-10 bg-emerald-100 rounded-lg flex items-center justify-center text-emerald-600">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                        </svg>
                                    </div>
                                    <div class="flex-1">
                                        <h3 class="font-semibold text-gray-900">1. Scrape Job Listing</h3>
                                        <p class="text-sm text-gray-500">0.8s</p>
                                    </div>
                                    <button class="text-sm text-indigo-600 hover:text-indigo-700 font-medium">View Output</button>
                                </div>
                            </div>
                            <div class="bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden">
                                <div class="p-4 flex items-center gap-4">
                                    <div class="w-10 h-10 bg-emerald-100 rounded-lg flex items-center justify-center text-emerald-600">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                        </svg>
                                    </div>
                                    <div class="flex-1">
                                        <h3 class="font-semibold text-gray-900">2. Generate Resume</h3>
                                        <p class="text-sm text-gray-500">2.1s</p>
                                    </div>
                                    <button class="text-sm text-indigo-600 hover:text-indigo-700 font-medium">View Output</button>
                                </div>
                            </div>
                            <div class="bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden">
                                <div class="p-4 flex items-center gap-4">
                                    <div class="w-10 h-10 bg-emerald-100 rounded-lg flex items-center justify-center text-emerald-600">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                        </svg>
                                    </div>
                                    <div class="flex-1">
                                        <h3 class="font-semibold text-gray-900">3. Send Email</h3>
                                        <p class="text-sm text-gray-500">0.4s</p>
                                    </div>
                                    <button class="text-sm text-indigo-600 hover:text-indigo-700 font-medium">View Output</button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Final Output Preview -->
                        <div class="mt-6 bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden">
                            <div class="p-4 border-b border-gray-100 flex items-center justify-between">
                                <h3 class="font-semibold text-gray-900">Final Output</h3>
                                <button class="text-sm text-gray-500 hover:text-gray-700">Copy JSON</button>
                            </div>
                            <pre class="p-4 text-sm font-mono text-gray-600 bg-gray-50 overflow-x-auto">{
  "emailSent": true,
  "messageId": "msg_abc123",
  "tailoredResume": "John Doe\nSenior Engineer...",
  "jobDetails": {
    "title": "Senior Engineer",
    "company": "Acme Corp"
  }
}</pre>
                        </div>
                    </div>
                </main>
            </div>
        </div>
    </section>

    <!-- ============================================== -->
    <!-- STATE 19: TEST FAILED                         -->
    <!-- ============================================== -->
    <section id="state-test-failed" class="state-section">
        <div class="h-screen flex flex-col bg-white">
            <header class="h-14 border-b border-gray-200 bg-white flex items-center justify-between px-4 shrink-0">
                <div class="flex items-center gap-3">
                    <button class="text-gray-400 hover:text-gray-600 p-1.5 rounded hover:bg-gray-100">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                        </svg>
                    </button>
                    <span class="text-base font-semibold text-gray-900">Job Application Workflow</span>
                    <span class="px-3 py-1 bg-rose-100 text-rose-700 text-sm font-medium rounded-full flex items-center gap-1.5">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                        Test Failed
                    </span>
                </div>
                <div class="flex items-center gap-3">
                    <button class="px-4 py-1.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50">Edit Step</button>
                    <button class="px-4 py-1.5 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700">Retry Test</button>
                </div>
            </header>
            
            <div class="flex-1 flex overflow-hidden">
                <!-- Center: Error Details -->
                <main class="flex-1 overflow-y-auto custom-scroll bg-subtle">
                    <div class="max-w-2xl mx-auto py-8 px-6">
                        <!-- Error Banner -->
                        <div class="bg-gradient-to-r from-rose-500 to-pink-500 rounded-2xl p-6 text-white mb-6 shadow-lg">
                            <div class="flex items-center gap-4">
                                <div class="w-16 h-16 bg-white/20 rounded-2xl flex items-center justify-center">
                                    <svg class="w-10 h-10" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                                    </svg>
                                </div>
                                <div>
                                    <h2 class="text-2xl font-bold">Step 3 Failed</h2>
                                    <p class="text-rose-100">Error at "Send Email" after 2.9 seconds</p>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Step Results -->
                        <div class="space-y-3">
                            <!-- Passed -->
                            <div class="bg-white rounded-xl border border-gray-200 shadow-sm p-4 flex items-center gap-4">
                                <div class="w-10 h-10 bg-emerald-100 rounded-lg flex items-center justify-center text-emerald-600">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                    </svg>
                                </div>
                                <div class="flex-1">
                                    <h3 class="font-semibold text-gray-900">1. Scrape Job Listing</h3>
                                    <p class="text-sm text-emerald-600">Passed ‚Ä¢ 0.8s</p>
                                </div>
                            </div>
                            
                            <!-- Passed -->
                            <div class="bg-white rounded-xl border border-gray-200 shadow-sm p-4 flex items-center gap-4">
                                <div class="w-10 h-10 bg-emerald-100 rounded-lg flex items-center justify-center text-emerald-600">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                    </svg>
                                </div>
                                <div class="flex-1">
                                    <h3 class="font-semibold text-gray-900">2. Generate Resume</h3>
                                    <p class="text-sm text-emerald-600">Passed ‚Ä¢ 2.1s</p>
                                </div>
                            </div>
                            
                            <!-- Failed -->
                            <div class="bg-rose-50 rounded-xl border-2 border-rose-300 shadow-sm overflow-hidden">
                                <div class="p-4 flex items-center gap-4">
                                    <div class="w-10 h-10 bg-rose-100 rounded-lg flex items-center justify-center text-rose-600">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                        </svg>
                                    </div>
                                    <div class="flex-1">
                                        <h3 class="font-semibold text-gray-900">3. Send Email</h3>
                                        <p class="text-sm text-rose-600">Failed</p>
                                    </div>
                                </div>
                                
                                <!-- Error Details -->
                                <div class="px-4 pb-4">
                                    <div class="bg-rose-100 rounded-lg p-4">
                                        <div class="flex items-start gap-3">
                                            <svg class="w-5 h-5 text-rose-600 mt-0.5 shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01"></path>
                                            </svg>
                                            <div class="flex-1">
                                                <h4 class="font-semibold text-rose-800">GmailAuthError</h4>
                                                <p class="text-sm text-rose-700 mt-1">Gmail connection has expired. Please reconnect your Gmail account in the Connections tab.</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Stack Trace -->
                                <div class="bg-gray-900 p-4 rounded-b-xl">
                                    <div class="flex items-center justify-between mb-2">
                                        <span class="text-xs text-gray-400 font-medium">Stack Trace</span>
                                        <button class="text-xs text-gray-400 hover:text-white">Copy</button>
                                    </div>
                                    <pre class="text-xs font-mono text-rose-400 overflow-x-auto whitespace-pre-wrap">Error: GmailAuthError: OAuth token expired
    at GmailClient.sendEmail (/mastra/integrations/gmail.ts:142:11)
    at sendEmailStep.execute (/workflows/job-app/workflow.ts:78:24)
    at StepRunner.run (/mastra/core/step.ts:89:18)</pre>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Suggested Fix -->
                        <div class="mt-6 bg-amber-50 border border-amber-200 rounded-xl p-4">
                            <div class="flex items-start gap-3">
                                <div class="w-8 h-8 bg-amber-100 rounded-lg flex items-center justify-center text-amber-600 shrink-0">
                                    üí°
                                </div>
                                <div>
                                    <h4 class="font-semibold text-amber-800">Suggested Fix</h4>
                                    <p class="text-sm text-amber-700 mt-1">Your Gmail OAuth token has expired. Go to the <strong>Connect</strong> tab and click "Reconnect" next to Gmail.</p>
                                    <button class="mt-3 px-4 py-2 text-sm font-medium text-amber-800 bg-amber-100 rounded-lg hover:bg-amber-200 transition-colors">
                                        Go to Connections ‚Üí
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </main>
            </div>
        </div>
    </section>

    <!-- ============================================== -->
    <!-- STATE 20: CODE VIEW                           -->
    <!-- ============================================== -->
    <section id="state-code-view" class="state-section">
        <div class="h-screen flex flex-col bg-white">
            <header class="h-14 border-b border-gray-200 bg-white flex items-center justify-between px-4 shrink-0">
                <div class="flex items-center gap-3">
                    <button class="text-gray-400 hover:text-gray-600 p-1.5 rounded hover:bg-gray-100">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                        </svg>
                    </button>
                    <span class="text-base font-semibold text-gray-900">Job Application Workflow</span>
                    <span class="px-2 py-0.5 bg-emerald-100 text-emerald-700 text-xs font-medium rounded">Published</span>
                </div>
                <div class="flex items-center gap-3">
                    <div class="flex items-center bg-gray-100 rounded-lg p-0.5">
                        <button class="toggle-btn px-3 py-1.5 text-xs font-medium text-gray-500 rounded-md">Flow</button>
                        <button class="toggle-btn px-3 py-1.5 text-xs font-medium text-gray-500 rounded-md">Spec</button>
                        <button class="toggle-btn active px-3 py-1.5 text-xs font-medium rounded-md">Code</button>
                    </div>
                    <div class="w-px h-6 bg-gray-200"></div>
                    <button class="inline-flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path>
                        </svg>
                        Copy Code
                    </button>
                    <button class="px-4 py-1.5 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700">
                        Download .ts
                    </button>
                </div>
            </header>
            
            <div class="flex-1 flex overflow-hidden">
                <!-- File Tree -->
                <aside class="w-64 border-r border-gray-200 bg-gray-50 flex flex-col shrink-0">
                    <div class="p-3 border-b border-gray-200 bg-white text-xs font-semibold text-gray-500 uppercase">
                        Generated Files
                    </div>
                    <div class="p-3 space-y-1">
                        <button class="w-full flex items-center gap-2 p-2 text-sm text-left bg-indigo-50 border border-indigo-200 rounded-lg text-indigo-700">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                            <span class="font-medium">workflow.ts</span>
                        </button>
                        <button class="w-full flex items-center gap-2 p-2 text-sm text-left text-gray-600 hover:bg-gray-100 rounded-lg">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                            <span>workflow.json</span>
                        </button>
                        <button class="w-full flex items-center gap-2 p-2 text-sm text-left text-gray-600 hover:bg-gray-100 rounded-lg">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                            <span>steps/scrapeJob.ts</span>
                        </button>
                        <button class="w-full flex items-center gap-2 p-2 text-sm text-left text-gray-600 hover:bg-gray-100 rounded-lg">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                            <span>steps/generateResume.ts</span>
                        </button>
                        <button class="w-full flex items-center gap-2 p-2 text-sm text-left text-gray-600 hover:bg-gray-100 rounded-lg">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                            <span>steps/sendEmail.ts</span>
                        </button>
                    </div>
                    <div class="mt-auto p-3 border-t border-gray-200 bg-white">
                        <div class="text-xs text-gray-500">
                            <span class="font-medium">Last generated:</span><br/>
                            Today at 2:34 PM
                        </div>
                    </div>
                </aside>
                
                <!-- Code Editor -->
                <main class="flex-1 overflow-hidden bg-gray-900 flex flex-col">
                    <!-- File Tab -->
                    <div class="flex items-center gap-1 px-4 pt-3">
                        <div class="flex items-center gap-2 px-3 py-1.5 bg-gray-800 rounded-t-lg text-sm">
                            <span class="text-blue-400">üìÑ</span>
                            <span class="text-gray-200">workflow.ts</span>
                            <button class="text-gray-500 hover:text-gray-300 ml-1">√ó</button>
                        </div>
                    </div>
                    
                    <!-- Code Content -->
                    <div class="flex-1 overflow-auto custom-scroll">
                        <pre class="p-4 text-sm font-mono leading-relaxed"><code><span class="text-gray-500">// Auto-generated by Agipo Workflow Editor</span>
<span class="text-gray-500">// DO NOT EDIT - Changes will be overwritten</span>

<span class="text-purple-400">import</span> <span class="text-gray-300">{ createStep, createWorkflow }</span> <span class="text-purple-400">from</span> <span class="text-amber-300">"@mastra/core"</span><span class="text-gray-300">;</span>
<span class="text-purple-400">import</span> <span class="text-gray-300">{ z }</span> <span class="text-purple-400">from</span> <span class="text-amber-300">"zod"</span><span class="text-gray-300">;</span>
<span class="text-purple-400">import</span> <span class="text-gray-300">{ firecrawl, openai, gmail }</span> <span class="text-purple-400">from</span> <span class="text-amber-300">"@composio/mastra"</span><span class="text-gray-300">;</span>

<span class="text-gray-500">// ==========================================</span>
<span class="text-gray-500">// Step 1: Scrape Job Listing</span>
<span class="text-gray-500">// ==========================================</span>

<span class="text-purple-400">const</span> <span class="text-cyan-300">scrapeJobStep</span> <span class="text-gray-300">=</span> <span class="text-yellow-300">createStep</span><span class="text-gray-300">({</span>
  <span class="text-blue-300">id</span><span class="text-gray-300">:</span> <span class="text-amber-300">"scrape-job-listing"</span><span class="text-gray-300">,</span>
  <span class="text-blue-300">description</span><span class="text-gray-300">:</span> <span class="text-amber-300">"Scrapes job listing from URL"</span><span class="text-gray-300">,</span>
  <span class="text-blue-300">inputSchema</span><span class="text-gray-300">:</span> <span class="text-cyan-300">z</span><span class="text-gray-300">.</span><span class="text-yellow-300">object</span><span class="text-gray-300">({</span>
    <span class="text-blue-300">url</span><span class="text-gray-300">:</span> <span class="text-cyan-300">z</span><span class="text-gray-300">.</span><span class="text-yellow-300">string</span><span class="text-gray-300">().</span><span class="text-yellow-300">url</span><span class="text-gray-300">(),</span>
  <span class="text-gray-300">}),</span>
  <span class="text-blue-300">outputSchema</span><span class="text-gray-300">:</span> <span class="text-cyan-300">z</span><span class="text-gray-300">.</span><span class="text-yellow-300">object</span><span class="text-gray-300">({</span>
    <span class="text-blue-300">title</span><span class="text-gray-300">:</span> <span class="text-cyan-300">z</span><span class="text-gray-300">.</span><span class="text-yellow-300">string</span><span class="text-gray-300">(),</span>
    <span class="text-blue-300">company</span><span class="text-gray-300">:</span> <span class="text-cyan-300">z</span><span class="text-gray-300">.</span><span class="text-yellow-300">string</span><span class="text-gray-300">(),</span>
    <span class="text-blue-300">requirements</span><span class="text-gray-300">:</span> <span class="text-cyan-300">z</span><span class="text-gray-300">.</span><span class="text-yellow-300">array</span><span class="text-gray-300">(</span><span class="text-cyan-300">z</span><span class="text-gray-300">.</span><span class="text-yellow-300">string</span><span class="text-gray-300">()),</span>
  <span class="text-gray-300">}),</span>
  <span class="text-purple-400">async</span> <span class="text-yellow-300">execute</span><span class="text-gray-300">({ inputData }) {</span>
    <span class="text-purple-400">const</span> <span class="text-cyan-300">result</span> <span class="text-gray-300">=</span> <span class="text-purple-400">await</span> <span class="text-cyan-300">firecrawl</span><span class="text-gray-300">.</span><span class="text-yellow-300">scrape</span><span class="text-gray-300">(inputData.url);</span>
    <span class="text-purple-400">return</span> <span class="text-gray-300">{</span>
      <span class="text-blue-300">title</span><span class="text-gray-300">: result.data.title,</span>
      <span class="text-blue-300">company</span><span class="text-gray-300">: result.data.company,</span>
      <span class="text-blue-300">requirements</span><span class="text-gray-300">: result.data.requirements,</span>
    <span class="text-gray-300">};</span>
  <span class="text-gray-300">},</span>
<span class="text-gray-300">});</span>

<span class="text-gray-500">// ==========================================</span>
<span class="text-gray-500">// Step 2: Generate Tailored Resume</span>
<span class="text-gray-500">// ==========================================</span>

<span class="text-purple-400">const</span> <span class="text-cyan-300">generateResumeStep</span> <span class="text-gray-300">=</span> <span class="text-yellow-300">createStep</span><span class="text-gray-300">({</span>
  <span class="text-blue-300">id</span><span class="text-gray-300">:</span> <span class="text-amber-300">"generate-resume"</span><span class="text-gray-300">,</span>
  <span class="text-blue-300">description</span><span class="text-gray-300">:</span> <span class="text-amber-300">"Generates tailored resume using AI"</span><span class="text-gray-300">,</span>
  <span class="text-blue-300">inputSchema</span><span class="text-gray-300">:</span> <span class="text-cyan-300">z</span><span class="text-gray-300">.</span><span class="text-yellow-300">object</span><span class="text-gray-300">({</span>
    <span class="text-blue-300">jobTitle</span><span class="text-gray-300">:</span> <span class="text-cyan-300">z</span><span class="text-gray-300">.</span><span class="text-yellow-300">string</span><span class="text-gray-300">(),</span>
    <span class="text-blue-300">companyName</span><span class="text-gray-300">:</span> <span class="text-cyan-300">z</span><span class="text-gray-300">.</span><span class="text-yellow-300">string</span><span class="text-gray-300">(),</span>
    <span class="text-blue-300">targetSkills</span><span class="text-gray-300">:</span> <span class="text-cyan-300">z</span><span class="text-gray-300">.</span><span class="text-yellow-300">array</span><span class="text-gray-300">(</span><span class="text-cyan-300">z</span><span class="text-gray-300">.</span><span class="text-yellow-300">string</span><span class="text-gray-300">()),</span>
    <span class="text-blue-300">baseResume</span><span class="text-gray-300">:</span> <span class="text-cyan-300">z</span><span class="text-gray-300">.</span><span class="text-yellow-300">string</span><span class="text-gray-300">(),</span>
  <span class="text-gray-300">}),</span>
  <span class="text-blue-300">outputSchema</span><span class="text-gray-300">:</span> <span class="text-cyan-300">z</span><span class="text-gray-300">.</span><span class="text-yellow-300">object</span><span class="text-gray-300">({</span>
    <span class="text-blue-300">tailoredResume</span><span class="text-gray-300">:</span> <span class="text-cyan-300">z</span><span class="text-gray-300">.</span><span class="text-yellow-300">string</span><span class="text-gray-300">(),</span>
  <span class="text-gray-300">}),</span>
  <span class="text-purple-400">async</span> <span class="text-yellow-300">execute</span><span class="text-gray-300">({ inputData }) {</span>
    <span class="text-gray-500">// ... implementation</span>
  <span class="text-gray-300">},</span>
<span class="text-gray-300">});</span>

<span class="text-gray-500">// ==========================================</span>
<span class="text-gray-500">// Step 3: Send Email</span>
<span class="text-gray-500">// ==========================================</span>

<span class="text-purple-400">const</span> <span class="text-cyan-300">sendEmailStep</span> <span class="text-gray-300">=</span> <span class="text-yellow-300">createStep</span><span class="text-gray-300">({</span>
  <span class="text-blue-300">id</span><span class="text-gray-300">:</span> <span class="text-amber-300">"send-email"</span><span class="text-gray-300">,</span>
  <span class="text-gray-500">// ... implementation</span>
<span class="text-gray-300">});</span>

<span class="text-gray-500">// ==========================================</span>
<span class="text-gray-500">// Workflow Definition</span>
<span class="text-gray-500">// ==========================================</span>

<span class="text-purple-400">export const</span> <span class="text-cyan-300">jobApplicationWorkflow</span> <span class="text-gray-300">=</span> <span class="text-yellow-300">createWorkflow</span><span class="text-gray-300">({</span>
  <span class="text-blue-300">id</span><span class="text-gray-300">:</span> <span class="text-amber-300">"job-application-workflow"</span><span class="text-gray-300">,</span>
  <span class="text-blue-300">name</span><span class="text-gray-300">:</span> <span class="text-amber-300">"Job Application Workflow"</span><span class="text-gray-300">,</span>
  <span class="text-blue-300">description</span><span class="text-gray-300">:</span> <span class="text-amber-300">"Scrapes job and generates tailored resume"</span><span class="text-gray-300">,</span>
  <span class="text-blue-300">triggerSchema</span><span class="text-gray-300">:</span> <span class="text-cyan-300">z</span><span class="text-gray-300">.</span><span class="text-yellow-300">object</span><span class="text-gray-300">({</span>
    <span class="text-blue-300">jobUrl</span><span class="text-gray-300">:</span> <span class="text-cyan-300">z</span><span class="text-gray-300">.</span><span class="text-yellow-300">string</span><span class="text-gray-300">().</span><span class="text-yellow-300">url</span><span class="text-gray-300">(),</span>
    <span class="text-blue-300">baseResume</span><span class="text-gray-300">:</span> <span class="text-cyan-300">z</span><span class="text-gray-300">.</span><span class="text-yellow-300">string</span><span class="text-gray-300">(),</span>
  <span class="text-gray-300">}),</span>
<span class="text-gray-300">})</span>
  <span class="text-gray-300">.</span><span class="text-yellow-300">then</span><span class="text-gray-300">(</span><span class="text-cyan-300">scrapeJobStep</span><span class="text-gray-300">)</span>
  <span class="text-gray-300">.</span><span class="text-yellow-300">map</span><span class="text-gray-300">({</span>
    <span class="text-blue-300">jobTitle</span><span class="text-gray-300">: { step:</span> <span class="text-cyan-300">scrapeJobStep</span><span class="text-gray-300">, path:</span> <span class="text-amber-300">"title"</span> <span class="text-gray-300">},</span>
    <span class="text-blue-300">companyName</span><span class="text-gray-300">: { step:</span> <span class="text-cyan-300">scrapeJobStep</span><span class="text-gray-300">, path:</span> <span class="text-amber-300">"company"</span> <span class="text-gray-300">},</span>
    <span class="text-blue-300">targetSkills</span><span class="text-gray-300">: { step:</span> <span class="text-cyan-300">scrapeJobStep</span><span class="text-gray-300">, path:</span> <span class="text-amber-300">"requirements"</span> <span class="text-gray-300">},</span>
    <span class="text-blue-300">baseResume</span><span class="text-gray-300">: { step:</span> <span class="text-amber-300">"trigger"</span><span class="text-gray-300">, path:</span> <span class="text-amber-300">"baseResume"</span> <span class="text-gray-300">},</span>
  <span class="text-gray-300">})</span>
  <span class="text-gray-300">.</span><span class="text-yellow-300">then</span><span class="text-gray-300">(</span><span class="text-cyan-300">generateResumeStep</span><span class="text-gray-300">)</span>
  <span class="text-gray-300">.</span><span class="text-yellow-300">map</span><span class="text-gray-300">({</span>
    <span class="text-blue-300">body</span><span class="text-gray-300">: { step:</span> <span class="text-cyan-300">generateResumeStep</span><span class="text-gray-300">, path:</span> <span class="text-amber-300">"tailoredResume"</span> <span class="text-gray-300">},</span>
  <span class="text-gray-300">})</span>
  <span class="text-gray-300">.</span><span class="text-yellow-300">then</span><span class="text-gray-300">(</span><span class="text-cyan-300">sendEmailStep</span><span class="text-gray-300">)</span>
  <span class="text-gray-300">.</span><span class="text-yellow-300">commit</span><span class="text-gray-300">();</span>
</code></pre>
                    </div>
                    
                    <!-- Status Bar -->
                    <div class="px-4 py-2 bg-gray-800 border-t border-gray-700 flex items-center justify-between text-xs text-gray-400">
                        <div class="flex items-center gap-4">
                            <span>TypeScript</span>
                            <span>UTF-8</span>
                            <span>88 lines</span>
                        </div>
                        <div class="flex items-center gap-4">
                            <span class="text-emerald-400">‚úì Synced with editor</span>
                            <span>Read-only</span>
                        </div>
                    </div>
                </main>
            </div>
        </div>
    </section>

    <!-- ============================================== -->
    <!-- JAVASCRIPT                                    -->
    <!-- ============================================== -->
    <script>
        function showState(stateId) {
            // Hide all states
            document.querySelectorAll('.state-section').forEach(section => {
                section.classList.remove('active');
            });
            // Show selected state
            const target = document.getElementById(stateId);
            if (target) {
                target.classList.add('active');
            }
        }
        
        // Initialize with first state or URL hash
        document.addEventListener('DOMContentLoaded', () => {
            const hash = window.location.hash.replace('#', '');
            if (hash && document.getElementById(hash)) {
                document.getElementById('stateSelector').value = hash;
                showState(hash);
            }
        });
    </script>

</body>
</html>

